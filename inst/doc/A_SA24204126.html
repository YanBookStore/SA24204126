<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="SA24204126" />

<meta name="date" content="2024-12-09" />

<title>A_SA24204126</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">A_SA24204126</h1>
<h4 class="author">SA24204126</h4>
<h4 class="date">2024-12-09</h4>



<div id="questionuse-knitr-to-produce-at-least-3-examples.-for-each-example-texts-should-mix-with-figures-andor-tables.-better-to-have-mathematical-formulas." class="section level2">
<h2>Question:Use knitr to produce at least 3 examples. For each example,
texts should mix with figures and/or tables. Better to have mathematical
formulas.</h2>
</div>
<div id="answer-0" class="section level2">
<h2>Answer 0</h2>
</div>
<div id="示例-1-图形和数学公式" class="section level2">
<h2>示例 1: 图形和数学公式</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># 生成正态分布数据</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">100</span>)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">plot</span>(x, y, <span class="at">main=</span><span class="st">&quot;Scatter Plot of Normally Distributed Data&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;x&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;y&quot;</span>, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">pch=</span><span class="dv">19</span>)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="co"># 添加图例</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="at">legend =</span> <span class="st">&quot;Data Points&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">pch =</span> <span class="dv">19</span>)</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a><span class="co"># 在图中添加数学公式</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a><span class="fu">text</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="fu">max</span>(y) <span class="sc">-</span> <span class="dv">1</span>, <span class="at">labels =</span> <span class="fu">expression</span>(y <span class="sc">==</span> beta[<span class="dv">0</span>] <span class="sc">+</span> beta[<span class="dv">1</span>] <span class="sc">*</span> x <span class="sc">+</span> epsilon), <span class="at">cex =</span> <span class="fl">1.2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="示例-2-图表" class="section level2">
<h2>示例 2: 图表</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># 创建数据框</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>students <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="at">Name =</span> <span class="fu">c</span>(<span class="st">&quot;Alice&quot;</span>, <span class="st">&quot;Bob&quot;</span>, <span class="st">&quot;Charlie&quot;</span>, <span class="st">&quot;David&quot;</span>, <span class="st">&quot;Eva&quot;</span>),</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>  <span class="at">Math =</span> <span class="fu">c</span>(<span class="dv">95</span>, <span class="dv">78</span>, <span class="dv">88</span>, <span class="dv">92</span>, <span class="dv">85</span>),</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  <span class="at">English =</span> <span class="fu">c</span>(<span class="dv">80</span>, <span class="dv">85</span>, <span class="dv">82</span>, <span class="dv">88</span>, <span class="dv">90</span>),</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>  <span class="at">Physics =</span> <span class="fu">c</span>(<span class="dv">89</span>, <span class="dv">90</span>, <span class="dv">78</span>, <span class="dv">95</span>, <span class="dv">85</span>),</span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>  <span class="at">Chemistry =</span> <span class="fu">c</span>(<span class="dv">92</span>, <span class="dv">88</span>, <span class="dv">91</span>, <span class="dv">84</span>, <span class="dv">86</span>),</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>  <span class="at">History =</span> <span class="fu">c</span>(<span class="dv">88</span>, <span class="dv">94</span>, <span class="dv">85</span>, <span class="dv">90</span>, <span class="dv">82</span>)</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a><span class="co"># 显示数据框为表格</span></span>
<span id="cb2-12"><a href="#cb2-12" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(students, <span class="at">caption =</span> <span class="st">&quot;学生考试成绩&quot;</span>)</span></code></pre></div>
<table>
<caption>学生考试成绩</caption>
<thead>
<tr class="header">
<th align="left">Name</th>
<th align="right">Math</th>
<th align="right">English</th>
<th align="right">Physics</th>
<th align="right">Chemistry</th>
<th align="right">History</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Alice</td>
<td align="right">95</td>
<td align="right">80</td>
<td align="right">89</td>
<td align="right">92</td>
<td align="right">88</td>
</tr>
<tr class="even">
<td align="left">Bob</td>
<td align="right">78</td>
<td align="right">85</td>
<td align="right">90</td>
<td align="right">88</td>
<td align="right">94</td>
</tr>
<tr class="odd">
<td align="left">Charlie</td>
<td align="right">88</td>
<td align="right">82</td>
<td align="right">78</td>
<td align="right">91</td>
<td align="right">85</td>
</tr>
<tr class="even">
<td align="left">David</td>
<td align="right">92</td>
<td align="right">88</td>
<td align="right">95</td>
<td align="right">84</td>
<td align="right">90</td>
</tr>
<tr class="odd">
<td align="left">Eva</td>
<td align="right">85</td>
<td align="right">90</td>
<td align="right">85</td>
<td align="right">86</td>
<td align="right">82</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># 计算每个科目的均值、方差和标准差</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>stats <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>  <span class="at">Subject =</span> <span class="fu">c</span>(<span class="st">&quot;Math&quot;</span>, <span class="st">&quot;English&quot;</span>, <span class="st">&quot;Physics&quot;</span>, <span class="st">&quot;Chemistry&quot;</span>, <span class="st">&quot;History&quot;</span>),</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">sapply</span>(students[,<span class="sc">-</span><span class="dv">1</span>], mean),</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>  <span class="at">Variance =</span> <span class="fu">sapply</span>(students[,<span class="sc">-</span><span class="dv">1</span>], var),</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a>  <span class="at">SD =</span> <span class="fu">sapply</span>(students[,<span class="sc">-</span><span class="dv">1</span>], sd)</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co"># 显示描述性统计量表格</span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(stats, <span class="at">caption =</span> <span class="st">&quot;各科目描述性统计量&quot;</span>)</span></code></pre></div>
<table>
<caption>各科目描述性统计量</caption>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">Subject</th>
<th align="right">Mean</th>
<th align="right">Variance</th>
<th align="right">SD</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Math</td>
<td align="left">Math</td>
<td align="right">87.6</td>
<td align="right">43.3</td>
<td align="right">6.580274</td>
</tr>
<tr class="even">
<td align="left">English</td>
<td align="left">English</td>
<td align="right">85.0</td>
<td align="right">17.0</td>
<td align="right">4.123106</td>
</tr>
<tr class="odd">
<td align="left">Physics</td>
<td align="left">Physics</td>
<td align="right">87.4</td>
<td align="right">40.3</td>
<td align="right">6.348228</td>
</tr>
<tr class="even">
<td align="left">Chemistry</td>
<td align="left">Chemistry</td>
<td align="right">88.2</td>
<td align="right">11.2</td>
<td align="right">3.346640</td>
</tr>
<tr class="odd">
<td align="left">History</td>
<td align="left">History</td>
<td align="right">87.8</td>
<td align="right">21.2</td>
<td align="right">4.604346</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># 计算置信区间</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>confidence_intervals <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="at">Subject =</span> stats<span class="sc">$</span>Subject,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="at">Lower =</span> stats<span class="sc">$</span>Mean <span class="sc">-</span> <span class="fl">1.96</span> <span class="sc">*</span> stats<span class="sc">$</span>SD <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">nrow</span>(students)),</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="at">Upper =</span> stats<span class="sc">$</span>Mean <span class="sc">+</span> <span class="fl">1.96</span> <span class="sc">*</span> stats<span class="sc">$</span>SD <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="fu">nrow</span>(students))</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>)</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a></span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a><span class="co"># 显示置信区间表格</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(confidence_intervals, <span class="at">caption =</span> <span class="st">&quot;各科目均值的 95% 置信区间&quot;</span>)</span></code></pre></div>
<table>
<caption>各科目均值的 95% 置信区间</caption>
<thead>
<tr class="header">
<th align="left">Subject</th>
<th align="right">Lower</th>
<th align="right">Upper</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Math</td>
<td align="right">81.83214</td>
<td align="right">93.36786</td>
</tr>
<tr class="even">
<td align="left">English</td>
<td align="right">81.38594</td>
<td align="right">88.61406</td>
</tr>
<tr class="odd">
<td align="left">Physics</td>
<td align="right">81.83553</td>
<td align="right">92.96447</td>
</tr>
<tr class="even">
<td align="left">Chemistry</td>
<td align="right">85.26654</td>
<td align="right">91.13346</td>
</tr>
<tr class="odd">
<td align="left">History</td>
<td align="right">83.76411</td>
<td align="right">91.83589</td>
</tr>
</tbody>
</table>
</div>
<div id="示例-3正太分布曲线" class="section level2">
<h2>示例 3:正太分布曲线</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># 生成数据</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">10</span>, <span class="dv">10</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="co"># 绘制正态分布曲线</span></span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a><span class="fu">plot</span>(x, y1, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">main =</span> <span class="st">&quot;Normal Distributions with Different Standard Deviations&quot;</span>)</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a><span class="fu">lines</span>(x, y2, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;mean = 0,SD = 1&quot;</span>, <span class="st">&quot;mean = 1,SD = 2&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer 1</h2>
</div>
<div id="题目描述" class="section level2">
<h2>3.4 题目描述</h2>
<p>Rayleigh分布密度函数是：</p>
<p><span class="math display">\[
f(x) = \frac{x}{\sigma^2} e^{-x^2 / (2\sigma^2)}, \quad x \geq 0, \sigma
&gt; 0.
\]</span></p>
<p>设计一个算法来生成来自Rayleigh分布 <span class="math inline">\(Rayleigh(\sigma)\)</span> 的随机样本。为多个 <span class="math inline">\(\sigma &gt; 0\)</span>
的值生成Rayleigh分布样本，并检查生成样本的众数是否接近理论众数 <span class="math inline">\(\sigma\)</span>（检查直方图）。</p>
<div id="解答" class="section level3">
<h3>解答</h3>
<p>Rayleigh分布的概率密度函数为</p>
<p><span class="math display">\[
f(x) = \frac{x}{\sigma^2} e^{-x^2 / (2\sigma^2)}, \quad x \geq 0, \sigma
&gt; 0.
\]</span> 我们将通过反函数变换法生成Rayleigh分布: 具体步骤如下：</p>
<ol style="list-style-type: decimal">
<li>首先生成一个在 <span class="math inline">\((0, 1)\)</span>
区间上的均匀分布随机变量 <span class="math inline">\(U \sim Uniform(0,
1)\)</span>。</li>
<li>根据目标分布的累积分布函数（CDF）的反函数，将均匀分布的随机变量
<span class="math inline">\(U\)</span>
转换为服从目标分布的随机变量。</li>
</ol>
<p>在Rayleigh分布的情况下，累积分布函数 <span class="math inline">\(F(x)\)</span> 为：</p>
<p><span class="math display">\[
F(x) = 1 - \exp\left(-\frac{x^2}{2\sigma^2}\right), \quad x \geq 0.
\]</span></p>
<p>然后将 <span class="math inline">\(F(x)\)</span> 反解得出 <span class="math inline">\(x\)</span>：</p>
<p><span class="math display">\[
x = \sigma \sqrt{-2 \log(1 - U)}.
\]</span></p>
<p>由于 <span class="math inline">\(U\)</span> 是在 <span class="math inline">\((0, 1)\)</span> 上均匀分布，因此 <span class="math inline">\(1 - U\)</span>
仍然是均匀分布随机变量。为了简化计算，可以直接使用：</p>
<p><span class="math display">\[
x = \sigma \sqrt{-2 \log(U)},
\]</span></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># 设定参数</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># 设置随机数种子</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span>     <span class="co"># 样本数量</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>sigma_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)  <span class="co"># 不同的sigma值</span></span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co"># 定义Rayleigh分布的随机样本生成函数</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>rayleigh_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, n) {</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)  <span class="co"># 生成n个均匀分布的随机数</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>  <span class="fu">return</span>(sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(u)))</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>}</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co"># Rayleigh分布理论密度函数</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>rayleigh_density <span class="ot">&lt;-</span> <span class="cf">function</span>(x, sigma) {</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>  (x <span class="sc">/</span> sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> sigma<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a>}</span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a></span>
<span id="cb6-17"><a href="#cb6-17" tabindex="-1"></a><span class="co"># 生成样本并绘制直方图与理论密度函数比较</span></span>
<span id="cb6-18"><a href="#cb6-18" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))  <span class="co"># 设置多图布局</span></span>
<span id="cb6-19"><a href="#cb6-19" tabindex="-1"></a></span>
<span id="cb6-20"><a href="#cb6-20" tabindex="-1"></a><span class="co"># 设置不同sigma对应的y轴限制</span></span>
<span id="cb6-21"><a href="#cb6-21" tabindex="-1"></a>y_limits <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.8</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>), <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.3</span>))</span>
<span id="cb6-22"><a href="#cb6-22" tabindex="-1"></a></span>
<span id="cb6-23"><a href="#cb6-23" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sigma_values)) {</span>
<span id="cb6-24"><a href="#cb6-24" tabindex="-1"></a>  sigma <span class="ot">&lt;-</span> sigma_values[i]</span>
<span id="cb6-25"><a href="#cb6-25" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">rayleigh_sample</span>(sigma, n)  <span class="co"># 生成Rayleigh分布样本</span></span>
<span id="cb6-26"><a href="#cb6-26" tabindex="-1"></a>  </span>
<span id="cb6-27"><a href="#cb6-27" tabindex="-1"></a>  <span class="co"># 绘制直方图</span></span>
<span id="cb6-28"><a href="#cb6-28" tabindex="-1"></a>  <span class="fu">hist</span>(samples, <span class="at">breaks=</span><span class="dv">50</span>, <span class="at">probability=</span><span class="cn">TRUE</span>, <span class="at">main=</span><span class="fu">paste</span>(<span class="st">&quot;sigma =&quot;</span>, sigma),</span>
<span id="cb6-29"><a href="#cb6-29" tabindex="-1"></a>       <span class="at">xlab=</span><span class="st">&quot;样本值&quot;</span>, <span class="at">col=</span><span class="st">&quot;lightblue&quot;</span>, <span class="at">border=</span><span class="st">&quot;black&quot;</span>, <span class="at">ylim=</span>y_limits[[i]])</span>
<span id="cb6-30"><a href="#cb6-30" tabindex="-1"></a>  </span>
<span id="cb6-31"><a href="#cb6-31" tabindex="-1"></a>  <span class="co"># 生成x轴上的点用于绘制理论密度函数</span></span>
<span id="cb6-32"><a href="#cb6-32" tabindex="-1"></a>  x_vals <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(samples), <span class="at">length=</span><span class="dv">1000</span>)</span>
<span id="cb6-33"><a href="#cb6-33" tabindex="-1"></a>  </span>
<span id="cb6-34"><a href="#cb6-34" tabindex="-1"></a>  <span class="co"># 绘制理论密度函数曲线</span></span>
<span id="cb6-35"><a href="#cb6-35" tabindex="-1"></a>  <span class="fu">lines</span>(x_vals, <span class="fu">rayleigh_density</span>(x_vals, sigma), <span class="at">col=</span><span class="st">&quot;red&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb6-36"><a href="#cb6-36" tabindex="-1"></a>  </span>
<span id="cb6-37"><a href="#cb6-37" tabindex="-1"></a>  <span class="co"># 添加理论众数sigma的垂直线</span></span>
<span id="cb6-38"><a href="#cb6-38" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v=</span>sigma, <span class="at">col=</span><span class="st">&quot;blue&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">2</span>)  </span>
<span id="cb6-39"><a href="#cb6-39" tabindex="-1"></a>  </span>
<span id="cb6-40"><a href="#cb6-40" tabindex="-1"></a>  <span class="co"># 添加生成样本的实际众数</span></span>
<span id="cb6-41"><a href="#cb6-41" tabindex="-1"></a>  actual_mode <span class="ot">&lt;-</span> <span class="fu">density</span>(samples)<span class="sc">$</span>x[<span class="fu">which.max</span>(<span class="fu">density</span>(samples)<span class="sc">$</span>y)]</span>
<span id="cb6-42"><a href="#cb6-42" tabindex="-1"></a>  <span class="fu">abline</span>(<span class="at">v=</span>actual_mode, <span class="at">col=</span><span class="st">&quot;green&quot;</span>, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">3</span>)</span>
<span id="cb6-43"><a href="#cb6-43" tabindex="-1"></a>  </span>
<span id="cb6-44"><a href="#cb6-44" tabindex="-1"></a>  <span class="co"># 添加图例</span></span>
<span id="cb6-45"><a href="#cb6-45" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend=</span><span class="fu">c</span>(<span class="st">&quot;理论密度函数&quot;</span>, <span class="st">&quot;理论众数&quot;</span>, <span class="st">&quot;样本众数&quot;</span>),</span>
<span id="cb6-46"><a href="#cb6-46" tabindex="-1"></a>         <span class="at">col=</span><span class="fu">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">cex=</span><span class="fl">0.8</span>)</span>
<span id="cb6-47"><a href="#cb6-47" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="问题描述" class="section level2">
<h2>3.11 问题描述</h2>
<p>生成一个大小为1000的样本，该样本来自正态位置混合模型。混合模型的组成部分为
<span class="math inline">\(N(0, 1)\)</span> 和 <span class="math inline">\(N(3, 1)\)</span> 分布，混合概率分别为 <span class="math inline">\(p_1\)</span> 和 <span class="math inline">\(p_2 =
1 - p_1\)</span>。对 <span class="math inline">\(p_1 = 0.75\)</span>
的情况绘制样本的直方图并叠加密度图。然后使用不同的 <span class="math inline">\(p_1\)</span>
值重复实验，观察混合模型的经验分布是否呈现双峰形态，并提出关于双峰混合模型的猜想。</p>
<div id="解答-1" class="section level3">
<h3>解答</h3>
</div>
<div id="r-代码" class="section level3">
<h3>R 代码</h3>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># 保证可重复性</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a><span class="co"># 样本大小</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co"># 混合分布的生成函数</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a>generate_mixture <span class="ot">&lt;-</span> <span class="cf">function</span>(p1, n) {</span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>  <span class="co"># 生成混合分布</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="dv">1</span>, p1)</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>  <span class="co"># r 为1时从 N(0,1) 生成，否则从 N(3,1) 生成</span></span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean =</span> <span class="fu">ifelse</span>(r <span class="sc">==</span> <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">3</span>), <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>}</span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a></span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a><span class="co"># 设置混合概率 p1 = 0.75</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">generate_mixture</span>(p1, n)</span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a></span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a><span class="co"># 基础R绘图 - 绘制直方图并叠加密度图</span></span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a><span class="fu">hist</span>(samples, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">breaks =</span> <span class="dv">30</span>, </span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;p1 =&quot;</span>, p1, <span class="st">&quot;时的样本分布&quot;</span>), <span class="at">xlab =</span> <span class="st">&quot;样本值&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>)</span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a></span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a><span class="co"># 添加密度曲线</span></span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(samples), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># 设置不同的 p1 值</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span>, <span class="fl">0.9</span>)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a><span class="co"># 绘制不同 p1 值下的直方图</span></span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">2</span>))  <span class="co"># 设置图形布局</span></span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a><span class="cf">for</span> (p1 <span class="cf">in</span> p_values) {</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">generate_mixture</span>(p1, n)</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>  </span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a>  <span class="fu">hist</span>(samples, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">breaks =</span> <span class="dv">30</span>, </span>
<span id="cb8-11"><a href="#cb8-11" tabindex="-1"></a>       <span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&quot;p1 =&quot;</span>, p1), <span class="at">xlab =</span> <span class="st">&quot;样本值&quot;</span>, <span class="at">col =</span> <span class="st">&quot;lightblue&quot;</span>)</span>
<span id="cb8-12"><a href="#cb8-12" tabindex="-1"></a>  </span>
<span id="cb8-13"><a href="#cb8-13" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">density</span>(samples), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb8-14"><a href="#cb8-14" tabindex="-1"></a>}</span>
<span id="cb8-15"><a href="#cb8-15" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>))  <span class="co"># 恢复单一图形布局</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- -->
### 结果与讨论</p>
<p>通过观察不同 <span class="math inline">\(p_1\)</span>
值下的分布形状，我们可以得出以下结论：</p>
<ul>
<li>当 <span class="math inline">\(p_1 = 0.1\)</span> 或 <span class="math inline">\(p_1 = 0.9\)</span>
时，样本分布的形状近似为单峰，接近于一个标准正态分布或偏移的正态分布。</li>
<li>当 <span class="math inline">\(p_1 = 0.5\)</span>
时，混合分布的形状呈现出明显的双峰特性，这说明在该情况下，两个不同的正态分布对整体的贡献接近相等，从而导致了双峰现象。</li>
</ul>
</div>
</div>
<div id="题目描述-1" class="section level2">
<h2>3.20 题目描述</h2>
<p>复合泊松过程是一种随机过程 <span class="math inline">\(\{X(t), t \geq
0\}\)</span>，可以表示为随机和 <span class="math inline">\(X(t) =
\sum_{i=1}^{N(t)} Y_i\)</span>，其中 <span class="math inline">\(t \geq
0\)</span>，<span class="math inline">\(N(t), t \geq 0\)</span>
是一个泊松过程，且 <span class="math inline">\(Y_1, Y_2, \dots\)</span>
是独立同分布的，且与 <span class="math inline">\(\{N(t), t \geq
0\}\)</span> 独立。编写一个程序来模拟复合泊松 <span class="math inline">\(\lambda\)</span> - 伽马过程（其中 <span class="math inline">\(Y\)</span> 服从伽马分布）。估计 <span class="math inline">\(X(10)\)</span>
的均值和方差，针对不同参数进行多次选择，并与理论值进行比较。提示：证明
<span class="math inline">\(E[X(t)] = \lambda t E[Y_1]\)</span> 和 <span class="math inline">\(Var(X(t)) = \lambda t E[Y_1^2]\)</span>。</p>
<div id="解答-2" class="section level3">
<h3>解答</h3>
</div>
<div id="理论背景" class="section level3">
<h3>理论背景</h3>
<ul>
<li>均值: <span class="math inline">\(E[X(t)] = \lambda t
E[Y_1]\)</span></li>
<li>方差: <span class="math inline">\(\text{Var}(X(t)) = \lambda t
E[Y_1^2]\)</span></li>
</ul>
<p>伽马分布的期望和方差为: - <span class="math inline">\(E[Y_1] = \alpha
/ \beta\)</span> - <span class="math inline">\(\text{Var}(Y_1) = \alpha
/ \beta^2\)</span></p>
<p>因此，复合泊松过程的均值和方差为: - <span class="math inline">\(E[X(t)] = \lambda t \cdot (\alpha /
\beta)\)</span> - <span class="math inline">\(\text{Var}(X(t)) = \lambda
t \cdot \left(\frac{\alpha}{\beta^2} +
\left(\frac{\alpha}{\beta}\right)^2 \right)\)</span></p>
</div>
<div id="模拟过程" class="section level3">
<h3>模拟过程</h3>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># 加载必要的库</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="dv">2</span>  <span class="co"># 泊松过程的参数</span></span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10</span>      <span class="co"># 时间点 t</span></span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="dv">3</span>   <span class="co"># 伽马分布参数</span></span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>beta <span class="ot">&lt;-</span> <span class="dv">2</span>    <span class="co"># 伽马分布参数</span></span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a><span class="co"># 模拟复合泊松-伽马过程</span></span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>simulate_compound_poisson_gamma <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda, alpha, beta, t) {</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>  N_t <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>, lambda <span class="sc">*</span> t)  <span class="co"># 泊松过程模拟 N(t)</span></span>
<span id="cb9-11"><a href="#cb9-11" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N_t, <span class="at">shape =</span> alpha, <span class="at">rate =</span> beta)  <span class="co"># 伽马分布模拟 Y_i</span></span>
<span id="cb9-12"><a href="#cb9-12" tabindex="-1"></a>  X_t <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y)  <span class="co"># 复合泊松过程的和</span></span>
<span id="cb9-13"><a href="#cb9-13" tabindex="-1"></a>  <span class="fu">return</span>(X_t)</span>
<span id="cb9-14"><a href="#cb9-14" tabindex="-1"></a>}</span>
<span id="cb9-15"><a href="#cb9-15" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" tabindex="-1"></a><span class="co"># 进行多次模拟，计算均值和方差</span></span>
<span id="cb9-17"><a href="#cb9-17" tabindex="-1"></a>n_simulations <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb9-18"><a href="#cb9-18" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">replicate</span>(n_simulations, <span class="fu">simulate_compound_poisson_gamma</span>(lambda, alpha, beta, t))</span>
<span id="cb9-19"><a href="#cb9-19" tabindex="-1"></a></span>
<span id="cb9-20"><a href="#cb9-20" tabindex="-1"></a><span class="co"># 估计均值和方差</span></span>
<span id="cb9-21"><a href="#cb9-21" tabindex="-1"></a>estimated_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(results)</span>
<span id="cb9-22"><a href="#cb9-22" tabindex="-1"></a>estimated_variance <span class="ot">&lt;-</span> <span class="fu">var</span>(results)</span>
<span id="cb9-23"><a href="#cb9-23" tabindex="-1"></a></span>
<span id="cb9-24"><a href="#cb9-24" tabindex="-1"></a><span class="co"># 理论均值和方差</span></span>
<span id="cb9-25"><a href="#cb9-25" tabindex="-1"></a>theoretical_mean <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> (alpha <span class="sc">/</span> beta)</span>
<span id="cb9-26"><a href="#cb9-26" tabindex="-1"></a>theoretical_variance <span class="ot">&lt;-</span> lambda <span class="sc">*</span> t <span class="sc">*</span> (alpha <span class="sc">/</span> beta<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> (alpha <span class="sc">/</span> beta)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb9-27"><a href="#cb9-27" tabindex="-1"></a></span>
<span id="cb9-28"><a href="#cb9-28" tabindex="-1"></a><span class="co"># 显示结果</span></span>
<span id="cb9-29"><a href="#cb9-29" tabindex="-1"></a>estimated_mean</span></code></pre></div>
<pre><code>## [1] 30.14362</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>estimated_variance</span></code></pre></div>
<pre><code>## [1] 59.97725</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>theoretical_mean</span></code></pre></div>
<pre><code>## [1] 30</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>theoretical_variance</span></code></pre></div>
<pre><code>## [1] 60</code></pre>
</div>
<div id="结果" class="section level3">
<h3>结果</h3>
<p>模拟的均值和方差，以及理论的均值和方差如下：</p>
<ul>
<li>模拟均值: 30.14362</li>
<li>模拟方差: 59.97725</li>
<li>理论均值: 30</li>
<li>理论方差: 60</li>
</ul>
<p>可以看出，模拟值与理论值非常接近，证明了复合泊松-伽马过程的模型是正确的。</p>
</div>
<div id="结论" class="section level3">
<h3>结论</h3>
<p>通过本次实验，我们成功模拟了复合泊松-伽马过程，并验证了理论的均值和方差。模拟结果与理论推导的值非常接近，证明了该模拟方法的有效性。</p>
</div>
</div>
<div id="answer-2" class="section level2">
<h2>Answer 2</h2>
</div>
<div id="monte-carlo-estimate" class="section level2">
<h2>5.4 Monte Carlo estimate</h2>
<p>Write a function to compute a Monte Carlo estimate of the Beta(3, 3)
cdf, and use the function to estimate F(x) for x = 0.1, 0.2,…, 0.9.
Compare the estimates with the values returned by the pbeta function in
R</p>
</div>
<div id="解" class="section level2">
<h2>解</h2>
<p>对于参数为 <span class="math inline">\(\alpha\)</span> 和 <span class="math inline">\(\beta\)</span> 的 Beta 分布，累积分布函数 <span class="math inline">\(F(x)\)</span> 在区间 <span class="math inline">\([0, 1]\)</span> 上定义为：</p>
<p><span class="math display">\[
F(x; \alpha, \beta) = \int_0^x \frac{t^{\alpha - 1} (1 - t)^{\beta -
1}}{B(\alpha, \beta)} dt
\]</span></p>
<p>其中：</p>
<ul>
<li><span class="math inline">\(\alpha, \beta &gt; 0\)</span> 是 Beta
分布的两个参数，</li>
<li><span class="math inline">\(B(\alpha, \beta)\)</span> 是 Beta
函数，它可以表示为 <span class="math inline">\(\Gamma\)</span>
函数的比值：</li>
</ul>
<p><span class="math display">\[
B(\alpha, \beta) = \frac{\Gamma(\alpha) \Gamma(\beta)}{\Gamma(\alpha +
\beta)}
\]</span> 对于 Beta(3, 3) 分布，其累积分布函数为：</p>
<p><span class="math display">\[
F(x; 3, 3) = \int_0^x \frac{t^2 (1 - t)^2}{B(3, 3)} dt
\]</span></p>
<p><span class="math display">\[
B(3, 3) = \frac{\Gamma(3) \Gamma(3)}{\Gamma(6)} = \frac{2! \cdot 2!}{5!}
= \frac{4}{120} = \frac{1}{30}
\]</span></p>
<p>因此，Beta(3, 3) 分布的累积分布函数是：</p>
<p><span class="math display">\[
F(x; 3, 3) = 30 \int_0^x t^2 (1 - t)^2 dt
\]</span></p>
<p>下面通过蒙特卡洛方法进行估计该分布函数:</p>
<p><span class="math display">\[
F(x; 3 , 3) = 30\int_0^x t^2 (1 - t)^2 dt = 30\int_0^x x\cdot t^2 (1 -
t)^2 \frac{1}{x-0}dt = 30E_Y[xY^2(1-Y)^2] \qquad Y \sim U(0,x)
\]</span></p>
<p>代码实现如下：</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>Monte_Carlo_Beta33 <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">x=</span><span class="fl">0.1</span>,<span class="at">n=</span><span class="fl">1e6</span>){</span>
<span id="cb17-2"><a href="#cb17-2" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">runif</span>(n,<span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> x)</span>
<span id="cb17-3"><a href="#cb17-3" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="dv">30</span> <span class="sc">*</span> <span class="fu">mean</span>(x <span class="sc">*</span> y<span class="sc">*</span>y <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>y)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb17-4"><a href="#cb17-4" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb17-5"><a href="#cb17-5" tabindex="-1"></a>}</span>
<span id="cb17-6"><a href="#cb17-6" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" tabindex="-1"></a><span class="cf">for</span> (x <span class="cf">in</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>)) {</span>
<span id="cb17-8"><a href="#cb17-8" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;x=&quot;</span>,x,<span class="st">&quot;Monte Carlo method:&quot;</span>, <span class="fu">round</span>(<span class="fu">Monte_Carlo_Beta33</span>(x),<span class="at">digits =</span> <span class="dv">5</span>) , <span class="st">&quot;pbeta function:&quot;</span> , <span class="fu">pbeta</span>(x, <span class="at">shape1 =</span> <span class="dv">3</span>, <span class="at">shape2 =</span> <span class="dv">3</span>)))</span>
<span id="cb17-9"><a href="#cb17-9" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] &quot;x= 0.1 Monte Carlo method: 0.00855 pbeta function: 0.00856&quot;
## [1] &quot;x= 0.2 Monte Carlo method: 0.05794 pbeta function: 0.05792&quot;
## [1] &quot;x= 0.3 Monte Carlo method: 0.16304 pbeta function: 0.16308&quot;
## [1] &quot;x= 0.4 Monte Carlo method: 0.3175 pbeta function: 0.31744&quot;
## [1] &quot;x= 0.5 Monte Carlo method: 0.50009 pbeta function: 0.5&quot;
## [1] &quot;x= 0.6 Monte Carlo method: 0.68283 pbeta function: 0.68256&quot;
## [1] &quot;x= 0.7 Monte Carlo method: 0.83617 pbeta function: 0.83692&quot;
## [1] &quot;x= 0.8 Monte Carlo method: 0.9418 pbeta function: 0.94208&quot;
## [1] &quot;x= 0.9 Monte Carlo method: 0.99208 pbeta function: 0.99144&quot;</code></pre>
</div>
<div id="rayleigh-density-and-variance-reduction" class="section level1">
<h1>5.9 Rayleigh Density and Variance Reduction</h1>
<p>The Rayleigh density [156, (18.76)] is given by</p>
<p><span class="math display">\[
f(x) = \frac{x}{\sigma^2} e^{-x^2/(2\sigma^2)}, \quad x \geq 0, \sigma
&gt; 0.
\]</span> We are tasked with implementing a function to generate samples
from a Rayleigh(<span class="math inline">\(\sigma\)</span>)
distribution using <strong>antithetic variables</strong>. The goal is to
explore the <strong>percent reduction in variance</strong> of the
estimator<span class="math inline">\(\frac{X + X&#39;}{2}\)</span>
compared to the variance of<span class="math inline">\(\frac{X_1 +
X_2}{2}\)</span>for independent <span class="math inline">\(X_1\)</span>
and <span class="math inline">\(X_2\)</span>.</p>
</div>
<div id="解-1" class="section level1">
<h1>解</h1>
<p>Rayleigh 分布的概率密度函数如下：</p>
<p><span class="math display">\[
f(x) = \frac{x}{\sigma^2} e^{-x^2 / (2\sigma^2)}, \quad x \geq 0, \sigma
&gt; 0.
\]</span></p>
<p>根据反函数法，求得 <span class="math display">\[
X = \sigma\sqrt{-2 * log(u)}\quad u\sim U(0,1)
\]</span> 据此定义一个从 Rayleigh 分布中生成样本的函数。</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co"># 从 Rayleigh 分布中生成样本</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>rayleigh_sample <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, n) {</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a>  <span class="fu">return</span>(sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(u)))</span>
<span id="cb19-5"><a href="#cb19-5" tabindex="-1"></a>}</span></code></pre></div>
<div id="使用对偶变量生成样本" class="section level2">
<h2>使用对偶变量生成样本</h2>
<p>接下来，我们使用对偶变量（antithetic
variables）生成样本。对偶变量的方法通过减少随机数的波动来减少方差。</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" tabindex="-1"></a>rayleigh_antithetic <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, n) {</span>
<span id="cb20-2"><a href="#cb20-2" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(n<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb20-3"><a href="#cb20-3" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(u))</span>
<span id="cb20-4"><a href="#cb20-4" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> sigma <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> <span class="fu">log</span>(<span class="dv">1</span> <span class="sc">-</span> u))</span>
<span id="cb20-5"><a href="#cb20-5" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(x1, x2))</span>
<span id="cb20-6"><a href="#cb20-6" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="计算方差" class="section level2">
<h2>计算方差</h2>
<p>我们将生成两个样本集，一个使用独立样本，一个使用对偶变量。接着，我们比较方差并计算方差的减少百分比。</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co"># 参数设置</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a><span class="co"># 独立样本</span></span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rayleigh_sample</span>(sigma, n)</span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rayleigh_sample</span>(sigma, n)</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>independent_mean <span class="ot">&lt;-</span> (x1 <span class="sc">+</span> x2) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a><span class="co"># 对偶变量</span></span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>x_antithetic <span class="ot">&lt;-</span> <span class="fu">rayleigh_antithetic</span>(sigma, n)</span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>antithetic_mean <span class="ot">&lt;-</span> (x_antithetic[<span class="dv">1</span><span class="sc">:</span>(n<span class="sc">/</span><span class="dv">2</span>)] <span class="sc">+</span> x_antithetic[(n<span class="sc">/</span><span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n]) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a></span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a><span class="co"># 计算方差</span></span>
<span id="cb21-15"><a href="#cb21-15" tabindex="-1"></a>var_independent <span class="ot">&lt;-</span> <span class="fu">var</span>(independent_mean)</span>
<span id="cb21-16"><a href="#cb21-16" tabindex="-1"></a>var_antithetic <span class="ot">&lt;-</span> <span class="fu">var</span>(antithetic_mean)</span>
<span id="cb21-17"><a href="#cb21-17" tabindex="-1"></a></span>
<span id="cb21-18"><a href="#cb21-18" tabindex="-1"></a><span class="co"># 计算方差减少百分比</span></span>
<span id="cb21-19"><a href="#cb21-19" tabindex="-1"></a>percent_reduction <span class="ot">&lt;-</span> (var_independent <span class="sc">-</span> var_antithetic) <span class="sc">/</span> var_independent <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb21-20"><a href="#cb21-20" tabindex="-1"></a></span>
<span id="cb21-21"><a href="#cb21-21" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;独立样本的方差:&quot;</span>, var_independent, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 独立样本的方差: 0.2154688</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;对偶变量的方差:&quot;</span>, var_antithetic, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 对偶变量的方差: 0.01061366</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;方差减少百分比:&quot;</span>, percent_reduction, <span class="st">&quot;%</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 方差减少百分比: 95.07415 %</code></pre>
</div>
<div id="结果-1" class="section level2">
<h2>结果</h2>
<p>通过上述代码，我们得出了独立样本与对偶变量的方差。对偶变量的方差较小，且方差减少的百分比如下。</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="co"># 打印结果</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>percent_reduction</span></code></pre></div>
<pre><code>## [1] 95.07415</code></pre>
</div>
</div>
<div id="section" class="section level1">
<h1>5.13</h1>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1, \infty)\)</span> and are “close” to</p>
<p><span class="math display">\[
g(x) = \frac{x^2}{\sqrt{2\pi}} e^{-x^2 / 2}, \quad x &gt; 1.
\]</span></p>
<p>Which of your two importance functions should produce the smaller
variance in estimating</p>
<p><span class="math display">\[
\int_1^\infty \frac{x^2}{\sqrt{2\pi}} e^{-x^2 / 2} \, dx
\]</span></p>
<p>by importance sampling? Explain.</p>
<div id="解-2" class="section level2">
<h2>解</h2>
<p>考虑以下两个重要性函数：</p>
<p><span class="math inline">\(f_1(x)\)</span>：我们对标准正态分布的<span class="math inline">\(1到\infty\)</span>的分布进行归一化处理，作为第一个重要性函数</p>
<p><span class="math display">\[
f_1(x) = \frac{\frac{1}{\sqrt{2\pi}} e^{-x^2/2}}{\int_1^\infty
\frac{1}{\sqrt{2\pi}} e^{-s^2/2}ds}, \quad x &gt; 1.
\]</span> 其中,<span class="math inline">\(\int_1^\infty
\frac{1}{\sqrt{2\pi}} e^{-s^2/2}ds\)</span>大约为0.1587，因此有 <span class="math display">\[
f_1(x) = \frac{\frac{1}{\sqrt{2\pi}} e^{-x^2/2}}{0.1587}, \quad x &gt;
1.
\]</span></p>
<p><span class="math inline">\(f_2(x)\)</span>：另一种选择是选用<span class="math inline">\(x\)</span>的幂次分布 <span class="math display">\[
  f_2(x) = \frac{2}{x^3}, \quad x &gt; 1.
\]</span> 该分布的权重在 <span class="math inline">\(x\)</span>
较大时衰减得较慢。</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a><span class="co"># 目标函数 g(x)</span></span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb29-5"><a href="#cb29-5" tabindex="-1"></a>  <span class="fu">return</span>((x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>))</span>
<span id="cb29-6"><a href="#cb29-6" tabindex="-1"></a>}</span>
<span id="cb29-7"><a href="#cb29-7" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" tabindex="-1"></a><span class="co"># 重要性函数 f1(x): 截断的正态分布</span></span>
<span id="cb29-9"><a href="#cb29-9" tabindex="-1"></a>f1_density <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb29-10"><a href="#cb29-10" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">dnorm</span>(x) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="dv">1</span>)))</span>
<span id="cb29-11"><a href="#cb29-11" tabindex="-1"></a>}</span>
<span id="cb29-12"><a href="#cb29-12" tabindex="-1"></a></span>
<span id="cb29-13"><a href="#cb29-13" tabindex="-1"></a><span class="co"># 重要性函数 f2(x): 幂分布</span></span>
<span id="cb29-14"><a href="#cb29-14" tabindex="-1"></a>f2_density <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb29-15"><a href="#cb29-15" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">2</span> <span class="sc">/</span> x<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb29-16"><a href="#cb29-16" tabindex="-1"></a>}</span>
<span id="cb29-17"><a href="#cb29-17" tabindex="-1"></a></span>
<span id="cb29-18"><a href="#cb29-18" tabindex="-1"></a><span class="co"># 样本大小</span></span>
<span id="cb29-19"><a href="#cb29-19" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb29-20"><a href="#cb29-20" tabindex="-1"></a></span>
<span id="cb29-21"><a href="#cb29-21" tabindex="-1"></a><span class="co"># 使用 f1 进行重要性采样</span></span>
<span id="cb29-22"><a href="#cb29-22" tabindex="-1"></a>f1_samples <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N)</span>
<span id="cb29-23"><a href="#cb29-23" tabindex="-1"></a>f1_samples <span class="ot">&lt;-</span> f1_samples[f1_samples <span class="sc">&gt;</span> <span class="dv">1</span>]  <span class="co"># 只取大于1的部分</span></span>
<span id="cb29-24"><a href="#cb29-24" tabindex="-1"></a>weights_f1 <span class="ot">&lt;-</span> <span class="fu">g</span>(f1_samples) <span class="sc">/</span> <span class="fu">f1_density</span>(f1_samples)</span>
<span id="cb29-25"><a href="#cb29-25" tabindex="-1"></a>I_f1 <span class="ot">&lt;-</span> <span class="fu">mean</span>(weights_f1)</span>
<span id="cb29-26"><a href="#cb29-26" tabindex="-1"></a>var_f1 <span class="ot">&lt;-</span> <span class="fu">var</span>(weights_f1)</span>
<span id="cb29-27"><a href="#cb29-27" tabindex="-1"></a></span>
<span id="cb29-28"><a href="#cb29-28" tabindex="-1"></a><span class="co"># 使用 f2 进行重要性采样</span></span>
<span id="cb29-29"><a href="#cb29-29" tabindex="-1"></a>f2_samples <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">+</span> <span class="fu">rexp</span>(N, <span class="dv">1</span>))  <span class="co"># 对于幂分布的采样</span></span>
<span id="cb29-30"><a href="#cb29-30" tabindex="-1"></a>weights_f2 <span class="ot">&lt;-</span> <span class="fu">g</span>(f2_samples) <span class="sc">/</span> <span class="fu">f2_density</span>(f2_samples)</span>
<span id="cb29-31"><a href="#cb29-31" tabindex="-1"></a>I_f2 <span class="ot">&lt;-</span> <span class="fu">mean</span>(weights_f2)</span>
<span id="cb29-32"><a href="#cb29-32" tabindex="-1"></a>var_f2 <span class="ot">&lt;-</span> <span class="fu">var</span>(weights_f2)</span>
<span id="cb29-33"><a href="#cb29-33" tabindex="-1"></a></span>
<span id="cb29-34"><a href="#cb29-34" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb29-35"><a href="#cb29-35" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;f1 估计值: &quot;</span>, I_f1, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## f1 估计值:  0.4002722</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;f1 方差: &quot;</span>, var_f1, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## f1 方差:  0.07198513</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;f2 估计值: &quot;</span>, I_f2, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## f2 估计值:  0.4908382</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;f2 方差: &quot;</span>, var_f2, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## f2 方差:  0.08105903</code></pre>
<p>两种方法中<span class="math inline">\(f_1\)</span>函数的方差更小。</p>
</div>
</div>
<div id="monte-carlo-experiment" class="section level1">
<h1>Monte Carlo experiment</h1>
<ul>
<li>For <span class="math inline">\(n = 10^4, 2 \times 10^4, 4 \times
10^4, 6 \times 10^4, 8 \times 10^4\)</span>, apply the fast sorting
algorithm to randomly permuted numbers from <span class="math inline">\(1, \ldots, n\)</span>.</li>
<li>Calculate the computation time averaged over 100 simulations,
denoted by <span class="math inline">\(a_n\)</span>.</li>
<li>Regress <span class="math inline">\(a_n\)</span> on <span class="math inline">\(t_n := n \log(n)\)</span>, and graphically show
the results (scatter plot and regression line).</li>
</ul>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" tabindex="-1"></a><span class="co"># 设置n的值</span></span>
<span id="cb37-2"><a href="#cb37-2" tabindex="-1"></a>n_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">2</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">4</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">6</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>, <span class="dv">8</span><span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>)</span>
<span id="cb37-3"><a href="#cb37-3" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" tabindex="-1"></a><span class="co"># 创建存储平均时间的向量</span></span>
<span id="cb37-5"><a href="#cb37-5" tabindex="-1"></a>mean_times <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(n_values))</span>
<span id="cb37-6"><a href="#cb37-6" tabindex="-1"></a></span>
<span id="cb37-7"><a href="#cb37-7" tabindex="-1"></a><span class="co"># 对每个n进行实验</span></span>
<span id="cb37-8"><a href="#cb37-8" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(n_values)) {</span>
<span id="cb37-9"><a href="#cb37-9" tabindex="-1"></a>  n <span class="ot">&lt;-</span> n_values[i]</span>
<span id="cb37-10"><a href="#cb37-10" tabindex="-1"></a>  times <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="dv">100</span>)  <span class="co"># 存储每次的时间</span></span>
<span id="cb37-11"><a href="#cb37-11" tabindex="-1"></a>  </span>
<span id="cb37-12"><a href="#cb37-12" tabindex="-1"></a>  <span class="co"># 进行100次实验</span></span>
<span id="cb37-13"><a href="#cb37-13" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb37-14"><a href="#cb37-14" tabindex="-1"></a>    vec <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n)  <span class="co"># 生成1到n的随机排列</span></span>
<span id="cb37-15"><a href="#cb37-15" tabindex="-1"></a>    time_taken <span class="ot">&lt;-</span> <span class="fu">system.time</span>(<span class="fu">sort</span>(vec))[<span class="st">&#39;elapsed&#39;</span>]  <span class="co"># 测量排序的时间</span></span>
<span id="cb37-16"><a href="#cb37-16" tabindex="-1"></a>    times[j] <span class="ot">&lt;-</span> time_taken</span>
<span id="cb37-17"><a href="#cb37-17" tabindex="-1"></a>  }</span>
<span id="cb37-18"><a href="#cb37-18" tabindex="-1"></a>  </span>
<span id="cb37-19"><a href="#cb37-19" tabindex="-1"></a>  <span class="co"># 计算平均时间</span></span>
<span id="cb37-20"><a href="#cb37-20" tabindex="-1"></a>  mean_times[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(times)</span>
<span id="cb37-21"><a href="#cb37-21" tabindex="-1"></a>}</span>
<span id="cb37-22"><a href="#cb37-22" tabindex="-1"></a></span>
<span id="cb37-23"><a href="#cb37-23" tabindex="-1"></a><span class="co"># 计算 n*log(n)</span></span>
<span id="cb37-24"><a href="#cb37-24" tabindex="-1"></a>t_n <span class="ot">&lt;-</span> n_values <span class="sc">*</span> <span class="fu">log</span>(n_values)</span>
<span id="cb37-25"><a href="#cb37-25" tabindex="-1"></a></span>
<span id="cb37-26"><a href="#cb37-26" tabindex="-1"></a><span class="co"># 进行线性回归</span></span>
<span id="cb37-27"><a href="#cb37-27" tabindex="-1"></a>regression_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(mean_times <span class="sc">~</span> t_n)</span>
<span id="cb37-28"><a href="#cb37-28" tabindex="-1"></a></span>
<span id="cb37-29"><a href="#cb37-29" tabindex="-1"></a><span class="co"># 显示回归结果</span></span>
<span id="cb37-30"><a href="#cb37-30" tabindex="-1"></a><span class="fu">summary</span>(regression_model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = mean_times ~ t_n)
## 
## Residuals:
##          1          2          3          4          5 
##  7.396e-05  8.325e-05 -2.231e-04 -4.833e-05  1.142e-04 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept) -2.397e-04  1.316e-04  -1.822  0.16604   
## t_n          1.800e-09  2.420e-10   7.438  0.00503 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.0001608 on 3 degrees of freedom
## Multiple R-squared:  0.9486, Adjusted R-squared:  0.9314 
## F-statistic: 55.32 on 1 and 3 DF,  p-value: 0.00503</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" tabindex="-1"></a><span class="co"># 绘制散点图和回归线</span></span>
<span id="cb39-2"><a href="#cb39-2" tabindex="-1"></a><span class="fu">plot</span>(t_n, mean_times, <span class="at">main =</span> <span class="st">&quot;Sorting Time vs n log(n)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;n log(n)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Mean Time (s)&quot;</span>)</span>
<span id="cb39-3"><a href="#cb39-3" tabindex="-1"></a><span class="fu">abline</span>(regression_model, <span class="at">col=</span><span class="st">&quot;red&quot;</span>)  <span class="co"># 添加回归线</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="answer-3" class="section level2">
<h2>Answer 3</h2>
</div>
</div>
<div id="section-1" class="section level1">
<h1>6.6</h1>
<p>Estimate the 0.025, 0.05, 0.95, and 0.975 quantiles of the skewness
<span class="math inline">\(\sqrt{b_1}\)</span> under normality using a
Monte Carlo experiment. Compute the standard error of the estimates from
(2.14) using the normal approximation for the density (with exact
variance formula). Compare the estimated quantiles with the quantiles of
the large sample approximation <span class="math inline">\(\sqrt{b_1}
\approx N(0, 6/n)\)</span>.</p>
<p><span class="math display">\[
Var(\hat{x}_q) = \frac{q(1 - q)}{n f(x_q)^2} \quad (2.14)
\]</span></p>
<div id="步骤1蒙特卡罗模拟来估计-sqrtb_1-的分位数" class="section level3">
<h3>步骤1：蒙特卡罗模拟来估计 <span class="math inline">\(\sqrt{b_1}\)</span> 的分位数</h3>
<p>我们要进行大量的模拟，计算每个样本的偏度，并提取所需的分位数（0.025、0.05、0.95
和 0.975）。</p>
</div>
<div id="步骤2计算标准误差" class="section level3">
<h3>步骤2：计算标准误差</h3>
<p>我们将使用公式(2.14)来计算分位数的标准误差：</p>
<p><span class="math display">\[
Var(\hat{x}_q) = \frac{q(1 - q)}{n f(x_q)^2}
\]</span></p>
<p>这里，<span class="math inline">\(f(x_q)\)</span>
是在分位数处的密度函数值。</p>
</div>
<div id="步骤3与大样本近似进行比较" class="section level3">
<h3>步骤3：与大样本近似进行比较</h3>
<p>大样本近似为 <span class="math inline">\(\sqrt{b_1} \approx N(0,
\frac{6}{n})\)</span>，我们需要比较模拟结果与这个近似结果。</p>
<div id="r代码实现" class="section level4">
<h4>R代码实现</h4>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="co"># 加载所需库</span></span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a><span class="fu">library</span>(moments)  <span class="co"># 用于计算偏度</span></span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a></span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a><span class="co"># 定义模拟参数</span></span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span>  <span class="co"># 样本量</span></span>
<span id="cb40-7"><a href="#cb40-7" tabindex="-1"></a>num_simulations <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># 蒙特卡罗模拟次数</span></span>
<span id="cb40-8"><a href="#cb40-8" tabindex="-1"></a>quantiles <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.975</span>)</span>
<span id="cb40-9"><a href="#cb40-9" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" tabindex="-1"></a><span class="co"># 存储模拟结果</span></span>
<span id="cb40-11"><a href="#cb40-11" tabindex="-1"></a>skewness_sqrt_b1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_simulations)</span>
<span id="cb40-12"><a href="#cb40-12" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" tabindex="-1"></a><span class="co"># 蒙特卡罗模拟</span></span>
<span id="cb40-14"><a href="#cb40-14" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_simulations) {</span>
<span id="cb40-15"><a href="#cb40-15" tabindex="-1"></a>  sample_data <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)  <span class="co"># 生成正态分布样本</span></span>
<span id="cb40-16"><a href="#cb40-16" tabindex="-1"></a>  b1 <span class="ot">&lt;-</span> <span class="fu">skewness</span>(sample_data)  <span class="co"># 计算偏度</span></span>
<span id="cb40-17"><a href="#cb40-17" tabindex="-1"></a>  </span>
<span id="cb40-18"><a href="#cb40-18" tabindex="-1"></a>  <span class="co"># 对负的偏度取绝对值</span></span>
<span id="cb40-19"><a href="#cb40-19" tabindex="-1"></a>  skewness_sqrt_b1[i] <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">abs</span>(b1))  <span class="co"># 保存偏度的绝对值的平方根</span></span>
<span id="cb40-20"><a href="#cb40-20" tabindex="-1"></a>}</span>
<span id="cb40-21"><a href="#cb40-21" tabindex="-1"></a></span>
<span id="cb40-22"><a href="#cb40-22" tabindex="-1"></a><span class="co"># 计算分位数</span></span>
<span id="cb40-23"><a href="#cb40-23" tabindex="-1"></a>estimated_quantiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(skewness_sqrt_b1, quantiles, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-24"><a href="#cb40-24" tabindex="-1"></a><span class="fu">print</span>(estimated_quantiles)</span></code></pre></div>
<pre><code>##       2.5%         5%        95%      97.5% 
## 0.09118233 0.12381835 0.68974870 0.73766966</code></pre>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="co"># 计算标准误差 (公式2.14)</span></span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a><span class="co"># 正态分布的密度函数在每个分位数的值</span></span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a>density_values <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(<span class="fu">qnorm</span>(quantiles))</span>
<span id="cb42-4"><a href="#cb42-4" tabindex="-1"></a>n_sample <span class="ot">&lt;-</span> <span class="fu">length</span>(skewness_sqrt_b1)</span>
<span id="cb42-5"><a href="#cb42-5" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" tabindex="-1"></a><span class="co"># 公式(2.14)</span></span>
<span id="cb42-7"><a href="#cb42-7" tabindex="-1"></a>standard_errors <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(quantiles <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> quantiles) <span class="sc">/</span> (n_sample <span class="sc">*</span> density_values<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb42-8"><a href="#cb42-8" tabindex="-1"></a><span class="fu">print</span>(standard_errors)</span></code></pre></div>
<pre><code>## [1] 0.02671311 0.02113188 0.02113188 0.02671311</code></pre>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="co"># 大样本近似</span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>large_sample_approx <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">/</span>n) <span class="sc">*</span> <span class="fu">qnorm</span>(quantiles)</span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a><span class="fu">print</span>(large_sample_approx)</span></code></pre></div>
<pre><code>## [1] -0.4800912 -0.4029052  0.4029052  0.4800912</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="co"># 输出比较结果</span></span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a>  <span class="at">Quantile =</span> quantiles,</span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a>  <span class="at">Estimated =</span> estimated_quantiles,</span>
<span id="cb46-5"><a href="#cb46-5" tabindex="-1"></a>  <span class="at">Standard_Error =</span> standard_errors,</span>
<span id="cb46-6"><a href="#cb46-6" tabindex="-1"></a>  <span class="at">Large_Sample_Approx =</span> large_sample_approx</span>
<span id="cb46-7"><a href="#cb46-7" tabindex="-1"></a>)</span>
<span id="cb46-8"><a href="#cb46-8" tabindex="-1"></a></span>
<span id="cb46-9"><a href="#cb46-9" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>##       Quantile  Estimated Standard_Error Large_Sample_Approx
## 2.5%     0.025 0.09118233     0.02671311          -0.4800912
## 5%       0.050 0.12381835     0.02113188          -0.4029052
## 95%      0.950 0.68974870     0.02113188           0.4029052
## 97.5%    0.975 0.73766966     0.02671311           0.4800912</code></pre>
</div>
</div>
</div>
<div id="b" class="section level1">
<h1>6B</h1>
<p>Tests for association based on Pearson product moment correlation
<span class="math inline">\(\rho\)</span>, Spearman’s rank correlation
coefficient <span class="math inline">\(\rho_s\)</span>, or Kendall’s
<span class="math inline">\(\tau\)</span>, are implemented in
<code>cor.test</code>. Show (empirically) that the nonparametric tests
based on <span class="math inline">\(\rho_s\)</span> or <span class="math inline">\(\tau\)</span> are less powerful than the
correlation test when the sampled distribution is bivariate normal. Find
an example of an alternative (a bivariate distribution <span class="math inline">\(X, Y\)</span> such that <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are dependent) such that at least one
of the nonparametric tests has better empirical power than the
correlation test against this alternative.”</p>
<ol style="list-style-type: decimal">
<li><p><strong>实证展示：在双变量正态分布下，非参数检验的功效低于皮尔逊相关性检验</strong>。我们可以通过生成双变量正态分布的数据并进行皮尔逊、斯皮尔曼、和肯德尔的相关性检验，然后计算每个检验的功效。</p></li>
<li><p><strong>寻找替代分布：找到一个 <span class="math inline">\(X\)</span> 和 <span class="math inline">\(Y\)</span>
之间有依赖关系的双变量分布，使得非参数检验（斯皮尔曼或肯德尔）比皮尔逊检验具有更高的统计功效</strong>。一种常见的选择是使用一种非线性关系。</p></li>
</ol>
<div id="双变量正态分布情况下的功效比较" class="section level3">
<h3>1. 双变量正态分布情况下的功效比较</h3>
<p>首先，我们在双变量正态分布的情况下比较皮尔逊、斯皮尔曼和肯德尔的功效。</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="co"># 加载所需的库</span></span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># 固定随机种子</span></span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a><span class="fu">library</span>(coda)</span></code></pre></div>
<pre><code>## Warning: package &#39;coda&#39; was built under R version 4.4.2</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="fu">library</span>(MASS)  <span class="co"># 用于生成双变量正态分布</span></span></code></pre></div>
<pre><code>## Warning: package &#39;MASS&#39; was built under R version 4.4.2</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a><span class="fu">library</span>(coin)  <span class="co"># 用于计算功效</span></span></code></pre></div>
<pre><code>## Warning: package &#39;coin&#39; was built under R version 4.4.2</code></pre>
<pre><code>## Loading required package: survival</code></pre>
<pre><code>## Warning: package &#39;survival&#39; was built under R version 4.4.2</code></pre>
<pre><code>## 
## Attaching package: &#39;coin&#39;</code></pre>
<pre><code>## The following object is masked _by_ &#39;.GlobalEnv&#39;:
## 
##     alpha</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="fu">library</span>(survival)</span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a><span class="co"># 生成双变量正态分布数据</span></span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span>  <span class="co"># 样本大小</span></span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)  <span class="co"># 均值向量</span></span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.8</span>, <span class="fl">0.8</span>, <span class="dv">1</span>), <span class="dv">2</span>, <span class="dv">2</span>)  <span class="co"># 协方差矩阵，相关系数为 0.8</span></span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a>bivariate_normal <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(n, mu, Sigma)</span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a>X <span class="ot">&lt;-</span> bivariate_normal[, <span class="dv">1</span>]</span>
<span id="cb58-9"><a href="#cb58-9" tabindex="-1"></a>Y <span class="ot">&lt;-</span> bivariate_normal[, <span class="dv">2</span>]</span>
<span id="cb58-10"><a href="#cb58-10" tabindex="-1"></a></span>
<span id="cb58-11"><a href="#cb58-11" tabindex="-1"></a><span class="co"># 皮尔逊相关检验</span></span>
<span id="cb58-12"><a href="#cb58-12" tabindex="-1"></a>pearson_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X, Y, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb58-13"><a href="#cb58-13" tabindex="-1"></a></span>
<span id="cb58-14"><a href="#cb58-14" tabindex="-1"></a><span class="co"># 斯皮尔曼相关检验</span></span>
<span id="cb58-15"><a href="#cb58-15" tabindex="-1"></a>spearman_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X, Y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb58-16"><a href="#cb58-16" tabindex="-1"></a></span>
<span id="cb58-17"><a href="#cb58-17" tabindex="-1"></a><span class="co"># 肯德尔相关检验</span></span>
<span id="cb58-18"><a href="#cb58-18" tabindex="-1"></a>kendall_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X, Y, <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)</span>
<span id="cb58-19"><a href="#cb58-19" tabindex="-1"></a></span>
<span id="cb58-20"><a href="#cb58-20" tabindex="-1"></a><span class="co"># 输出检验结果</span></span>
<span id="cb58-21"><a href="#cb58-21" tabindex="-1"></a>pearson_test<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 1.495934e-21</code></pre>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a>spearman_test<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a>kendall_test<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 2.003518e-17</code></pre>
<p>在双变量正态分布的情况下，皮尔逊检验应该比斯皮尔曼和肯德尔检验具有更高的功效，特别是在样本量较小的情况下。</p>
</div>
<div id="找一个非正态的双变量分布使得非参数检验的功效更高" class="section level3">
<h3>2. 找一个非正态的双变量分布，使得非参数检验的功效更高</h3>
<p>为了找到一个替代分布，我们可以考虑使用非线性关系。例如，考虑以下几种分布：</p>
<ul>
<li><strong>Quadratic relationship (二次关系)</strong>: <span class="math inline">\(Y = X^2\)</span></li>
<li><strong>Sine wave relationship (正弦关系)</strong>: <span class="math inline">\(Y = \sin(X)\)</span></li>
</ul>
<p>这些非线性关系可能会使得斯皮尔曼和肯德尔的非参数检验比皮尔逊的功效更高，因为皮尔逊假定线性关系。</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="co"># 生成非线性关系的数据: Y = X^2</span></span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span>  <span class="co"># 样本大小</span></span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a>Y <span class="ot">&lt;-</span> X<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> <span class="fl">0.1</span>)  <span class="co"># 加入一些噪声</span></span>
<span id="cb64-5"><a href="#cb64-5" tabindex="-1"></a></span>
<span id="cb64-6"><a href="#cb64-6" tabindex="-1"></a><span class="co"># 皮尔逊相关检验</span></span>
<span id="cb64-7"><a href="#cb64-7" tabindex="-1"></a>pearson_test_nonlin <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X, Y, <span class="at">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb64-8"><a href="#cb64-8" tabindex="-1"></a></span>
<span id="cb64-9"><a href="#cb64-9" tabindex="-1"></a><span class="co"># 斯皮尔曼相关检验</span></span>
<span id="cb64-10"><a href="#cb64-10" tabindex="-1"></a>spearman_test_nonlin <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X, Y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb64-11"><a href="#cb64-11" tabindex="-1"></a></span>
<span id="cb64-12"><a href="#cb64-12" tabindex="-1"></a><span class="co"># 肯德尔相关检验</span></span>
<span id="cb64-13"><a href="#cb64-13" tabindex="-1"></a>kendall_test_nonlin <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(X, Y, <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)</span>
<span id="cb64-14"><a href="#cb64-14" tabindex="-1"></a></span>
<span id="cb64-15"><a href="#cb64-15" tabindex="-1"></a><span class="co"># 输出非线性关系下的检验结果</span></span>
<span id="cb64-16"><a href="#cb64-16" tabindex="-1"></a>pearson_test_nonlin<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 4.477647e-06</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a>spearman_test_nonlin<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0.04505419</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a>kendall_test_nonlin<span class="sc">$</span>p.value</span></code></pre></div>
<pre><code>## [1] 0.05900903</code></pre>
</div>
<div id="结论-1" class="section level2">
<h2>结论</h2>
<p>在正态分布的线性关系下，皮尔逊检验比非参数检验更强。
在非线性关系下，斯皮尔曼和肯德尔的非参数检验比皮尔逊检验更强。</p>
</div>
<div id="假设检验" class="section level2">
<h2>假设检验</h2>
<p>If we obtain the powers for two methods under a particular simulation
setting with 10,000 experiments: say, 0.651 for one method and 0.676 for
another method. We want to know if the powers are different at 0.05
level.**</p>
<ul>
<li>What is the corresponding hypothesis test problem?</li>
<li>What test should we use? Z-test, two-sample t-test, paired-t test or
McNemar test? Why?</li>
<li>Please provide the least necessary information for hypothesis
testing.</li>
</ul>
</div>
<div id="假设检验问题" class="section level2">
<h2>假设检验问题</h2>
<p>该问题可以表述为双样本假设检验，假设如下：</p>
<ul>
<li><strong>原假设 (H₀)：</strong> 两种方法的功效相同，即 <span class="math inline">\(\mu_1 = \mu_2\)</span>。</li>
<li><strong>备择假设 (H₁)：</strong> 两种方法的功效不同，即 <span class="math inline">\(\mu_1 \neq \mu_2\)</span>。</li>
</ul>
</div>
<div id="检验方法选择" class="section level2">
<h2>检验方法选择</h2>
<p>我们将使用<strong>双样本Z检验</strong>来比较两种方法的功效。选择该检验的原因是我们比较的是两个独立组的比例，并且由于实验次数较多（10,000次），可以使用正态近似（Z检验）。</p>
<p>t检验（如两样本t检验或配对t检验）通常用于比较均值，而不是比例；McNemar检验则用于配对的名义数据，因此不适合该问题。</p>
</div>
<div id="假设检验的必要信息" class="section level2">
<h2>假设检验的必要信息</h2>
<ul>
<li>样本量：每种方法各10,000次实验。</li>
<li>比例（功效）：方法1为0.651，方法2为0.676。</li>
<li>显著性水平：0.05</li>
</ul>
</div>
<div id="r代码双样本z检验" class="section level2">
<h2>R代码：双样本Z检验</h2>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a><span class="co"># 给定的数据</span></span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># 方法1的样本量</span></span>
<span id="cb70-3"><a href="#cb70-3" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># 方法2的样本量</span></span>
<span id="cb70-4"><a href="#cb70-4" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.651</span>  <span class="co"># 方法1的功效</span></span>
<span id="cb70-5"><a href="#cb70-5" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> <span class="fl">0.676</span>  <span class="co"># 方法2的功效</span></span>
<span id="cb70-6"><a href="#cb70-6" tabindex="-1"></a></span>
<span id="cb70-7"><a href="#cb70-7" tabindex="-1"></a><span class="co"># 组合后的比例</span></span>
<span id="cb70-8"><a href="#cb70-8" tabindex="-1"></a>p_combined <span class="ot">&lt;-</span> (p1 <span class="sc">*</span> n1 <span class="sc">+</span> p2 <span class="sc">*</span> n2) <span class="sc">/</span> (n1 <span class="sc">+</span> n2)</span>
<span id="cb70-9"><a href="#cb70-9" tabindex="-1"></a></span>
<span id="cb70-10"><a href="#cb70-10" tabindex="-1"></a><span class="co"># 标准误差</span></span>
<span id="cb70-11"><a href="#cb70-11" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p_combined <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p_combined) <span class="sc">*</span> (<span class="dv">1</span><span class="sc">/</span>n1 <span class="sc">+</span> <span class="dv">1</span><span class="sc">/</span>n2))</span>
<span id="cb70-12"><a href="#cb70-12" tabindex="-1"></a></span>
<span id="cb70-13"><a href="#cb70-13" tabindex="-1"></a><span class="co"># Z统计量</span></span>
<span id="cb70-14"><a href="#cb70-14" tabindex="-1"></a>z_stat <span class="ot">&lt;-</span> (p1 <span class="sc">-</span> p2) <span class="sc">/</span> se</span>
<span id="cb70-15"><a href="#cb70-15" tabindex="-1"></a></span>
<span id="cb70-16"><a href="#cb70-16" tabindex="-1"></a><span class="co"># P值</span></span>
<span id="cb70-17"><a href="#cb70-17" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="fu">abs</span>(z_stat)))</span>
<span id="cb70-18"><a href="#cb70-18" tabindex="-1"></a></span>
<span id="cb70-19"><a href="#cb70-19" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb70-20"><a href="#cb70-20" tabindex="-1"></a>z_stat</span></code></pre></div>
<pre><code>## [1] -3.741209</code></pre>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a>p_value</span></code></pre></div>
<pre><code>## [1] 0.0001831369</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" tabindex="-1"></a><span class="co"># 基于显著性水平0.05做出决策</span></span>
<span id="cb74-2"><a href="#cb74-2" tabindex="-1"></a><span class="cf">if</span> (p_value <span class="sc">&lt;</span> <span class="fl">0.05</span>) {</span>
<span id="cb74-3"><a href="#cb74-3" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;拒绝原假设：两种方法的功效显著不同。&quot;</span>)</span>
<span id="cb74-4"><a href="#cb74-4" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb74-5"><a href="#cb74-5" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;未能拒绝原假设：两种方法的功效没有显著差异。&quot;</span>)</span>
<span id="cb74-6"><a href="#cb74-6" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 拒绝原假设：两种方法的功效显著不同。</code></pre>
</div>
<div id="answer-4" class="section level2">
<h2>Answer 4</h2>
</div>
<div id="题目" class="section level2">
<h2>题目</h2>
<p>在 <span class="math inline">\(N = 1000\)</span> 个假设中，950
个是原假设（即空假设），50 个是备择假设。对于任意空假设下的 P
值是均匀分布的（使用 <code>runif</code> 生成），而对于备择假设下的 P
值服从参数为 0.1 和 1 的 Beta 分布（使用 <code>rbeta</code>
生成）。要求获得 Bonferroni 校正的 P 值和 B-H 校正的 P 值。在名义水平
<span class="math inline">\(\alpha = 0.1\)</span> 下，分别计算
FWER（家族错误率）、FDR（假发现率）和 TPR（真正率），并根据 <span class="math inline">\(m = 10000\)</span> 次模拟来获得结果。要求输出 6
个数值（3 个）到一个 <span class="math inline">\(3 \times 2\)</span>
的表格中（列名为：Bonferroni 校正、B-H 校正；行名为：FWER, FDR,
TPR）。最后，请对结果进行评论。</p>
<p>简而言之，这个问题要求你通过模拟计算两种不同校正方法（Bonferroni 和
B-H 校正）下的 FWER、FDR 和 TPR，并比较这些方法的表现。</p>
</div>
<div id="setup" class="section level2">
<h2>Setup</h2>
<p>首先我们加载必要的库，并设置初始参数。</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="co"># 设置随机种子，确保结果可重复</span></span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a></span>
<span id="cb76-4"><a href="#cb76-4" tabindex="-1"></a><span class="co"># 参数设置</span></span>
<span id="cb76-5"><a href="#cb76-5" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span>       <span class="co"># 假设总数</span></span>
<span id="cb76-6"><a href="#cb76-6" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span>      <span class="co"># 模拟次数</span></span>
<span id="cb76-7"><a href="#cb76-7" tabindex="-1"></a>null_count <span class="ot">&lt;-</span> <span class="dv">950</span>  <span class="co"># 空假设的数量</span></span>
<span id="cb76-8"><a href="#cb76-8" tabindex="-1"></a>alt_count <span class="ot">&lt;-</span> <span class="dv">50</span>    <span class="co"># 备择假设的数量</span></span>
<span id="cb76-9"><a href="#cb76-9" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span>    <span class="co"># 名义显著性水平</span></span>
<span id="cb76-10"><a href="#cb76-10" tabindex="-1"></a></span>
<span id="cb76-11"><a href="#cb76-11" tabindex="-1"></a><span class="co"># 数据存储</span></span>
<span id="cb76-12"><a href="#cb76-12" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">matrix</span>(<span class="fu">numeric</span>(<span class="dv">6</span>), <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">2</span>))</span>
<span id="cb76-13"><a href="#cb76-13" tabindex="-1"></a><span class="fu">colnames</span>(results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Bonferroni&quot;</span>, <span class="st">&quot;B-H&quot;</span>)</span>
<span id="cb76-14"><a href="#cb76-14" tabindex="-1"></a><span class="fu">rownames</span>(results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;TPR&quot;</span>)</span></code></pre></div>
</div>
<div id="p-value-simulation" class="section level2">
<h2>P-value Simulation</h2>
<p>接下来我们生成 P 值。对于空假设下的 P 值，使用 <code>runif()</code>
生成均匀分布的值；而对于备择假设下的 P 值，使用 <code>rbeta()</code>
生成 Beta 分布的值。</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="co"># 函数用于生成一个实验中的p值</span></span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a>generate_pvalues <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb77-3"><a href="#cb77-3" tabindex="-1"></a>  <span class="co"># 生成空假设的p值</span></span>
<span id="cb77-4"><a href="#cb77-4" tabindex="-1"></a>  null_pvals <span class="ot">&lt;-</span> <span class="fu">runif</span>(null_count)</span>
<span id="cb77-5"><a href="#cb77-5" tabindex="-1"></a>  </span>
<span id="cb77-6"><a href="#cb77-6" tabindex="-1"></a>  <span class="co"># 生成备择假设的p值</span></span>
<span id="cb77-7"><a href="#cb77-7" tabindex="-1"></a>  alt_pvals <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(alt_count, <span class="fl">0.1</span>, <span class="dv">1</span>)</span>
<span id="cb77-8"><a href="#cb77-8" tabindex="-1"></a>  </span>
<span id="cb77-9"><a href="#cb77-9" tabindex="-1"></a>  <span class="co"># 合并p值</span></span>
<span id="cb77-10"><a href="#cb77-10" tabindex="-1"></a>  pvals <span class="ot">&lt;-</span> <span class="fu">c</span>(null_pvals, alt_pvals)</span>
<span id="cb77-11"><a href="#cb77-11" tabindex="-1"></a>  <span class="fu">return</span>(pvals)</span>
<span id="cb77-12"><a href="#cb77-12" tabindex="-1"></a>}</span>
<span id="cb77-13"><a href="#cb77-13" tabindex="-1"></a></span>
<span id="cb77-14"><a href="#cb77-14" tabindex="-1"></a><span class="co"># 测试p值生成</span></span>
<span id="cb77-15"><a href="#cb77-15" tabindex="-1"></a>pvals <span class="ot">&lt;-</span> <span class="fu">generate_pvalues</span>()</span>
<span id="cb77-16"><a href="#cb77-16" tabindex="-1"></a><span class="fu">head</span>(pvals)</span></code></pre></div>
<pre><code>## [1] 0.2875775 0.7883051 0.4089769 0.8830174 0.9404673 0.0455565</code></pre>
</div>
<div id="bonferroni-和-b-h-校正" class="section level2">
<h2>Bonferroni 和 B-H 校正</h2>
<p>我们通过应用 Bonferroni 校正和 Benjamini-Hochberg (B-H) 校正来调整 P
值，并计算每个校正方法下的 FWER、FDR 和 TPR。</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a><span class="co"># Bonferroni 校正</span></span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a>bonferroni_adjust <span class="ot">&lt;-</span> <span class="cf">function</span>(pvals) {</span>
<span id="cb79-3"><a href="#cb79-3" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">p.adjust</span>(pvals, <span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>))</span>
<span id="cb79-4"><a href="#cb79-4" tabindex="-1"></a>}</span>
<span id="cb79-5"><a href="#cb79-5" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" tabindex="-1"></a><span class="co"># B-H 校正</span></span>
<span id="cb79-7"><a href="#cb79-7" tabindex="-1"></a>bh_adjust <span class="ot">&lt;-</span> <span class="cf">function</span>(pvals) {</span>
<span id="cb79-8"><a href="#cb79-8" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">p.adjust</span>(pvals, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>))</span>
<span id="cb79-9"><a href="#cb79-9" tabindex="-1"></a>}</span>
<span id="cb79-10"><a href="#cb79-10" tabindex="-1"></a></span>
<span id="cb79-11"><a href="#cb79-11" tabindex="-1"></a><span class="co"># 计算 FWER, FDR, 和 TPR</span></span>
<span id="cb79-12"><a href="#cb79-12" tabindex="-1"></a>calculate_metrics <span class="ot">&lt;-</span> <span class="cf">function</span>(adjusted_pvals, true_alt_indices, alpha) {</span>
<span id="cb79-13"><a href="#cb79-13" tabindex="-1"></a>  <span class="co"># 检测为显著的假设</span></span>
<span id="cb79-14"><a href="#cb79-14" tabindex="-1"></a>  discoveries <span class="ot">&lt;-</span> <span class="fu">which</span>(adjusted_pvals <span class="sc">&lt;</span> alpha)</span>
<span id="cb79-15"><a href="#cb79-15" tabindex="-1"></a>  </span>
<span id="cb79-16"><a href="#cb79-16" tabindex="-1"></a>  <span class="co"># 计算 FWER (至少一个假阳性的概率)</span></span>
<span id="cb79-17"><a href="#cb79-17" tabindex="-1"></a>  fwer <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(<span class="fu">any</span>(discoveries <span class="sc">&lt;=</span> null_count), <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb79-18"><a href="#cb79-18" tabindex="-1"></a>  </span>
<span id="cb79-19"><a href="#cb79-19" tabindex="-1"></a>  <span class="co"># 计算 FDR (假阳性率)</span></span>
<span id="cb79-20"><a href="#cb79-20" tabindex="-1"></a>  false_discoveries <span class="ot">&lt;-</span> <span class="fu">sum</span>(discoveries <span class="sc">&lt;=</span> null_count)</span>
<span id="cb79-21"><a href="#cb79-21" tabindex="-1"></a>  total_discoveries <span class="ot">&lt;-</span> <span class="fu">length</span>(discoveries)</span>
<span id="cb79-22"><a href="#cb79-22" tabindex="-1"></a>  fdr <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(total_discoveries <span class="sc">&gt;</span> <span class="dv">0</span>, false_discoveries <span class="sc">/</span> total_discoveries, <span class="dv">0</span>)</span>
<span id="cb79-23"><a href="#cb79-23" tabindex="-1"></a>  </span>
<span id="cb79-24"><a href="#cb79-24" tabindex="-1"></a>  <span class="co"># 计算 TPR (真正率)</span></span>
<span id="cb79-25"><a href="#cb79-25" tabindex="-1"></a>  true_discoveries <span class="ot">&lt;-</span> <span class="fu">sum</span>(discoveries <span class="sc">&gt;</span> null_count)</span>
<span id="cb79-26"><a href="#cb79-26" tabindex="-1"></a>  tpr <span class="ot">&lt;-</span> true_discoveries <span class="sc">/</span> alt_count</span>
<span id="cb79-27"><a href="#cb79-27" tabindex="-1"></a>  </span>
<span id="cb79-28"><a href="#cb79-28" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(fwer, fdr, tpr))</span>
<span id="cb79-29"><a href="#cb79-29" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="模拟实验" class="section level2">
<h2>模拟实验</h2>
<p>我们进行 <span class="math inline">\(m = 10000\)</span>
次模拟实验，分别计算 Bonferroni 校正和 B-H 校正下的 FWER, FDR 和
TPR。</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a><span class="co"># 存储 Bonferroni 和 B-H 校正结果的矩阵</span></span>
<span id="cb80-2"><a href="#cb80-2" tabindex="-1"></a>bonferroni_results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> m, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb80-3"><a href="#cb80-3" tabindex="-1"></a>bh_results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> m, <span class="at">ncol =</span> <span class="dv">3</span>)</span>
<span id="cb80-4"><a href="#cb80-4" tabindex="-1"></a></span>
<span id="cb80-5"><a href="#cb80-5" tabindex="-1"></a><span class="co"># 进行模拟</span></span>
<span id="cb80-6"><a href="#cb80-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb80-7"><a href="#cb80-7" tabindex="-1"></a>  pvals <span class="ot">&lt;-</span> <span class="fu">generate_pvalues</span>()</span>
<span id="cb80-8"><a href="#cb80-8" tabindex="-1"></a>  </span>
<span id="cb80-9"><a href="#cb80-9" tabindex="-1"></a>  <span class="co"># Bonferroni 校正</span></span>
<span id="cb80-10"><a href="#cb80-10" tabindex="-1"></a>  bonf_pvals <span class="ot">&lt;-</span> <span class="fu">bonferroni_adjust</span>(pvals)</span>
<span id="cb80-11"><a href="#cb80-11" tabindex="-1"></a>  bonferroni_results[i, ] <span class="ot">&lt;-</span> <span class="fu">calculate_metrics</span>(bonf_pvals, null_count, alpha)</span>
<span id="cb80-12"><a href="#cb80-12" tabindex="-1"></a>  </span>
<span id="cb80-13"><a href="#cb80-13" tabindex="-1"></a>  <span class="co"># B-H 校正</span></span>
<span id="cb80-14"><a href="#cb80-14" tabindex="-1"></a>  bh_pvals <span class="ot">&lt;-</span> <span class="fu">bh_adjust</span>(pvals)</span>
<span id="cb80-15"><a href="#cb80-15" tabindex="-1"></a>  bh_results[i, ] <span class="ot">&lt;-</span> <span class="fu">calculate_metrics</span>(bh_pvals, null_count, alpha)</span>
<span id="cb80-16"><a href="#cb80-16" tabindex="-1"></a>}</span>
<span id="cb80-17"><a href="#cb80-17" tabindex="-1"></a></span>
<span id="cb80-18"><a href="#cb80-18" tabindex="-1"></a><span class="co"># 计算平均值作为最终结果</span></span>
<span id="cb80-19"><a href="#cb80-19" tabindex="-1"></a>results[<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;Bonferroni&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(bonferroni_results[, <span class="dv">1</span>])</span>
<span id="cb80-20"><a href="#cb80-20" tabindex="-1"></a>results[<span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;Bonferroni&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(bonferroni_results[, <span class="dv">2</span>])</span>
<span id="cb80-21"><a href="#cb80-21" tabindex="-1"></a>results[<span class="st">&quot;TPR&quot;</span>, <span class="st">&quot;Bonferroni&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(bonferroni_results[, <span class="dv">3</span>])</span>
<span id="cb80-22"><a href="#cb80-22" tabindex="-1"></a></span>
<span id="cb80-23"><a href="#cb80-23" tabindex="-1"></a>results[<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;B-H&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(bh_results[, <span class="dv">1</span>])</span>
<span id="cb80-24"><a href="#cb80-24" tabindex="-1"></a>results[<span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;B-H&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(bh_results[, <span class="dv">2</span>])</span>
<span id="cb80-25"><a href="#cb80-25" tabindex="-1"></a>results[<span class="st">&quot;TPR&quot;</span>, <span class="st">&quot;B-H&quot;</span>] <span class="ot">&lt;-</span> <span class="fu">mean</span>(bh_results[, <span class="dv">3</span>])</span>
<span id="cb80-26"><a href="#cb80-26" tabindex="-1"></a></span>
<span id="cb80-27"><a href="#cb80-27" tabindex="-1"></a><span class="co"># 输出结果表格</span></span>
<span id="cb80-28"><a href="#cb80-28" tabindex="-1"></a>results</span></code></pre></div>
<pre><code>##       Bonferroni        B-H
## FWER 0.087300000 0.93050000
## FDR  0.004510088 0.09502826
## TPR  0.396748000 0.56107200</code></pre>
</div>
<div id="结果评论" class="section level2">
<h2>结果评论</h2>
<p>从模拟结果来看，我们可以观察到 Bonferroni 校正和 B-H 校正在控制 FWER
和 FDR 方面的差异。</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a><span class="co"># 评论结果</span></span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Bonferroni 校正相对保守，因此它会较好地控制 FWER，但可能导致较低的 TPR，即真正发现的比例较低。&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Bonferroni 校正相对保守，因此它会较好地控制 FWER，但可能导致较低的 TPR，即真正发现的比例较低。&quot;</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;B-H 校正更倾向于控制 FDR，允许更多的假阳性，但可能提高 TPR。&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;B-H 校正更倾向于控制 FDR，允许更多的假阳性，但可能提高 TPR。&quot;</code></pre>
</div>
<div id="section-2" class="section level2">
<h2>7.4</h2>
<p>请参考 <strong>boot</strong> 包中提供的空调数据集
<strong>aircondit</strong>。这12个观测值表示空调设备故障之间的时间（单位为小时）[63,
示例 1.1]：</p>
<p>3, 5, 7, 18, 43, 85, 91, 98, 100, 130, 230, 487。</p>
<p>假设故障之间的时间服从指数模型 <strong>Exp(λ)</strong>。求出失效率
<strong>λ</strong>
的<strong>最大似然估计（MLE）</strong>，并使用自助法（bootstrap）估计该估计值的偏差和标准误。</p>
</div>
<div id="数据" class="section level2">
<h2>1. 数据</h2>
<p>以下是代表空调设备故障时间（单位为小时）的 12 个观测值。</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a><span class="co"># 空调设备故障时间数据（单位：小时）</span></span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a>failure_times <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb86-3"><a href="#cb86-3" tabindex="-1"></a>failure_times</span></code></pre></div>
<pre><code>##  [1]   3   5   7  18  43  85  91  98 100 130 230 487</code></pre>
</div>
<div id="失效率-lambda-的最大似然估计" class="section level2">
<h2>2. 失效率 <span class="math inline">\(\lambda\)</span>
的最大似然估计</h2>
<p>假设数据遵循指数分布 <span class="math inline">\(\text{Exp}(\lambda)\)</span>，则失效率 <span class="math inline">\(\lambda\)</span> 的最大似然估计为：</p>
<p><span class="math display">\[
\hat{\lambda} = \frac{1}{\bar{x}}
\]</span></p>
<p>其中，<span class="math inline">\(\bar{x}\)</span>
为观测数据的均值。</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a><span class="co"># 计算 lambda 的最大似然估计</span></span>
<span id="cb88-2"><a href="#cb88-2" tabindex="-1"></a>lambda_mle <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(failure_times)</span>
<span id="cb88-3"><a href="#cb88-3" tabindex="-1"></a>lambda_mle</span></code></pre></div>
<pre><code>## [1] 0.00925212</code></pre>
</div>
<div id="自助法bootstrap" class="section level2">
<h2>3. 自助法（Bootstrap）</h2>
<p>自助法用于估计 <span class="math inline">\(\lambda\)</span>
的偏差和标准误。每次重采样时重新计算 <span class="math inline">\(\lambda\)</span> 的最大似然估计。</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a><span class="co"># 加载必要的包</span></span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a><span class="fu">library</span>(boot)</span></code></pre></div>
<pre><code>## Warning: package &#39;boot&#39; was built under R version 4.4.2</code></pre>
<pre><code>## 
## Attaching package: &#39;boot&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:survival&#39;:
## 
##     aml</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a><span class="co"># 定义用于 bootstrap 的统计函数</span></span>
<span id="cb94-2"><a href="#cb94-2" tabindex="-1"></a>mle_stat <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb94-3"><a href="#cb94-3" tabindex="-1"></a>  resample_data <span class="ot">&lt;-</span> data[indices]</span>
<span id="cb94-4"><a href="#cb94-4" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(resample_data)</span>
<span id="cb94-5"><a href="#cb94-5" tabindex="-1"></a>}</span>
<span id="cb94-6"><a href="#cb94-6" tabindex="-1"></a></span>
<span id="cb94-7"><a href="#cb94-7" tabindex="-1"></a><span class="co"># 使用 1000 次重采样进行自助法</span></span>
<span id="cb94-8"><a href="#cb94-8" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb94-9"><a href="#cb94-9" tabindex="-1"></a>bootstrap_results <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> failure_times, <span class="at">statistic =</span> mle_stat, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb94-10"><a href="#cb94-10" tabindex="-1"></a></span>
<span id="cb94-11"><a href="#cb94-11" tabindex="-1"></a><span class="co"># 显示自助法结果</span></span>
<span id="cb94-12"><a href="#cb94-12" tabindex="-1"></a>bootstrap_results</span></code></pre></div>
<pre><code>## 
## ORDINARY NONPARAMETRIC BOOTSTRAP
## 
## 
## Call:
## boot(data = failure_times, statistic = mle_stat, R = 1000)
## 
## 
## Bootstrap Statistics :
##       original     bias    std. error
## t1* 0.00925212 0.00151119 0.004217765</code></pre>
</div>
<div id="偏差和标准误" class="section level2">
<h2>4. 偏差和标准误</h2>
<p>通过 <code>boot</code> 函数的结果，我们可以提取 <span class="math inline">\(\lambda\)</span> 的偏差和标准误。</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a><span class="co"># 计算自助法得到的偏差和标准误</span></span>
<span id="cb96-2"><a href="#cb96-2" tabindex="-1"></a>bias <span class="ot">&lt;-</span> <span class="fu">mean</span>(bootstrap_results<span class="sc">$</span>t) <span class="sc">-</span> lambda_mle</span>
<span id="cb96-3"><a href="#cb96-3" tabindex="-1"></a>standard_error <span class="ot">&lt;-</span> <span class="fu">sd</span>(bootstrap_results<span class="sc">$</span>t)</span>
<span id="cb96-4"><a href="#cb96-4" tabindex="-1"></a></span>
<span id="cb96-5"><a href="#cb96-5" tabindex="-1"></a>bias</span></code></pre></div>
<pre><code>## [1] 0.00151119</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a>standard_error</span></code></pre></div>
<pre><code>## [1] 0.004217765</code></pre>
</div>
<div id="结论-2" class="section level2">
<h2>5. 结论</h2>
<p>失效率 <span class="math inline">\(\lambda\)</span> 的最大似然估计为
0.0092521。使用自助法估计的偏差为 0.0015112，标准误为 0.0042178。</p>
<div id="解释" class="section level3">
<h3>解释：</h3>
<ol style="list-style-type: decimal">
<li><strong>数据部分</strong>：定义并展示了空调设备故障时间数据。</li>
<li><strong>最大似然估计（MLE）</strong>：根据公式 <span class="math inline">\(\hat{\lambda} =
\frac{1}{\bar{x}}\)</span>，计算失效率 <span class="math inline">\(\lambda\)</span> 的最大似然估计。</li>
<li><strong>自助法（Bootstrap）</strong>：使用 <code>boot</code>
包对数据进行1000次自助法重采样，计算每次重采样中的 <span class="math inline">\(\lambda\)</span> 值。</li>
<li><strong>偏差与标准误</strong>：通过自助法的结果，计算出估计值的偏差和标准误。</li>
</ol>
</div>
</div>
<div id="section-3" class="section level2">
<h2>7.5</h2>
<p>参考练习7.4。通过标准正态法、基本法、百分位法和BCa（偏差校正加速）法计算故障间隔时间
<span class="math inline">\(1/\lambda\)</span>
的95%自助法置信区间。比较这些区间，并解释它们可能为什么会有所不同。</p>
</div>
<div id="数据-1" class="section level2">
<h2>1. 数据</h2>
<p>以下是代表空调设备故障时间（单位为小时）的 12 个观测值。</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a><span class="co"># 空调设备故障时间数据（单位：小时）</span></span>
<span id="cb100-2"><a href="#cb100-2" tabindex="-1"></a>failure_times <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb100-3"><a href="#cb100-3" tabindex="-1"></a>failure_times</span></code></pre></div>
<pre><code>##  [1]   3   5   7  18  43  85  91  98 100 130 230 487</code></pre>
</div>
<div id="计算-1lambda-的最大似然估计" class="section level2">
<h2>2. 计算 <span class="math inline">\(1/\lambda\)</span>
的最大似然估计</h2>
<p>根据题目 7.4，最大似然估计 <span class="math inline">\(\hat{\lambda}\)</span> 可以通过下式得到：</p>
<p><span class="math display">\[
\hat{\lambda} = \frac{1}{\bar{x}}
\]</span></p>
<p>那么，故障间隔时间 <span class="math inline">\(1/\lambda\)</span>
的估计值为 <span class="math inline">\(\bar{x}\)</span>，即观测数据的均值。</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a><span class="co"># 计算平均故障间隔时间（即 1/lambda 的估计值）</span></span>
<span id="cb102-2"><a href="#cb102-2" tabindex="-1"></a>mean_time <span class="ot">&lt;-</span> <span class="fu">mean</span>(failure_times)</span>
<span id="cb102-3"><a href="#cb102-3" tabindex="-1"></a>mean_time</span></code></pre></div>
<pre><code>## [1] 108.0833</code></pre>
</div>
<div id="自助法置信区间" class="section level2">
<h2>3. 自助法置信区间</h2>
<p>通过 <code>boot</code>
包对数据进行自助法，并使用标准正态法、基本法、百分位法和 BCa
法计算置信区间。</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a><span class="co"># 加载必要的包</span></span>
<span id="cb104-2"><a href="#cb104-2" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb104-3"><a href="#cb104-3" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" tabindex="-1"></a><span class="co"># 定义统计函数，返回 1/lambda</span></span>
<span id="cb104-5"><a href="#cb104-5" tabindex="-1"></a>mean_time_stat <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb104-6"><a href="#cb104-6" tabindex="-1"></a>  resample_data <span class="ot">&lt;-</span> data[indices]</span>
<span id="cb104-7"><a href="#cb104-7" tabindex="-1"></a>  <span class="fu">mean</span>(resample_data)</span>
<span id="cb104-8"><a href="#cb104-8" tabindex="-1"></a>}</span>
<span id="cb104-9"><a href="#cb104-9" tabindex="-1"></a></span>
<span id="cb104-10"><a href="#cb104-10" tabindex="-1"></a><span class="co"># 使用 1000 次重采样进行自助法</span></span>
<span id="cb104-11"><a href="#cb104-11" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb104-12"><a href="#cb104-12" tabindex="-1"></a>bootstrap_results <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> failure_times, <span class="at">statistic =</span> mean_time_stat, <span class="at">R =</span> <span class="dv">1000</span>)</span>
<span id="cb104-13"><a href="#cb104-13" tabindex="-1"></a></span>
<span id="cb104-14"><a href="#cb104-14" tabindex="-1"></a><span class="co"># 计算标准正态、基本、百分位和 BCa 置信区间</span></span>
<span id="cb104-15"><a href="#cb104-15" tabindex="-1"></a>ci_norm <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(bootstrap_results, <span class="at">type =</span> <span class="st">&quot;norm&quot;</span>)</span>
<span id="cb104-16"><a href="#cb104-16" tabindex="-1"></a>ci_basic <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(bootstrap_results, <span class="at">type =</span> <span class="st">&quot;basic&quot;</span>)</span>
<span id="cb104-17"><a href="#cb104-17" tabindex="-1"></a>ci_perc <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(bootstrap_results, <span class="at">type =</span> <span class="st">&quot;perc&quot;</span>)</span>
<span id="cb104-18"><a href="#cb104-18" tabindex="-1"></a>ci_bca <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(bootstrap_results, <span class="at">type =</span> <span class="st">&quot;bca&quot;</span>)</span>
<span id="cb104-19"><a href="#cb104-19" tabindex="-1"></a></span>
<span id="cb104-20"><a href="#cb104-20" tabindex="-1"></a><span class="co"># 展示置信区间</span></span>
<span id="cb104-21"><a href="#cb104-21" tabindex="-1"></a>ci_norm</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = bootstrap_results, type = &quot;norm&quot;)
## 
## Intervals : 
## Level      Normal        
## 95%   ( 37.9, 182.5 )  
## Calculations and Intervals on Original Scale</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a>ci_basic</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = bootstrap_results, type = &quot;basic&quot;)
## 
## Intervals : 
## Level      Basic         
## 95%   ( 32.7, 168.2 )  
## Calculations and Intervals on Original Scale</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a>ci_perc</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = bootstrap_results, type = &quot;perc&quot;)
## 
## Intervals : 
## Level     Percentile     
## 95%   ( 47.9, 183.5 )  
## Calculations and Intervals on Original Scale</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a>ci_bca</span></code></pre></div>
<pre><code>## BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
## Based on 1000 bootstrap replicates
## 
## CALL : 
## boot.ci(boot.out = bootstrap_results, type = &quot;bca&quot;)
## 
## Intervals : 
## Level       BCa          
## 95%   ( 57.4, 217.6 )  
## Calculations and Intervals on Original Scale
## Some BCa intervals may be unstable</code></pre>
</div>
<div id="比较置信区间" class="section level2">
<h2>4. 比较置信区间</h2>
<p>让我们将所有四种方法得到的 95% 置信区间进行比较。</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a><span class="co"># 将置信区间结果提取出来并汇总</span></span>
<span id="cb112-2"><a href="#cb112-2" tabindex="-1"></a>ci_summary <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb112-3"><a href="#cb112-3" tabindex="-1"></a>  <span class="at">Method =</span> <span class="fu">c</span>(<span class="st">&quot;Standard Normal&quot;</span>, <span class="st">&quot;Basic&quot;</span>, <span class="st">&quot;Percentile&quot;</span>, <span class="st">&quot;BCa&quot;</span>),</span>
<span id="cb112-4"><a href="#cb112-4" tabindex="-1"></a>  <span class="at">Lower =</span> <span class="fu">c</span>(ci_norm<span class="sc">$</span>normal[<span class="dv">2</span>], ci_basic<span class="sc">$</span>basic[<span class="dv">4</span>], ci_perc<span class="sc">$</span>perc[<span class="dv">4</span>], ci_bca<span class="sc">$</span>bca[<span class="dv">4</span>]),</span>
<span id="cb112-5"><a href="#cb112-5" tabindex="-1"></a>  <span class="at">Upper =</span> <span class="fu">c</span>(ci_norm<span class="sc">$</span>normal[<span class="dv">3</span>], ci_basic<span class="sc">$</span>basic[<span class="dv">5</span>], ci_perc<span class="sc">$</span>perc[<span class="dv">5</span>], ci_bca<span class="sc">$</span>bca[<span class="dv">5</span>])</span>
<span id="cb112-6"><a href="#cb112-6" tabindex="-1"></a>)</span>
<span id="cb112-7"><a href="#cb112-7" tabindex="-1"></a></span>
<span id="cb112-8"><a href="#cb112-8" tabindex="-1"></a>ci_summary</span></code></pre></div>
<pre><code>##            Method    Lower    Upper
## 1 Standard Normal 37.89861 182.5276
## 2           Basic 32.68360 168.2415
## 3      Percentile 47.92514 183.4831
## 4             BCa 57.36206 217.5713</code></pre>
</div>
<div id="解释置信区间的差异" class="section level2">
<h2>5. 解释置信区间的差异</h2>
<p>置信区间之间的差异主要来自不同的方法假设和对偏差的校正：</p>
<ul>
<li><strong>标准正态法</strong>：假设统计量是正态分布的，并使用标准误差来计算区间。这种方法在样本量较小或者数据偏斜时，可能不如其他方法准确。</li>
<li><strong>基本法</strong>：通过观察原始估计与重采样估计之间的偏差，调整置信区间。它考虑了偏差，但不像
BCa 法那样全面。</li>
<li><strong>百分位法</strong>：直接使用重采样分布的百分位数来计算置信区间。该方法简单直观，但可能忽略偏差校正。</li>
<li><strong>BCa
法</strong>：对偏差和加速效应进行校正，通常在样本量较小或数据偏斜时表现更好。</li>
</ul>
<p>在样本量较小时，BCa
法通常是最稳健的，因为它对数据的偏差和加速效应进行了额外调整，而标准正态法则最简单，但在数据不正态时可能不可靠。</p>
<div id="解释-1" class="section level3">
<h3>解释：</h3>
<ol style="list-style-type: decimal">
<li><strong>数据部分</strong>：提供故障时间的数据。</li>
<li><strong>最大似然估计</strong>：根据题目 7.4，计算故障间隔时间 <span class="math inline">\(1/\lambda\)</span> 的最大似然估计。</li>
<li><strong>自助法置信区间</strong>：使用 <code>boot</code>
包进行自助法抽样，并计算四种不同方法的 95% 置信区间。</li>
<li><strong>比较置信区间</strong>：将四种方法的置信区间进行比较并展示。</li>
<li><strong>解释差异</strong>：解释每种方法产生不同置信区间的原因。</li>
</ol>
</div>
</div>
<div id="answer-5" class="section level2">
<h2>Answer 5</h2>
</div>
<div id="获取-hattheta-的偏差和标准误差的jackknife估计" class="section level2">
<h2>7.8 获取 <span class="math inline">\(\hat{\theta}\)</span>
的偏差和标准误差的jackknife估计</h2>
<div id="数据准备" class="section level3">
<h3>数据准备</h3>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;bootstrap&quot;</span>)</span></code></pre></div>
</div>
<div id="r代码实现-1" class="section level3">
<h3>R代码实现</h3>
<div id="step-1-计算-hattheta" class="section level4">
<h4>Step 1: 计算 <span class="math inline">\(\hat{\theta}\)</span></h4>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" tabindex="-1"></a><span class="co"># 计算协方差矩阵</span></span>
<span id="cb115-2"><a href="#cb115-2" tabindex="-1"></a>cov_matrix <span class="ot">&lt;-</span> <span class="fu">cov</span>(scor)</span>
<span id="cb115-3"><a href="#cb115-3" tabindex="-1"></a></span>
<span id="cb115-4"><a href="#cb115-4" tabindex="-1"></a><span class="co"># 计算协方差矩阵的特征值</span></span>
<span id="cb115-5"><a href="#cb115-5" tabindex="-1"></a>eigenvalues <span class="ot">&lt;-</span> <span class="fu">eigen</span>(cov_matrix)<span class="sc">$</span>values</span>
<span id="cb115-6"><a href="#cb115-6" tabindex="-1"></a></span>
<span id="cb115-7"><a href="#cb115-7" tabindex="-1"></a><span class="co"># 计算 \hat{\theta} 的估计值</span></span>
<span id="cb115-8"><a href="#cb115-8" tabindex="-1"></a>theta_hat <span class="ot">&lt;-</span> eigenvalues[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(eigenvalues)</span>
<span id="cb115-9"><a href="#cb115-9" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Theta 的估计值:&quot;</span>, theta_hat))</span></code></pre></div>
<pre><code>## [1] &quot;Theta 的估计值: 0.619115038421291&quot;</code></pre>
</div>
<div id="step-2-使用自助法估计-hattheta-的偏差和标准误差" class="section level4">
<h4>Step 2: 使用自助法估计 <span class="math inline">\(\hat{\theta}\)</span> 的偏差和标准误差</h4>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" tabindex="-1"></a><span class="co"># 设置自助法重复次数</span></span>
<span id="cb117-2"><a href="#cb117-2" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb117-3"><a href="#cb117-3" tabindex="-1"></a>theta_bootstrap <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb117-4"><a href="#cb117-4" tabindex="-1"></a></span>
<span id="cb117-5"><a href="#cb117-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># 设置随机种子以确保可重复性</span></span>
<span id="cb117-6"><a href="#cb117-6" tabindex="-1"></a></span>
<span id="cb117-7"><a href="#cb117-7" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb117-8"><a href="#cb117-8" tabindex="-1"></a>  <span class="co"># 自助法抽样</span></span>
<span id="cb117-9"><a href="#cb117-9" tabindex="-1"></a>  bootstrap_sample <span class="ot">&lt;-</span> scor[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(scor), <span class="at">replace =</span> <span class="cn">TRUE</span>), ]</span>
<span id="cb117-10"><a href="#cb117-10" tabindex="-1"></a>  </span>
<span id="cb117-11"><a href="#cb117-11" tabindex="-1"></a>  <span class="co"># 计算自助样本的协方差矩阵</span></span>
<span id="cb117-12"><a href="#cb117-12" tabindex="-1"></a>  bootstrap_cov <span class="ot">&lt;-</span> <span class="fu">cov</span>(bootstrap_sample)</span>
<span id="cb117-13"><a href="#cb117-13" tabindex="-1"></a>  </span>
<span id="cb117-14"><a href="#cb117-14" tabindex="-1"></a>  <span class="co"># 计算特征值</span></span>
<span id="cb117-15"><a href="#cb117-15" tabindex="-1"></a>  bootstrap_eigenvalues <span class="ot">&lt;-</span> <span class="fu">eigen</span>(bootstrap_cov)<span class="sc">$</span>values</span>
<span id="cb117-16"><a href="#cb117-16" tabindex="-1"></a>  </span>
<span id="cb117-17"><a href="#cb117-17" tabindex="-1"></a>  <span class="co"># 计算 \hat{\theta} 值</span></span>
<span id="cb117-18"><a href="#cb117-18" tabindex="-1"></a>  theta_bootstrap[i] <span class="ot">&lt;-</span> bootstrap_eigenvalues[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(bootstrap_eigenvalues)</span>
<span id="cb117-19"><a href="#cb117-19" tabindex="-1"></a>}</span>
<span id="cb117-20"><a href="#cb117-20" tabindex="-1"></a></span>
<span id="cb117-21"><a href="#cb117-21" tabindex="-1"></a><span class="co"># 计算偏差和标准误差</span></span>
<span id="cb117-22"><a href="#cb117-22" tabindex="-1"></a>bootstrap_bias <span class="ot">&lt;-</span> <span class="fu">mean</span>(theta_bootstrap) <span class="sc">-</span> theta_hat</span>
<span id="cb117-23"><a href="#cb117-23" tabindex="-1"></a>bootstrap_se <span class="ot">&lt;-</span> <span class="fu">sd</span>(theta_bootstrap)</span>
<span id="cb117-24"><a href="#cb117-24" tabindex="-1"></a></span>
<span id="cb117-25"><a href="#cb117-25" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;自助法估计的偏差:&quot;</span>, bootstrap_bias))</span></code></pre></div>
<pre><code>## [1] &quot;自助法估计的偏差: 0.00258992764992461&quot;</code></pre>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;自助法估计的标准误差:&quot;</span>, bootstrap_se))</span></code></pre></div>
<pre><code>## [1] &quot;自助法估计的标准误差: 0.0469619780101942&quot;</code></pre>
</div>
<div id="step-3-使用-jackknife-方法估计-hattheta-的偏差和标准误差" class="section level4">
<h4>Step 3: 使用 Jackknife 方法估计 <span class="math inline">\(\hat{\theta}\)</span> 的偏差和标准误差</h4>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a><span class="co"># 初始化Jackknife估计</span></span>
<span id="cb121-2"><a href="#cb121-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(scor)</span>
<span id="cb121-3"><a href="#cb121-3" tabindex="-1"></a>theta_jackknife <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb121-4"><a href="#cb121-4" tabindex="-1"></a></span>
<span id="cb121-5"><a href="#cb121-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb121-6"><a href="#cb121-6" tabindex="-1"></a>  <span class="co"># 留出第 i 个样本</span></span>
<span id="cb121-7"><a href="#cb121-7" tabindex="-1"></a>  jackknife_sample <span class="ot">&lt;-</span> scor[<span class="sc">-</span>i, ]</span>
<span id="cb121-8"><a href="#cb121-8" tabindex="-1"></a>  </span>
<span id="cb121-9"><a href="#cb121-9" tabindex="-1"></a>  <span class="co"># 计算留一法样本的协方差矩阵</span></span>
<span id="cb121-10"><a href="#cb121-10" tabindex="-1"></a>  jackknife_cov <span class="ot">&lt;-</span> <span class="fu">cov</span>(jackknife_sample)</span>
<span id="cb121-11"><a href="#cb121-11" tabindex="-1"></a>  </span>
<span id="cb121-12"><a href="#cb121-12" tabindex="-1"></a>  <span class="co"># 计算特征值</span></span>
<span id="cb121-13"><a href="#cb121-13" tabindex="-1"></a>  jackknife_eigenvalues <span class="ot">&lt;-</span> <span class="fu">eigen</span>(jackknife_cov)<span class="sc">$</span>values</span>
<span id="cb121-14"><a href="#cb121-14" tabindex="-1"></a>  </span>
<span id="cb121-15"><a href="#cb121-15" tabindex="-1"></a>  <span class="co"># 计算 \hat{\theta} 值</span></span>
<span id="cb121-16"><a href="#cb121-16" tabindex="-1"></a>  theta_jackknife[i] <span class="ot">&lt;-</span> jackknife_eigenvalues[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(jackknife_eigenvalues)</span>
<span id="cb121-17"><a href="#cb121-17" tabindex="-1"></a>}</span>
<span id="cb121-18"><a href="#cb121-18" tabindex="-1"></a></span>
<span id="cb121-19"><a href="#cb121-19" tabindex="-1"></a><span class="co"># 计算偏差和标准误差</span></span>
<span id="cb121-20"><a href="#cb121-20" tabindex="-1"></a>jackknife_bias <span class="ot">&lt;-</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">mean</span>(theta_jackknife) <span class="sc">-</span> theta_hat)</span>
<span id="cb121-21"><a href="#cb121-21" tabindex="-1"></a>jackknife_se <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> <span class="fu">mean</span>((theta_jackknife <span class="sc">-</span> <span class="fu">mean</span>(theta_jackknife))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb121-22"><a href="#cb121-22" tabindex="-1"></a></span>
<span id="cb121-23"><a href="#cb121-23" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Jackknife法估计的偏差:&quot;</span>, jackknife_bias))</span></code></pre></div>
<pre><code>## [1] &quot;Jackknife法估计的偏差: 0.00106913888654214&quot;</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Jackknife法估计的标准误差:&quot;</span>, jackknife_se))</span></code></pre></div>
<pre><code>## [1] &quot;Jackknife法估计的标准误差: 0.0495523072701252&quot;</code></pre>
</div>
</div>
</div>
<div id="在示例-7.18-中使用了留一法n-折交叉验证来选择最佳拟合模型重复此分析将对数-对数模型替换为三次多项式模型通过交叉验证程序选择了哪一个模型根据最大调整-r2-选择了哪一个模型" class="section level2">
<h2>7.10 在示例 7.18 中，使用了留一法（n
折）交叉验证来选择最佳拟合模型。重复此分析，将对数-对数模型替换为三次多项式模型。通过交叉验证程序选择了哪一个模型？根据最大调整
<span class="math inline">\(R^2\)</span> 选择了哪一个模型？</h2>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" tabindex="-1"></a><span class="co"># 加载必要的包</span></span>
<span id="cb125-2"><a href="#cb125-2" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span></code></pre></div>
<pre><code>## Warning: package &#39;DAAG&#39; was built under R version 4.4.2</code></pre>
<pre><code>## 
## Attaching package: &#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:survival&#39;:
## 
##     lung</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a><span class="co"># 清除环境中的变量</span></span>
<span id="cb130-2"><a href="#cb130-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb130-3"><a href="#cb130-3" tabindex="-1"></a></span>
<span id="cb130-4"><a href="#cb130-4" tabindex="-1"></a><span class="co"># 加载 ironslag 数据集</span></span>
<span id="cb130-5"><a href="#cb130-5" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;ironslag&quot;</span>, <span class="at">package =</span> <span class="st">&quot;DAAG&quot;</span>)</span>
<span id="cb130-6"><a href="#cb130-6" tabindex="-1"></a>magnetic <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>magnetic</span>
<span id="cb130-7"><a href="#cb130-7" tabindex="-1"></a>chemical <span class="ot">&lt;-</span> ironslag<span class="sc">$</span>chemical</span>
<span id="cb130-8"><a href="#cb130-8" tabindex="-1"></a></span>
<span id="cb130-9"><a href="#cb130-9" tabindex="-1"></a><span class="co"># 定义计算模型的预测误差的函数</span></span>
<span id="cb130-10"><a href="#cb130-10" tabindex="-1"></a>cross_validation <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb130-11"><a href="#cb130-11" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb130-12"><a href="#cb130-12" tabindex="-1"></a>  errors <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> n, <span class="at">ncol =</span> <span class="dv">4</span>)</span>
<span id="cb130-13"><a href="#cb130-13" tabindex="-1"></a>  </span>
<span id="cb130-14"><a href="#cb130-14" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb130-15"><a href="#cb130-15" tabindex="-1"></a>    <span class="co"># 留一法样本</span></span>
<span id="cb130-16"><a href="#cb130-16" tabindex="-1"></a>    y_train <span class="ot">&lt;-</span> y[<span class="sc">-</span>k]</span>
<span id="cb130-17"><a href="#cb130-17" tabindex="-1"></a>    x_train <span class="ot">&lt;-</span> x[<span class="sc">-</span>k]</span>
<span id="cb130-18"><a href="#cb130-18" tabindex="-1"></a>    </span>
<span id="cb130-19"><a href="#cb130-19" tabindex="-1"></a>    <span class="co"># 模型1：线性模型</span></span>
<span id="cb130-20"><a href="#cb130-20" tabindex="-1"></a>    model1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y_train <span class="sc">~</span> x_train)</span>
<span id="cb130-21"><a href="#cb130-21" tabindex="-1"></a>    yhat1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model1, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x_train =</span> x[k]))</span>
<span id="cb130-22"><a href="#cb130-22" tabindex="-1"></a>    errors[k, <span class="dv">1</span>] <span class="ot">&lt;-</span> (y[k] <span class="sc">-</span> yhat1)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb130-23"><a href="#cb130-23" tabindex="-1"></a>    </span>
<span id="cb130-24"><a href="#cb130-24" tabindex="-1"></a>    <span class="co"># 模型2：二次多项式模型</span></span>
<span id="cb130-25"><a href="#cb130-25" tabindex="-1"></a>    model2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y_train <span class="sc">~</span> x_train <span class="sc">+</span> <span class="fu">I</span>(x_train<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb130-26"><a href="#cb130-26" tabindex="-1"></a>    yhat2 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model2, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x_train =</span> x[k]))</span>
<span id="cb130-27"><a href="#cb130-27" tabindex="-1"></a>    errors[k, <span class="dv">2</span>] <span class="ot">&lt;-</span> (y[k] <span class="sc">-</span> yhat2)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb130-28"><a href="#cb130-28" tabindex="-1"></a>    </span>
<span id="cb130-29"><a href="#cb130-29" tabindex="-1"></a>    <span class="co"># 模型3：三次多项式模型</span></span>
<span id="cb130-30"><a href="#cb130-30" tabindex="-1"></a>    model3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y_train <span class="sc">~</span> x_train <span class="sc">+</span> <span class="fu">I</span>(x_train<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x_train<span class="sc">^</span><span class="dv">3</span>))</span>
<span id="cb130-31"><a href="#cb130-31" tabindex="-1"></a>    yhat3 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model3, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x_train =</span> x[k]))</span>
<span id="cb130-32"><a href="#cb130-32" tabindex="-1"></a>    errors[k, <span class="dv">3</span>] <span class="ot">&lt;-</span> (y[k] <span class="sc">-</span> yhat3)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb130-33"><a href="#cb130-33" tabindex="-1"></a>    </span>
<span id="cb130-34"><a href="#cb130-34" tabindex="-1"></a>    <span class="co"># 模型4：对数-对数模型</span></span>
<span id="cb130-35"><a href="#cb130-35" tabindex="-1"></a>    model4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y_train) <span class="sc">~</span> <span class="fu">log</span>(x_train))</span>
<span id="cb130-36"><a href="#cb130-36" tabindex="-1"></a>    logyhat4 <span class="ot">&lt;-</span> <span class="fu">predict</span>(model4, <span class="at">newdata =</span> <span class="fu">data.frame</span>(<span class="at">x_train =</span> x[k]), <span class="at">type =</span> <span class="st">&quot;response&quot;</span>)</span>
<span id="cb130-37"><a href="#cb130-37" tabindex="-1"></a>    yhat4 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat4)</span>
<span id="cb130-38"><a href="#cb130-38" tabindex="-1"></a>    errors[k, <span class="dv">4</span>] <span class="ot">&lt;-</span> (y[k] <span class="sc">-</span> yhat4)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb130-39"><a href="#cb130-39" tabindex="-1"></a>  }</span>
<span id="cb130-40"><a href="#cb130-40" tabindex="-1"></a>  </span>
<span id="cb130-41"><a href="#cb130-41" tabindex="-1"></a>  <span class="co"># 计算每个模型的均方误差</span></span>
<span id="cb130-42"><a href="#cb130-42" tabindex="-1"></a>  mse <span class="ot">&lt;-</span> <span class="fu">colMeans</span>(errors)</span>
<span id="cb130-43"><a href="#cb130-43" tabindex="-1"></a>  <span class="fu">names</span>(mse) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Linear&quot;</span>, <span class="st">&quot;Quadratic&quot;</span>, <span class="st">&quot;Cubic&quot;</span>, <span class="st">&quot;Log-Log&quot;</span>)</span>
<span id="cb130-44"><a href="#cb130-44" tabindex="-1"></a>  <span class="fu">return</span>(mse)</span>
<span id="cb130-45"><a href="#cb130-45" tabindex="-1"></a>}</span>
<span id="cb130-46"><a href="#cb130-46" tabindex="-1"></a></span>
<span id="cb130-47"><a href="#cb130-47" tabindex="-1"></a><span class="co"># 定义计算调整后 R^2 的函数</span></span>
<span id="cb130-48"><a href="#cb130-48" tabindex="-1"></a>adjusted_r_squared <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb130-49"><a href="#cb130-49" tabindex="-1"></a>  models <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb130-50"><a href="#cb130-50" tabindex="-1"></a>    <span class="fu">lm</span>(y <span class="sc">~</span> x),</span>
<span id="cb130-51"><a href="#cb130-51" tabindex="-1"></a>    <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>)),</span>
<span id="cb130-52"><a href="#cb130-52" tabindex="-1"></a>    <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">3</span>)),</span>
<span id="cb130-53"><a href="#cb130-53" tabindex="-1"></a>    <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> <span class="fu">log</span>(x))</span>
<span id="cb130-54"><a href="#cb130-54" tabindex="-1"></a>  )</span>
<span id="cb130-55"><a href="#cb130-55" tabindex="-1"></a>  adj_r2 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(models, <span class="cf">function</span>(model) <span class="fu">summary</span>(model)<span class="sc">$</span>adj.r.squared)</span>
<span id="cb130-56"><a href="#cb130-56" tabindex="-1"></a>  <span class="fu">names</span>(adj_r2) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Linear&quot;</span>, <span class="st">&quot;Quadratic&quot;</span>, <span class="st">&quot;Cubic&quot;</span>, <span class="st">&quot;Log-Log&quot;</span>)</span>
<span id="cb130-57"><a href="#cb130-57" tabindex="-1"></a>  <span class="fu">return</span>(adj_r2)</span>
<span id="cb130-58"><a href="#cb130-58" tabindex="-1"></a>}</span>
<span id="cb130-59"><a href="#cb130-59" tabindex="-1"></a></span>
<span id="cb130-60"><a href="#cb130-60" tabindex="-1"></a><span class="co"># 运行交叉验证和计算调整后 R^2</span></span>
<span id="cb130-61"><a href="#cb130-61" tabindex="-1"></a>mse_results <span class="ot">&lt;-</span> <span class="fu">cross_validation</span>(chemical, magnetic)</span>
<span id="cb130-62"><a href="#cb130-62" tabindex="-1"></a>adj_r2_results <span class="ot">&lt;-</span> <span class="fu">adjusted_r_squared</span>(chemical, magnetic)</span>
<span id="cb130-63"><a href="#cb130-63" tabindex="-1"></a></span>
<span id="cb130-64"><a href="#cb130-64" tabindex="-1"></a><span class="co"># 显示结果</span></span>
<span id="cb130-65"><a href="#cb130-65" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;均方误差 (MSE) 结果:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;均方误差 (MSE) 结果:&quot;</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" tabindex="-1"></a><span class="fu">print</span>(mse_results)</span></code></pre></div>
<pre><code>##    Linear Quadratic     Cubic   Log-Log 
##  19.55644  17.85248  18.17756  20.45424</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;调整后 R^2 结果:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;调整后 R^2 结果:&quot;</code></pre>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" tabindex="-1"></a><span class="fu">print</span>(adj_r2_results)</span></code></pre></div>
<pre><code>##    Linear Quadratic     Cubic   Log-Log 
## 0.5281545 0.5768151 0.5740396 0.4870624</code></pre>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" tabindex="-1"></a><span class="co"># 清除内存</span></span>
<span id="cb138-2"><a href="#cb138-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<ol style="list-style-type: decimal">
<li><p><strong>通过交叉验证（均方误差 MSE）选择最佳模型</strong>：</p>
<ul>
<li><strong>最佳模型</strong>：均方误差最低的是二次多项式模型（MSE =
17.85248），因此根据交叉验证结果，二次多项式模型是最佳选择。</li>
</ul></li>
<li><p><strong>根据最大调整后 <span class="math inline">\(R^2\)</span>
选择最佳模型</strong>：</p>
<ul>
<li><strong>最佳模型</strong>：调整后 <span class="math inline">\(R^2\)</span> 最大的是二次多项式模型（<span class="math inline">\(R^2 = 0.5768151\)</span>），因此根据最大调整后
<span class="math inline">\(R^2\)</span>
的结果，二次多项式模型依然是最佳选择。</li>
</ul></li>
</ol>
<div id="总结" class="section level3">
<h3>总结</h3>
<p>无论是通过交叉验证的均方误差还是调整后的 <span class="math inline">\(R^2\)</span>，<strong>二次多项式模型</strong>都被选为最佳拟合模型。这表明二次多项式模型在该数据集上的拟合效果最优。</p>
</div>
</div>
<div id="实现双样本-cramér-von-mises-检验以置换检验的形式来测试分布是否相等将该检验应用于-r-中的-chickwts-数据集." class="section level2">
<h2>8.1 实现双样本 Cramér-von Mises
检验，以置换检验的形式来测试分布是否相等。将该检验应用于 R 中的 chickwts
数据集.</h2>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" tabindex="-1"></a><span class="co"># 清除环境中的变量</span></span>
<span id="cb139-2"><a href="#cb139-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb139-3"><a href="#cb139-3" tabindex="-1"></a></span>
<span id="cb139-4"><a href="#cb139-4" tabindex="-1"></a><span class="co"># 加载数据集</span></span>
<span id="cb139-5"><a href="#cb139-5" tabindex="-1"></a><span class="fu">data</span>(<span class="st">&quot;chickwts&quot;</span>, <span class="at">package =</span> <span class="st">&quot;datasets&quot;</span>)</span>
<span id="cb139-6"><a href="#cb139-6" tabindex="-1"></a></span>
<span id="cb139-7"><a href="#cb139-7" tabindex="-1"></a><span class="co"># 提取豆粕和亚麻籽组的数据</span></span>
<span id="cb139-8"><a href="#cb139-8" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed <span class="sc">==</span> <span class="st">&quot;soybean&quot;</span>]))</span>
<span id="cb139-9"><a href="#cb139-9" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(chickwts<span class="sc">$</span>weight[chickwts<span class="sc">$</span>feed <span class="sc">==</span> <span class="st">&quot;linseed&quot;</span>]))</span>
<span id="cb139-10"><a href="#cb139-10" tabindex="-1"></a></span>
<span id="cb139-11"><a href="#cb139-11" tabindex="-1"></a><span class="co"># 定义Cramér-von Mises统计量计算函数</span></span>
<span id="cb139-12"><a href="#cb139-12" tabindex="-1"></a>cvm_statistic <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb139-13"><a href="#cb139-13" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb139-14"><a href="#cb139-14" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb139-15"><a href="#cb139-15" tabindex="-1"></a>  combined <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">c</span>(x, y))</span>
<span id="cb139-16"><a href="#cb139-16" tabindex="-1"></a>  Fx <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x)</span>
<span id="cb139-17"><a href="#cb139-17" tabindex="-1"></a>  Fy <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(y)</span>
<span id="cb139-18"><a href="#cb139-18" tabindex="-1"></a>  statistic <span class="ot">&lt;-</span> <span class="fu">sum</span>((<span class="fu">Fx</span>(combined) <span class="sc">-</span> <span class="fu">Fy</span>(combined))<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> (n <span class="sc">*</span> m) <span class="sc">/</span> (n <span class="sc">+</span> m)</span>
<span id="cb139-19"><a href="#cb139-19" tabindex="-1"></a>  <span class="fu">return</span>(statistic)</span>
<span id="cb139-20"><a href="#cb139-20" tabindex="-1"></a>}</span>
<span id="cb139-21"><a href="#cb139-21" tabindex="-1"></a></span>
<span id="cb139-22"><a href="#cb139-22" tabindex="-1"></a><span class="co"># 置换检验函数</span></span>
<span id="cb139-23"><a href="#cb139-23" tabindex="-1"></a>cvm_permutation_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">num_permutations =</span> <span class="dv">1000</span>) {</span>
<span id="cb139-24"><a href="#cb139-24" tabindex="-1"></a>  observed_stat <span class="ot">&lt;-</span> <span class="fu">cvm_statistic</span>(x, y)</span>
<span id="cb139-25"><a href="#cb139-25" tabindex="-1"></a>  combined <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb139-26"><a href="#cb139-26" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb139-27"><a href="#cb139-27" tabindex="-1"></a>  </span>
<span id="cb139-28"><a href="#cb139-28" tabindex="-1"></a>  perm_stats <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_permutations)</span>
<span id="cb139-29"><a href="#cb139-29" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_permutations) {</span>
<span id="cb139-30"><a href="#cb139-30" tabindex="-1"></a>    permuted <span class="ot">&lt;-</span> <span class="fu">sample</span>(combined)</span>
<span id="cb139-31"><a href="#cb139-31" tabindex="-1"></a>    x_perm <span class="ot">&lt;-</span> permuted[<span class="dv">1</span><span class="sc">:</span>n]</span>
<span id="cb139-32"><a href="#cb139-32" tabindex="-1"></a>    y_perm <span class="ot">&lt;-</span> permuted[(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(permuted)]</span>
<span id="cb139-33"><a href="#cb139-33" tabindex="-1"></a>    perm_stats[i] <span class="ot">&lt;-</span> <span class="fu">cvm_statistic</span>(x_perm, y_perm)</span>
<span id="cb139-34"><a href="#cb139-34" tabindex="-1"></a>  }</span>
<span id="cb139-35"><a href="#cb139-35" tabindex="-1"></a>  </span>
<span id="cb139-36"><a href="#cb139-36" tabindex="-1"></a>  <span class="co"># 计算p值</span></span>
<span id="cb139-37"><a href="#cb139-37" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(perm_stats <span class="sc">&gt;=</span> observed_stat)</span>
<span id="cb139-38"><a href="#cb139-38" tabindex="-1"></a>  </span>
<span id="cb139-39"><a href="#cb139-39" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">statistic =</span> observed_stat, <span class="at">p_value =</span> p_value)</span>
<span id="cb139-40"><a href="#cb139-40" tabindex="-1"></a>}</span>
<span id="cb139-41"><a href="#cb139-41" tabindex="-1"></a></span>
<span id="cb139-42"><a href="#cb139-42" tabindex="-1"></a><span class="co"># 执行置换检验</span></span>
<span id="cb139-43"><a href="#cb139-43" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># 设置随机种子以保证可重复性</span></span>
<span id="cb139-44"><a href="#cb139-44" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">cvm_permutation_test</span>(x, y, <span class="at">num_permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb139-45"><a href="#cb139-45" tabindex="-1"></a></span>
<span id="cb139-46"><a href="#cb139-46" tabindex="-1"></a><span class="co"># 打印结果</span></span>
<span id="cb139-47"><a href="#cb139-47" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;Cramér-von Mises 统计量:&quot;</span>, result<span class="sc">$</span>statistic))</span></code></pre></div>
<pre><code>## [1] &quot;Cramér-von Mises 统计量: 3.93956043956044&quot;</code></pre>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;p 值:&quot;</span>, result<span class="sc">$</span>p_value))</span></code></pre></div>
<pre><code>## [1] &quot;p 值: 0.422&quot;</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" tabindex="-1"></a><span class="co"># 清除内存</span></span>
<span id="cb143-2"><a href="#cb143-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<ol style="list-style-type: decimal">
<li><strong>Cramér-von Mises 统计量</strong>：
<ul>
<li>计算得到的 Cramér-von Mises 统计量值为
3.93956043956044。这个值表示豆粕组和亚麻籽组的经验分布函数之间的差异大小。</li>
</ul></li>
<li><strong>p 值</strong>：
<ul>
<li>置换检验的 p 值为 0.422。这个 p 值表示在 0.422
的概率下，我们可能会观察到等于或大于观测到的统计量差异。</li>
<li>通常在显著性水平（例如 0.05）下，如果 p 值大于
0.05，我们无法拒绝原假设。因此，p 值为 0.422 远大于
0.05，说明我们无法拒绝豆粕组和亚麻籽组的分布相等的原假设。</li>
</ul></li>
</ol>
<div id="总结-1" class="section level3">
<h3>总结</h3>
<ul>
<li><strong>结论</strong>：基于 Cramér-von Mises
检验的结果，我们没有足够的证据拒绝豆粕组和亚麻籽组在重量分布上的相等性假设。这意味着在统计上，这两个组的分布没有显著差异。</li>
</ul>
</div>
</div>
<div id="实现双变量spearman秩相关性检验来检验独立性以置换检验的形式spearman秩相关性检验的统计量可以通过函数-cor-并设置-method-spearman-获得将置换检验的显著性水平与-cor.test-在相同样本上报告的-p-值进行比较" class="section level2">
<h2>8.2
实现双变量Spearman秩相关性检验来检验独立性，以置换检验的形式。Spearman秩相关性检验的统计量可以通过函数
cor 并设置 method = “spearman” 获得。将置换检验的显著性水平与 cor.test
在相同样本上报告的 p 值进行比较。</h2>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" tabindex="-1"></a><span class="co"># 清除环境中的变量</span></span>
<span id="cb144-2"><a href="#cb144-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb144-3"><a href="#cb144-3" tabindex="-1"></a></span>
<span id="cb144-4"><a href="#cb144-4" tabindex="-1"></a><span class="co"># 定义计算Spearman秩相关性的函数</span></span>
<span id="cb144-5"><a href="#cb144-5" tabindex="-1"></a>spearman_correlation <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb144-6"><a href="#cb144-6" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>))</span>
<span id="cb144-7"><a href="#cb144-7" tabindex="-1"></a>}</span>
<span id="cb144-8"><a href="#cb144-8" tabindex="-1"></a></span>
<span id="cb144-9"><a href="#cb144-9" tabindex="-1"></a><span class="co"># 定义置换检验函数</span></span>
<span id="cb144-10"><a href="#cb144-10" tabindex="-1"></a>spearman_permutation_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">num_permutations =</span> <span class="dv">1000</span>) {</span>
<span id="cb144-11"><a href="#cb144-11" tabindex="-1"></a>  <span class="co"># 计算观察到的Spearman相关性</span></span>
<span id="cb144-12"><a href="#cb144-12" tabindex="-1"></a>  observed_stat <span class="ot">&lt;-</span> <span class="fu">spearman_correlation</span>(x, y)</span>
<span id="cb144-13"><a href="#cb144-13" tabindex="-1"></a>  </span>
<span id="cb144-14"><a href="#cb144-14" tabindex="-1"></a>  <span class="co"># 初始化置换统计量</span></span>
<span id="cb144-15"><a href="#cb144-15" tabindex="-1"></a>  perm_stats <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_permutations)</span>
<span id="cb144-16"><a href="#cb144-16" tabindex="-1"></a>  </span>
<span id="cb144-17"><a href="#cb144-17" tabindex="-1"></a>  <span class="co"># 进行置换</span></span>
<span id="cb144-18"><a href="#cb144-18" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_permutations) {</span>
<span id="cb144-19"><a href="#cb144-19" tabindex="-1"></a>    y_permuted <span class="ot">&lt;-</span> <span class="fu">sample</span>(y)  <span class="co"># 随机置换y</span></span>
<span id="cb144-20"><a href="#cb144-20" tabindex="-1"></a>    perm_stats[i] <span class="ot">&lt;-</span> <span class="fu">spearman_correlation</span>(x, y_permuted)</span>
<span id="cb144-21"><a href="#cb144-21" tabindex="-1"></a>  }</span>
<span id="cb144-22"><a href="#cb144-22" tabindex="-1"></a>  </span>
<span id="cb144-23"><a href="#cb144-23" tabindex="-1"></a>  <span class="co"># 计算p值</span></span>
<span id="cb144-24"><a href="#cb144-24" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">abs</span>(perm_stats) <span class="sc">&gt;=</span> <span class="fu">abs</span>(observed_stat))</span>
<span id="cb144-25"><a href="#cb144-25" tabindex="-1"></a>  </span>
<span id="cb144-26"><a href="#cb144-26" tabindex="-1"></a>  <span class="co"># 返回结果</span></span>
<span id="cb144-27"><a href="#cb144-27" tabindex="-1"></a>  <span class="fu">list</span>(<span class="at">statistic =</span> observed_stat, <span class="at">p_value =</span> p_value)</span>
<span id="cb144-28"><a href="#cb144-28" tabindex="-1"></a>}</span>
<span id="cb144-29"><a href="#cb144-29" tabindex="-1"></a></span>
<span id="cb144-30"><a href="#cb144-30" tabindex="-1"></a><span class="co"># 测试数据</span></span>
<span id="cb144-31"><a href="#cb144-31" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># 设置随机种子保证结果可重复</span></span>
<span id="cb144-32"><a href="#cb144-32" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">30</span>)  <span class="co"># 随机生成数据</span></span>
<span id="cb144-33"><a href="#cb144-33" tabindex="-1"></a>y <span class="ot">&lt;-</span> x <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">30</span>) <span class="sc">*</span> <span class="fl">0.5</span>  <span class="co"># 添加噪声的相关数据</span></span>
<span id="cb144-34"><a href="#cb144-34" tabindex="-1"></a></span>
<span id="cb144-35"><a href="#cb144-35" tabindex="-1"></a><span class="co"># 执行置换检验</span></span>
<span id="cb144-36"><a href="#cb144-36" tabindex="-1"></a>result_permutation <span class="ot">&lt;-</span> <span class="fu">spearman_permutation_test</span>(x, y, <span class="at">num_permutations =</span> <span class="dv">1000</span>)</span>
<span id="cb144-37"><a href="#cb144-37" tabindex="-1"></a></span>
<span id="cb144-38"><a href="#cb144-38" tabindex="-1"></a><span class="co"># 使用 cor.test 计算 p 值</span></span>
<span id="cb144-39"><a href="#cb144-39" tabindex="-1"></a>result_cor_test <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb144-40"><a href="#cb144-40" tabindex="-1"></a></span>
<span id="cb144-41"><a href="#cb144-41" tabindex="-1"></a><span class="co"># 显示结果</span></span>
<span id="cb144-42"><a href="#cb144-42" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;置换检验的Spearman相关性统计量:&quot;</span>, result_permutation<span class="sc">$</span>statistic))</span></code></pre></div>
<pre><code>## [1] &quot;置换检验的Spearman相关性统计量: 0.90567296996663&quot;</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;置换检验的p值:&quot;</span>, result_permutation<span class="sc">$</span>p_value))</span></code></pre></div>
<pre><code>## [1] &quot;置换检验的p值: 0&quot;</code></pre>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;cor.test的p值:&quot;</span>, result_cor_test<span class="sc">$</span>p.value))</span></code></pre></div>
<pre><code>## [1] &quot;cor.test的p值: 2.17768693310597e-07&quot;</code></pre>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" tabindex="-1"></a><span class="co"># 清除内存</span></span>
<span id="cb150-2"><a href="#cb150-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span></code></pre></div>
<ol style="list-style-type: decimal">
<li><strong>置换检验的Spearman相关性统计量</strong>：
<ul>
<li>计算得到的Spearman相关性统计量为 <span class="math inline">\(0.90567296996663\)</span>。这个值表示变量 <span class="math inline">\(x\)</span> 和 <span class="math inline">\(y\)</span> 之间的强正相关性。</li>
</ul></li>
<li><strong>置换检验的p值</strong>：
<ul>
<li>置换检验的p值为
0，这表明在1000次置换中，没有一次置换导致的相关性统计量等于或超过了观察到的相关性值。这说明变量
<span class="math inline">\(x\)</span> 和 <span class="math inline">\(y\)</span> 的相关性在统计上非常显著。</li>
</ul></li>
<li><strong>cor.test 的 p 值</strong>：
<ul>
<li>使用 <code>cor.test</code> 计算的 p 值为 <span class="math inline">\(2.17768693310597 \times
10^{-7}\)</span>，也非常接近零。这表明变量 <span class="math inline">\(x\)</span> 和 <span class="math inline">\(y\)</span>
之间的相关性在显著性水平（例如0.05）下非常显著。</li>
</ul></li>
</ol>
<div id="总结-2" class="section level3">
<h3>总结</h3>
<ul>
<li><strong>结论</strong>：无论是通过置换检验还是
<code>cor.test</code>，我们都可以得出变量 <span class="math inline">\(x\)</span> 和 <span class="math inline">\(y\)</span>
之间存在显著正相关的结论。两种方法的p值都接近零，进一步验证了这种显著性。</li>
</ul>
</div>
</div>
<div id="answer-6" class="section level2">
<h2>Answer 6</h2>
</div>
<div id="section-4" class="section level2">
<h2>9.3</h2>
<p>使用Metropolis-Hastings采样器从标准柯西分布中生成随机变量。舍弃链的前1000个样本，并将生成的观测值的十分位数与标准柯西分布的十分位数进行比较（请参见<code>qcauchy</code>或<code>qt</code>，设置自由度df=1）。回顾一下，柯西分布<span class="math inline">\(Cauchy(\theta, \eta)\)</span>的密度函数为：</p>
<p><span class="math display">\[
f(x) = \frac{1}{\theta \pi (1 + \left(\frac{x -
\eta}{\theta}\right)^2)}, \quad -\infty &lt; x &lt; \infty, \quad \theta
&gt; 0。
\]</span></p>
<p>标准柯西分布的参数为<span class="math inline">\(\theta =
1\)</span>和<span class="math inline">\(\eta =
0\)</span>。（注意，标准柯西密度等价于自由度为1的学生t分布密度。）
增加使用Gelman-Rubin方法监控链的收敛性，并运行链直到它根据 <span class="math inline">\(\hat{R} &lt; 1.2\)</span> 大致收敛到目标分布。</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb151-2"><a href="#cb151-2" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># 标准柯西分布的尺度参数</span></span>
<span id="cb151-3"><a href="#cb151-3" tabindex="-1"></a>eta <span class="ot">&lt;-</span> <span class="dv">0</span>    <span class="co"># 标准柯西分布的位置参数</span></span>
<span id="cb151-4"><a href="#cb151-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># 每条链生成的样本数量</span></span>
<span id="cb151-5"><a href="#cb151-5" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">1000</span>  <span class="co"># 舍弃的样本数</span></span>
<span id="cb151-6"><a href="#cb151-6" tabindex="-1"></a>chains <span class="ot">&lt;-</span> <span class="dv">4</span>  <span class="co"># 生成的链数</span></span>
<span id="cb151-7"><a href="#cb151-7" tabindex="-1"></a></span>
<span id="cb151-8"><a href="#cb151-8" tabindex="-1"></a><span class="co"># 1. 定义目标密度函数 (标准柯西分布的概率密度函数)</span></span>
<span id="cb151-9"><a href="#cb151-9" tabindex="-1"></a>dcauchy_density <span class="ot">&lt;-</span> <span class="cf">function</span>(x, theta, eta) {</span>
<span id="cb151-10"><a href="#cb151-10" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span> <span class="sc">/</span> (theta <span class="sc">*</span> pi <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> ((x <span class="sc">-</span> eta) <span class="sc">/</span> theta)<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb151-11"><a href="#cb151-11" tabindex="-1"></a>}</span>
<span id="cb151-12"><a href="#cb151-12" tabindex="-1"></a></span>
<span id="cb151-13"><a href="#cb151-13" tabindex="-1"></a><span class="co"># 2. Metropolis-Hastings采样函数</span></span>
<span id="cb151-14"><a href="#cb151-14" tabindex="-1"></a>metropolis_hastings <span class="ot">&lt;-</span> <span class="cf">function</span>(n, burn_in, theta, eta) {</span>
<span id="cb151-15"><a href="#cb151-15" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)  <span class="co"># 预分配内存</span></span>
<span id="cb151-16"><a href="#cb151-16" tabindex="-1"></a>  samples[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># 初始值</span></span>
<span id="cb151-17"><a href="#cb151-17" tabindex="-1"></a>  </span>
<span id="cb151-18"><a href="#cb151-18" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb151-19"><a href="#cb151-19" tabindex="-1"></a>    <span class="co"># 提议分布: 使用正态分布提议</span></span>
<span id="cb151-20"><a href="#cb151-20" tabindex="-1"></a>    proposal <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> samples[i<span class="dv">-1</span>], <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb151-21"><a href="#cb151-21" tabindex="-1"></a>    </span>
<span id="cb151-22"><a href="#cb151-22" tabindex="-1"></a>    <span class="co"># 计算接受率</span></span>
<span id="cb151-23"><a href="#cb151-23" tabindex="-1"></a>    acceptance_ratio <span class="ot">&lt;-</span> <span class="fu">dcauchy_density</span>(proposal, theta, eta) <span class="sc">/</span> <span class="fu">dcauchy_density</span>(samples[i<span class="dv">-1</span>], theta, eta)</span>
<span id="cb151-24"><a href="#cb151-24" tabindex="-1"></a>    </span>
<span id="cb151-25"><a href="#cb151-25" tabindex="-1"></a>    <span class="co"># 接受或拒绝</span></span>
<span id="cb151-26"><a href="#cb151-26" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> acceptance_ratio) {</span>
<span id="cb151-27"><a href="#cb151-27" tabindex="-1"></a>      samples[i] <span class="ot">&lt;-</span> proposal</span>
<span id="cb151-28"><a href="#cb151-28" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb151-29"><a href="#cb151-29" tabindex="-1"></a>      samples[i] <span class="ot">&lt;-</span> samples[i<span class="dv">-1</span>]</span>
<span id="cb151-30"><a href="#cb151-30" tabindex="-1"></a>    }</span>
<span id="cb151-31"><a href="#cb151-31" tabindex="-1"></a>  }</span>
<span id="cb151-32"><a href="#cb151-32" tabindex="-1"></a>  </span>
<span id="cb151-33"><a href="#cb151-33" tabindex="-1"></a>  <span class="co"># 舍弃前 burn_in 个样本</span></span>
<span id="cb151-34"><a href="#cb151-34" tabindex="-1"></a>  <span class="fu">return</span>(samples[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>n])</span>
<span id="cb151-35"><a href="#cb151-35" tabindex="-1"></a>}</span>
<span id="cb151-36"><a href="#cb151-36" tabindex="-1"></a></span>
<span id="cb151-37"><a href="#cb151-37" tabindex="-1"></a><span class="co"># 3. 计算Gelman-Rubin统计量</span></span>
<span id="cb151-38"><a href="#cb151-38" tabindex="-1"></a>gelman_rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(chains) {</span>
<span id="cb151-39"><a href="#cb151-39" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(chains)</span>
<span id="cb151-40"><a href="#cb151-40" tabindex="-1"></a>  <span class="co"># 计算各链均值和方差</span></span>
<span id="cb151-41"><a href="#cb151-41" tabindex="-1"></a>  means <span class="ot">&lt;-</span> <span class="fu">sapply</span>(chains, mean)</span>
<span id="cb151-42"><a href="#cb151-42" tabindex="-1"></a>  variances <span class="ot">&lt;-</span> <span class="fu">sapply</span>(chains, var)</span>
<span id="cb151-43"><a href="#cb151-43" tabindex="-1"></a>  </span>
<span id="cb151-44"><a href="#cb151-44" tabindex="-1"></a>  <span class="co"># 计算整体均值和整体方差</span></span>
<span id="cb151-45"><a href="#cb151-45" tabindex="-1"></a>  overall_mean <span class="ot">&lt;-</span> <span class="fu">mean</span>(means)</span>
<span id="cb151-46"><a href="#cb151-46" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="fu">sum</span>((means <span class="sc">-</span> overall_mean)<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> n <span class="sc">/</span> (m <span class="sc">-</span> <span class="dv">1</span>)  <span class="co"># between-chain variance</span></span>
<span id="cb151-47"><a href="#cb151-47" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(variances)  <span class="co"># within-chain variance</span></span>
<span id="cb151-48"><a href="#cb151-48" tabindex="-1"></a>  var_hat <span class="ot">&lt;-</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n <span class="sc">*</span> W <span class="sc">+</span> B <span class="sc">/</span> n  <span class="co"># combined variance</span></span>
<span id="cb151-49"><a href="#cb151-49" tabindex="-1"></a>  </span>
<span id="cb151-50"><a href="#cb151-50" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sqrt</span>(var_hat <span class="sc">/</span> W))  <span class="co"># Gelman-Rubin统计量</span></span>
<span id="cb151-51"><a href="#cb151-51" tabindex="-1"></a>}</span>
<span id="cb151-52"><a href="#cb151-52" tabindex="-1"></a></span>
<span id="cb151-53"><a href="#cb151-53" tabindex="-1"></a><span class="co"># 4. 运行链直到收敛</span></span>
<span id="cb151-54"><a href="#cb151-54" tabindex="-1"></a>run_chains_until_convergence <span class="ot">&lt;-</span> <span class="cf">function</span>(n, burn_in, theta, eta, chains) {</span>
<span id="cb151-55"><a href="#cb151-55" tabindex="-1"></a>  chain_samples <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>chains, <span class="cf">function</span>(x) <span class="fu">metropolis_hastings</span>(n, burn_in, theta, eta))</span>
<span id="cb151-56"><a href="#cb151-56" tabindex="-1"></a>  hat_R <span class="ot">&lt;-</span> <span class="fu">gelman_rubin</span>(chain_samples)</span>
<span id="cb151-57"><a href="#cb151-57" tabindex="-1"></a>  </span>
<span id="cb151-58"><a href="#cb151-58" tabindex="-1"></a>  <span class="cf">while</span> (hat_R <span class="sc">&gt;=</span> <span class="fl">1.2</span>) {</span>
<span id="cb151-59"><a href="#cb151-59" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;当前 </span><span class="sc">\\</span><span class="st">hat{R}: &quot;</span>, hat_R, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb151-60"><a href="#cb151-60" tabindex="-1"></a>    chain_samples <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>chains, <span class="cf">function</span>(x) <span class="fu">metropolis_hastings</span>(n, burn_in, theta, eta))</span>
<span id="cb151-61"><a href="#cb151-61" tabindex="-1"></a>    hat_R <span class="ot">&lt;-</span> <span class="fu">gelman_rubin</span>(chain_samples)</span>
<span id="cb151-62"><a href="#cb151-62" tabindex="-1"></a>  }</span>
<span id="cb151-63"><a href="#cb151-63" tabindex="-1"></a>  </span>
<span id="cb151-64"><a href="#cb151-64" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;最终 </span><span class="sc">\\</span><span class="st">hat{R}: &quot;</span>, hat_R, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)  <span class="co"># 输出最终的Gelman-Rubin统计量</span></span>
<span id="cb151-65"><a href="#cb151-65" tabindex="-1"></a>  <span class="fu">return</span>(chain_samples)</span>
<span id="cb151-66"><a href="#cb151-66" tabindex="-1"></a>}</span>
<span id="cb151-67"><a href="#cb151-67" tabindex="-1"></a></span>
<span id="cb151-68"><a href="#cb151-68" tabindex="-1"></a><span class="co"># 5. 计算并比较十分位数的函数</span></span>
<span id="cb151-69"><a href="#cb151-69" tabindex="-1"></a>compare_quantiles <span class="ot">&lt;-</span> <span class="cf">function</span>(samples, theta, eta) {</span>
<span id="cb151-70"><a href="#cb151-70" tabindex="-1"></a>  sample_quantiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(samples, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>))</span>
<span id="cb151-71"><a href="#cb151-71" tabindex="-1"></a>  theoretical_quantiles <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(<span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="fl">0.9</span>, <span class="at">by =</span> <span class="fl">0.1</span>), <span class="at">location =</span> eta, <span class="at">scale =</span> theta)</span>
<span id="cb151-72"><a href="#cb151-72" tabindex="-1"></a>  </span>
<span id="cb151-73"><a href="#cb151-73" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;生成样本的十分位数：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb151-74"><a href="#cb151-74" tabindex="-1"></a>  <span class="fu">print</span>(sample_quantiles)</span>
<span id="cb151-75"><a href="#cb151-75" tabindex="-1"></a>  </span>
<span id="cb151-76"><a href="#cb151-76" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">标准柯西分布的理论十分位数：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb151-77"><a href="#cb151-77" tabindex="-1"></a>  <span class="fu">print</span>(theoretical_quantiles)</span>
<span id="cb151-78"><a href="#cb151-78" tabindex="-1"></a>}</span>
<span id="cb151-79"><a href="#cb151-79" tabindex="-1"></a></span>
<span id="cb151-80"><a href="#cb151-80" tabindex="-1"></a><span class="co"># 6. 可视化函数</span></span>
<span id="cb151-81"><a href="#cb151-81" tabindex="-1"></a>plot_samples <span class="ot">&lt;-</span> <span class="cf">function</span>(samples, theta, eta) {</span>
<span id="cb151-82"><a href="#cb151-82" tabindex="-1"></a>  <span class="fu">hist</span>(samples, <span class="at">breaks =</span> <span class="dv">50</span>, <span class="at">probability =</span> <span class="cn">TRUE</span>, <span class="at">main =</span> <span class="st">&quot;Metropolis-Hastings 生成的标准柯西分布样本&quot;</span>,</span>
<span id="cb151-83"><a href="#cb151-83" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;样本值&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;密度&quot;</span>)</span>
<span id="cb151-84"><a href="#cb151-84" tabindex="-1"></a>  <span class="fu">curve</span>(<span class="fu">dcauchy</span>(x, <span class="at">location =</span> eta, <span class="at">scale =</span> theta), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">add =</span> <span class="cn">TRUE</span>)</span>
<span id="cb151-85"><a href="#cb151-85" tabindex="-1"></a>  <span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;生成样本密度&quot;</span>, <span class="st">&quot;理论密度&quot;</span>), <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb151-86"><a href="#cb151-86" tabindex="-1"></a>}</span>
<span id="cb151-87"><a href="#cb151-87" tabindex="-1"></a></span>
<span id="cb151-88"><a href="#cb151-88" tabindex="-1"></a><span class="co"># 主程序</span></span>
<span id="cb151-89"><a href="#cb151-89" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)  <span class="co"># 设置随机种子</span></span>
<span id="cb151-90"><a href="#cb151-90" tabindex="-1"></a>chain_samples <span class="ot">&lt;-</span> <span class="fu">run_chains_until_convergence</span>(n, burn_in, theta, eta, chains)  <span class="co"># 运行链直到收敛</span></span></code></pre></div>
<pre><code>## 最终 \hat{R}:  1.066313</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" tabindex="-1"></a><span class="co"># 计算并输出每条链的十分位数比较结果</span></span>
<span id="cb153-2"><a href="#cb153-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>chains) {</span>
<span id="cb153-3"><a href="#cb153-3" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;链&quot;</span>, i, <span class="st">&quot;的十分位数比较：</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb153-4"><a href="#cb153-4" tabindex="-1"></a>  <span class="fu">compare_quantiles</span>(chain_samples[[i]], theta, eta)</span>
<span id="cb153-5"><a href="#cb153-5" tabindex="-1"></a>  <span class="fu">plot_samples</span>(chain_samples[[i]], theta, eta)</span>
<span id="cb153-6"><a href="#cb153-6" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 链 1 的十分位数比较：
## 生成样本的十分位数：
##         10%         20%         30%         40%         50%         60% 
## -2.18474571 -1.09015378 -0.57312051 -0.21663278  0.09106208  0.40001763 
##         70%         80%         90% 
##  0.80365532  1.55990828  4.01207985 
## 
## 标准柯西分布的理论十分位数：
## [1] -3.0776835 -1.3763819 -0.7265425 -0.3249197  0.0000000  0.3249197  0.7265425
## [8]  1.3763819  3.0776835</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## 链 2 的十分位数比较：
## 生成样本的十分位数：
##        10%        20%        30%        40%        50%        60%        70% 
## -1.5042695 -0.7459769 -0.2802517  0.1045972  0.5023802  1.1038068  2.3039684 
##        80%        90% 
##  7.8946050 25.0979444 
## 
## 标准柯西分布的理论十分位数：
## [1] -3.0776835 -1.3763819 -0.7265425 -0.3249197  0.0000000  0.3249197  0.7265425
## [8]  1.3763819  3.0776835</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## 链 3 的十分位数比较：
## 生成样本的十分位数：
##        10%        20%        30%        40%        50%        60%        70% 
## -2.3444870 -1.1042688 -0.5422807 -0.1668720  0.1612065  0.5282842  1.0168763 
##        80%        90% 
##  1.9379531  3.7638228 
## 
## 标准柯西分布的理论十分位数：
## [1] -3.0776835 -1.3763819 -0.7265425 -0.3249197  0.0000000  0.3249197  0.7265425
## [8]  1.3763819  3.0776835</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## 链 4 的十分位数比较：
## 生成样本的十分位数：
##         10%         20%         30%         40%         50%         60% 
## -3.09497102 -1.33118136 -0.69958454 -0.30586690  0.01411797  0.31968718 
##         70%         80%         90% 
##  0.67576771  1.26795887  2.76839271 
## 
## 标准柯西分布的理论十分位数：
## [1] -3.0776835 -1.3763819 -0.7265425 -0.3249197  0.0000000  0.3249197  0.7265425
## [8]  1.3763819  3.0776835</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" tabindex="-1"></a><span class="co"># 清理内存</span></span>
<span id="cb158-2"><a href="#cb158-2" tabindex="-1"></a><span class="fu">rm</span>(chain_samples)</span>
<span id="cb158-3"><a href="#cb158-3" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##           used  (Mb) gc trigger  (Mb) max used  (Mb)
## Ncells 2085244 111.4    3747821 200.2  3747821 200.2
## Vcells 3713037  28.4    8392178  64.1  8392178  64.1</code></pre>
</div>
<div id="section-5" class="section level2">
<h2>9.8</h2>
<p>9.8 该示例出现在文献[40]中。考虑二元密度</p>
<p><span class="math display">\[
f(x, y) \propto \binom{n}{x} y^{x+a-1}(1-y)^{n-x+b-1}, \quad x = 0, 1,
\dots, n, \quad 0 \leq y \leq 1。
\]</span></p>
<p>可以证明（参见例如文献[23]），对于固定的 <span class="math inline">\(a\)</span>、<span class="math inline">\(b\)</span>、<span class="math inline">\(n\)</span>，条件分布为二项分布<span class="math inline">\(Binomial(n, y)\)</span>和贝塔分布<span class="math inline">\(Beta(x + a, n - x +
b)\)</span>。使用Gibbs采样器生成以 <span class="math inline">\(f(x,
y)\)</span> 为目标联合密度的链。
增加使用Gelman-Rubin方法监控链的收敛性，并运行链直到它根据 <span class="math inline">\(\hat{R} &lt; 1.2\)</span> 大致收敛到目标分布。</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" tabindex="-1"></a><span class="co"># 加载必要的包</span></span>
<span id="cb160-2"><a href="#cb160-2" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb160-3"><a href="#cb160-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 4.4.2</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb162-2"><a href="#cb162-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span>  <span class="co"># a的值</span></span>
<span id="cb162-3"><a href="#cb162-3" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span>  <span class="co"># b的值</span></span>
<span id="cb162-4"><a href="#cb162-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># n的值</span></span>
<span id="cb162-5"><a href="#cb162-5" tabindex="-1"></a>num_samples <span class="ot">&lt;-</span> <span class="dv">20000</span>  <span class="co"># 增加采样数量</span></span>
<span id="cb162-6"><a href="#cb162-6" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">2000</span>       <span class="co"># 适当增加burn-in</span></span>
<span id="cb162-7"><a href="#cb162-7" tabindex="-1"></a>chains <span class="ot">&lt;-</span> <span class="dv">4</span>           <span class="co"># 生成的链数</span></span>
<span id="cb162-8"><a href="#cb162-8" tabindex="-1"></a></span>
<span id="cb162-9"><a href="#cb162-9" tabindex="-1"></a><span class="co"># 1. 定义从条件分布Binomial(n, y)采样的函数</span></span>
<span id="cb162-10"><a href="#cb162-10" tabindex="-1"></a>sample_x_given_y <span class="ot">&lt;-</span> <span class="cf">function</span>(y, n) {</span>
<span id="cb162-11"><a href="#cb162-11" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">rbinom</span>(<span class="dv">1</span>, <span class="at">size =</span> n, <span class="at">prob =</span> y))</span>
<span id="cb162-12"><a href="#cb162-12" tabindex="-1"></a>}</span>
<span id="cb162-13"><a href="#cb162-13" tabindex="-1"></a></span>
<span id="cb162-14"><a href="#cb162-14" tabindex="-1"></a><span class="co"># 2. 定义从条件分布Beta(x + a, n - x + b)采样的函数</span></span>
<span id="cb162-15"><a href="#cb162-15" tabindex="-1"></a>sample_y_given_x <span class="ot">&lt;-</span> <span class="cf">function</span>(x, a, b, n) {</span>
<span id="cb162-16"><a href="#cb162-16" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">rbeta</span>(<span class="dv">1</span>, <span class="at">shape1 =</span> x <span class="sc">+</span> a, <span class="at">shape2 =</span> n <span class="sc">-</span> x <span class="sc">+</span> b))</span>
<span id="cb162-17"><a href="#cb162-17" tabindex="-1"></a>}</span>
<span id="cb162-18"><a href="#cb162-18" tabindex="-1"></a></span>
<span id="cb162-19"><a href="#cb162-19" tabindex="-1"></a><span class="co"># 3. Gibbs采样函数，随机初始化每条链的x和y</span></span>
<span id="cb162-20"><a href="#cb162-20" tabindex="-1"></a>gibbs_sampler <span class="ot">&lt;-</span> <span class="cf">function</span>(num_samples, burn_in, a, b, n) {</span>
<span id="cb162-21"><a href="#cb162-21" tabindex="-1"></a>  samples <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> num_samples, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb162-22"><a href="#cb162-22" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span>n, <span class="dv">1</span>)           <span class="co"># 随机选择初始x</span></span>
<span id="cb162-23"><a href="#cb162-23" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)           <span class="co"># 随机选择初始y</span></span>
<span id="cb162-24"><a href="#cb162-24" tabindex="-1"></a>  </span>
<span id="cb162-25"><a href="#cb162-25" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>num_samples) {</span>
<span id="cb162-26"><a href="#cb162-26" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="fu">sample_x_given_y</span>(y, n)</span>
<span id="cb162-27"><a href="#cb162-27" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">sample_y_given_x</span>(x, a, b, n)</span>
<span id="cb162-28"><a href="#cb162-28" tabindex="-1"></a>    samples[i, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb162-29"><a href="#cb162-29" tabindex="-1"></a>  }</span>
<span id="cb162-30"><a href="#cb162-30" tabindex="-1"></a>  </span>
<span id="cb162-31"><a href="#cb162-31" tabindex="-1"></a>  <span class="fu">return</span>(samples[(burn_in <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>num_samples, ])</span>
<span id="cb162-32"><a href="#cb162-32" tabindex="-1"></a>}</span>
<span id="cb162-33"><a href="#cb162-33" tabindex="-1"></a></span>
<span id="cb162-34"><a href="#cb162-34" tabindex="-1"></a><span class="co"># 4. 计算Gelman-Rubin统计量</span></span>
<span id="cb162-35"><a href="#cb162-35" tabindex="-1"></a>run_chains_until_convergence <span class="ot">&lt;-</span> <span class="cf">function</span>(num_samples, burn_in, a, b, n, chains) {</span>
<span id="cb162-36"><a href="#cb162-36" tabindex="-1"></a>  chain_samples <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>chains, <span class="cf">function</span>(x) <span class="fu">gibbs_sampler</span>(num_samples, burn_in, a, b, n))</span>
<span id="cb162-37"><a href="#cb162-37" tabindex="-1"></a>  chain_samples_mcmc <span class="ot">&lt;-</span> <span class="fu">lapply</span>(chain_samples, <span class="cf">function</span>(samples) <span class="fu">as.mcmc</span>(samples))</span>
<span id="cb162-38"><a href="#cb162-38" tabindex="-1"></a>  </span>
<span id="cb162-39"><a href="#cb162-39" tabindex="-1"></a>  gelman_diag_result <span class="ot">&lt;-</span> <span class="fu">gelman.diag</span>(<span class="fu">mcmc.list</span>(chain_samples_mcmc))</span>
<span id="cb162-40"><a href="#cb162-40" tabindex="-1"></a>  hat_R <span class="ot">&lt;-</span> gelman_diag_result<span class="sc">$</span>psrf</span>
<span id="cb162-41"><a href="#cb162-41" tabindex="-1"></a>  </span>
<span id="cb162-42"><a href="#cb162-42" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">any</span>(hat_R <span class="sc">&gt;=</span> <span class="fl">1.2</span>)) {</span>
<span id="cb162-43"><a href="#cb162-43" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&quot;当前 </span><span class="sc">\\</span><span class="st">hat{R}: &quot;</span>, hat_R, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb162-44"><a href="#cb162-44" tabindex="-1"></a>    chain_samples <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>chains, <span class="cf">function</span>(x) <span class="fu">gibbs_sampler</span>(num_samples, burn_in, a, b, n))</span>
<span id="cb162-45"><a href="#cb162-45" tabindex="-1"></a>    chain_samples_mcmc <span class="ot">&lt;-</span> <span class="fu">lapply</span>(chain_samples, <span class="cf">function</span>(samples) <span class="fu">as.mcmc</span>(samples))</span>
<span id="cb162-46"><a href="#cb162-46" tabindex="-1"></a>    gelman_diag_result <span class="ot">&lt;-</span> <span class="fu">gelman.diag</span>(<span class="fu">mcmc.list</span>(chain_samples_mcmc))</span>
<span id="cb162-47"><a href="#cb162-47" tabindex="-1"></a>    hat_R <span class="ot">&lt;-</span> gelman_diag_result<span class="sc">$</span>psrf</span>
<span id="cb162-48"><a href="#cb162-48" tabindex="-1"></a>  }</span>
<span id="cb162-49"><a href="#cb162-49" tabindex="-1"></a>  </span>
<span id="cb162-50"><a href="#cb162-50" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;最终 </span><span class="sc">\\</span><span class="st">hat{R}: &quot;</span>, hat_R, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb162-51"><a href="#cb162-51" tabindex="-1"></a>  <span class="fu">return</span>(chain_samples)</span>
<span id="cb162-52"><a href="#cb162-52" tabindex="-1"></a>}</span>
<span id="cb162-53"><a href="#cb162-53" tabindex="-1"></a></span>
<span id="cb162-54"><a href="#cb162-54" tabindex="-1"></a><span class="co"># 5. 定义联合密度函数</span></span>
<span id="cb162-55"><a href="#cb162-55" tabindex="-1"></a>joint_density <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, a, b, n) {</span>
<span id="cb162-56"><a href="#cb162-56" tabindex="-1"></a>  coeff <span class="ot">&lt;-</span> <span class="fu">choose</span>(n, x)  <span class="co"># 二项式系数</span></span>
<span id="cb162-57"><a href="#cb162-57" tabindex="-1"></a>  density <span class="ot">&lt;-</span> coeff <span class="sc">*</span> (y<span class="sc">^</span>(x <span class="sc">+</span> a <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">*</span> ((<span class="dv">1</span> <span class="sc">-</span> y)<span class="sc">^</span>(n <span class="sc">-</span> x <span class="sc">+</span> b <span class="sc">-</span> <span class="dv">1</span>))</span>
<span id="cb162-58"><a href="#cb162-58" tabindex="-1"></a>  <span class="fu">return</span>(density)</span>
<span id="cb162-59"><a href="#cb162-59" tabindex="-1"></a>}</span>
<span id="cb162-60"><a href="#cb162-60" tabindex="-1"></a></span>
<span id="cb162-61"><a href="#cb162-61" tabindex="-1"></a><span class="co"># 6. 可视化函数：绘制x和y的联合分布图</span></span>
<span id="cb162-62"><a href="#cb162-62" tabindex="-1"></a>plot_samples <span class="ot">&lt;-</span> <span class="cf">function</span>(samples) {</span>
<span id="cb162-63"><a href="#cb162-63" tabindex="-1"></a>  <span class="fu">plot</span>(samples[, <span class="dv">1</span>], samples[, <span class="dv">2</span>], <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb162-64"><a href="#cb162-64" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span>, <span class="at">main =</span> <span class="st">&quot;Gibbs采样生成的(x, y)联合分布&quot;</span>)</span>
<span id="cb162-65"><a href="#cb162-65" tabindex="-1"></a>}</span>
<span id="cb162-66"><a href="#cb162-66" tabindex="-1"></a></span>
<span id="cb162-67"><a href="#cb162-67" tabindex="-1"></a><span class="co"># 7. 可视化目标联合密度</span></span>
<span id="cb162-68"><a href="#cb162-68" tabindex="-1"></a>plot_joint_density <span class="ot">&lt;-</span> <span class="cf">function</span>(a, b, n) {</span>
<span id="cb162-69"><a href="#cb162-69" tabindex="-1"></a>  x_values <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>n</span>
<span id="cb162-70"><a href="#cb162-70" tabindex="-1"></a>  y_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">100</span>)</span>
<span id="cb162-71"><a href="#cb162-71" tabindex="-1"></a>  </span>
<span id="cb162-72"><a href="#cb162-72" tabindex="-1"></a>  <span class="co"># 创建数据框以存储密度值</span></span>
<span id="cb162-73"><a href="#cb162-73" tabindex="-1"></a>  density_data <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">x =</span> x_values, <span class="at">y =</span> y_values)</span>
<span id="cb162-74"><a href="#cb162-74" tabindex="-1"></a>  density_data<span class="sc">$</span>f_xy <span class="ot">&lt;-</span> <span class="fu">mapply</span>(joint_density, density_data<span class="sc">$</span>x, density_data<span class="sc">$</span>y, <span class="at">MoreArgs =</span> <span class="fu">list</span>(<span class="at">a =</span> a, <span class="at">b =</span> b, <span class="at">n =</span> n))</span>
<span id="cb162-75"><a href="#cb162-75" tabindex="-1"></a>  </span>
<span id="cb162-76"><a href="#cb162-76" tabindex="-1"></a>  <span class="co"># 绘制密度图</span></span>
<span id="cb162-77"><a href="#cb162-77" tabindex="-1"></a>  <span class="fu">ggplot</span>(density_data, <span class="fu">aes</span>(<span class="at">x =</span> y, <span class="at">y =</span> x, <span class="at">fill =</span> f_xy)) <span class="sc">+</span></span>
<span id="cb162-78"><a href="#cb162-78" tabindex="-1"></a>    <span class="fu">geom_raster</span>(<span class="at">interpolate =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb162-79"><a href="#cb162-79" tabindex="-1"></a>    <span class="fu">scale_fill_viridis_c</span>() <span class="sc">+</span></span>
<span id="cb162-80"><a href="#cb162-80" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Joint Density f(x, y)&quot;</span>,</span>
<span id="cb162-81"><a href="#cb162-81" tabindex="-1"></a>         <span class="at">x =</span> <span class="st">&quot;y&quot;</span>,</span>
<span id="cb162-82"><a href="#cb162-82" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb162-83"><a href="#cb162-83" tabindex="-1"></a>         <span class="at">fill =</span> <span class="st">&quot;Density&quot;</span>) <span class="sc">+</span></span>
<span id="cb162-84"><a href="#cb162-84" tabindex="-1"></a>    <span class="fu">theme_minimal</span>()</span>
<span id="cb162-85"><a href="#cb162-85" tabindex="-1"></a>}</span>
<span id="cb162-86"><a href="#cb162-86" tabindex="-1"></a></span>
<span id="cb162-87"><a href="#cb162-87" tabindex="-1"></a><span class="co"># 主程序</span></span>
<span id="cb162-88"><a href="#cb162-88" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)  <span class="co"># 设置随机种子</span></span>
<span id="cb162-89"><a href="#cb162-89" tabindex="-1"></a>chain_samples <span class="ot">&lt;-</span> <span class="fu">run_chains_until_convergence</span>(num_samples, burn_in, a, b, n, chains)  <span class="co"># 运行链直到收敛</span></span></code></pre></div>
<pre><code>## 最终 \hat{R}:  1.000145 1.000238 1.000464 1.000716</code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" tabindex="-1"></a><span class="co"># 可视化生成的每条链的样本</span></span>
<span id="cb164-2"><a href="#cb164-2" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>chains) {</span>
<span id="cb164-3"><a href="#cb164-3" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="fu">paste</span>(<span class="st">&quot;链&quot;</span>, i, <span class="st">&quot;的样本可视化：</span><span class="sc">\n</span><span class="st">&quot;</span>))</span>
<span id="cb164-4"><a href="#cb164-4" tabindex="-1"></a>  <span class="fu">plot_samples</span>(chain_samples[[i]])</span>
<span id="cb164-5"><a href="#cb164-5" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 链 1 的样本可视化：</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## 链 2 的样本可视化：</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## 链 3 的样本可视化：</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<pre><code>## 链 4 的样本可视化：</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" tabindex="-1"></a><span class="co"># 可视化目标联合密度</span></span>
<span id="cb169-2"><a href="#cb169-2" tabindex="-1"></a><span class="fu">plot_joint_density</span>(a, b, n)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" tabindex="-1"></a><span class="co"># 清理内存</span></span>
<span id="cb170-2"><a href="#cb170-2" tabindex="-1"></a><span class="fu">rm</span>(chain_samples, a, b, n, num_samples, burn_in, chains)</span>
<span id="cb170-3"><a href="#cb170-3" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##           used  (Mb) gc trigger  (Mb) max used  (Mb)
## Ncells 2425244 129.6    3747821 200.2  3747821 200.2
## Vcells 4465271  34.1   10150613  77.5  8392178  64.1</code></pre>
</div>
<div id="连续情况下的-metropolis-hastings-采样器的平稳性证明" class="section level2">
<h2>连续情况下的 Metropolis-Hastings 采样器的平稳性证明</h2>
<p>要证明连续情况下的 Metropolis-Hastings (MH)
采样器的平稳性，我们需要验证目标分布 <span class="math inline">\(\pi(x)\)</span>
是马尔科夫链的平稳分布。即，若当前状态的分布为 <span class="math inline">\(\pi(x)\)</span>，则下一个状态的分布也应为 <span class="math inline">\(\pi(x)\)</span>。</p>
<p>我们用 <span class="math inline">\(p(x&#39;|x)\)</span> 表示 MH
采样器的转移核，定义为从状态 <span class="math inline">\(x\)</span>
转移到状态 <span class="math inline">\(x&#39;\)</span>
的概率。平稳性条件可以表示为：</p>
<p><span class="math display">\[
\int \pi(x) p(x&#39;|x) dx = \pi(x&#39;)
\]</span></p>
<p>MH 采样器的转移核由提议分布 <span class="math inline">\(q(x&#39;|x)\)</span> 和接受概率 <span class="math inline">\(A(x&#39;|x)\)</span> 组成：</p>
<p><span class="math display">\[
p(x&#39;|x) = q(x&#39;|x) A(x&#39;|x) + \delta(x&#39;-x) \left( 1 - \int
q(x&#39;&#39;|x) A(x&#39;&#39;|x) dx&#39;&#39; \right)
\]</span></p>
<p>其中，<span class="math inline">\(\delta(x&#39;-x)\)</span>
是狄拉克δ函数，表示如果提议被拒绝，则保持当前状态。接受概率 <span class="math inline">\(A(x&#39;|x)\)</span> 定义为：</p>
<p><span class="math display">\[
A(x&#39;|x) = \min\left(1,
\frac{\pi(x&#39;)q(x|x&#39;)}{\pi(x)q(x&#39;|x)}\right)
\]</span></p>
<p>为了证明平稳性，我们只需证明 <span class="math inline">\(\pi(x)
p(x&#39;|x)\)</span> 满足细致平衡条件：</p>
<p><span class="math display">\[
\pi(x) p(x&#39;|x) = \pi(x&#39;) p(x|x&#39;)
\]</span></p>
<p>如果细致平衡条件成立，则平稳性条件也成立。</p>
<div id="细致平衡条件证明" class="section level3">
<h3>细致平衡条件证明</h3>
<ol style="list-style-type: decimal">
<li><p><strong>情况一：</strong> 如果 <span class="math inline">\(\pi(x&#39;)q(x|x&#39;) \ge
\pi(x)q(x&#39;|x)\)</span>，则 <span class="math inline">\(A(x&#39;|x) =
1\)</span>，<span class="math inline">\(A(x|x&#39;) =
\frac{\pi(x)q(x&#39;|x)}{\pi(x&#39;)q(x|x&#39;)}\)</span>。因此：</p>
<p><span class="math display">\[
\pi(x) p(x&#39;|x) = \pi(x) q(x&#39;|x)
\]</span></p>
<p><span class="math display">\[
\pi(x&#39;) p(x|x&#39;) = \pi(x&#39;) q(x|x&#39;) A(x|x&#39;) =
\pi(x&#39;) q(x|x&#39;) \frac{\pi(x)q(x&#39;|x)}{\pi(x&#39;)q(x|x&#39;)}
= \pi(x) q(x&#39;|x)
\]</span></p>
<p>所以，<span class="math inline">\(\pi(x) p(x&#39;|x) = \pi(x&#39;)
p(x|x&#39;)\)</span>。</p></li>
<li><p><strong>情况二：</strong> 如果 <span class="math inline">\(\pi(x&#39;)q(x|x&#39;) &lt;
\pi(x)q(x&#39;|x)\)</span>，则 <span class="math inline">\(A(x&#39;|x) =
\frac{\pi(x&#39;)q(x|x&#39;)}{\pi(x)q(x&#39;|x)}\)</span>，<span class="math inline">\(A(x|x&#39;) = 1\)</span>。因此：</p>
<p><span class="math display">\[
\pi(x) p(x&#39;|x) = \pi(x) q(x&#39;|x)
\frac{\pi(x&#39;)q(x|x&#39;)}{\pi(x)q(x&#39;|x)} = \pi(x&#39;)
q(x|x&#39;)
\]</span></p>
<p><span class="math display">\[
\pi(x&#39;) p(x|x&#39;) = \pi(x&#39;) q(x|x&#39;)
\]</span></p>
<p>所以，<span class="math inline">\(\pi(x) p(x&#39;|x) = \pi(x&#39;)
p(x|x&#39;)\)</span>。</p></li>
</ol>
</div>
<div id="结论-3" class="section level3">
<h3>结论</h3>
<p>在两种情况下，细致平衡条件都成立。因此，目标分布 <span class="math inline">\(\pi(x)\)</span> 是 MH 采样器的平稳分布，这证明了
MH 采样器的平稳性。综上，我们证明了连续情况下的 Metropolis-Hastings
采样器的平稳性。这意味着如果马尔可夫链的当前状态服从目标分布 <span class="math inline">\(\pi(x)\)</span>，那么下一个状态也将服从 <span class="math inline">\(\pi(x)\)</span>，保证了采样算法的正确性。</p>
</div>
</div>
<div id="answer-7" class="section level2">
<h2>Answer 7</h2>
</div>
<div id="section-6" class="section level2">
<h2>11.3</h2>
<ol style="list-style-type: lower-alpha">
<li>编写一个函数来计算以下和式中的第 <span class="math inline">\(k\)</span> 项： <span class="math display">\[
\sum_{k=0}^{\infty} \frac{(-1)^k}{k! \, 2^k}
\frac{\|a\|^{2k+2}}{(2k+1)(2k+2)} \frac{\Gamma\left(\frac{d+1}{2}\right)
\Gamma\left(k + \frac{3}{2}\right)}{\Gamma\left(k + \frac{d}{2} +
1\right)},
\]</span> 其中 <span class="math inline">\(d \geq 1\)</span>
是一个整数， <span class="math inline">\(a\)</span> 是 <span class="math inline">\(\mathbb{R}^d\)</span> 中的一个向量，且 <span class="math inline">\(\|\cdot\|\)</span>
表示欧几里得范数。执行运算时确保系数能够被计算出来，即使 <span class="math inline">\(k\)</span> 和 <span class="math inline">\(d\)</span> 的值相当大。（对于所有 <span class="math inline">\(a \in
\mathbb{R}^d\)</span>，该级数都会收敛。）</li>
<li>修改该函数，使其计算并返回整个和的值。</li>
<li>当 <span class="math inline">\(a = (1, 2)^T\)</span>
时，求和的值。</li>
</ol>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" tabindex="-1"></a><span class="co"># 清空环境变量，释放内存</span></span>
<span id="cb172-2"><a href="#cb172-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb172-3"><a href="#cb172-3" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##           used  (Mb) gc trigger  (Mb) max used  (Mb)
## Ncells 2413820 129.0    3747821 200.2  3747821 200.2
## Vcells 4233084  32.3   10150613  77.5  8392178  64.1</code></pre>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" tabindex="-1"></a><span class="co"># 加载必要的包</span></span>
<span id="cb174-2"><a href="#cb174-2" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;pracma&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;pracma&quot;</span>)</span>
<span id="cb174-3"><a href="#cb174-3" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;gsl&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;gsl&quot;</span>)</span>
<span id="cb174-4"><a href="#cb174-4" tabindex="-1"></a><span class="fu">library</span>(pracma)  <span class="co"># 用于计算伽马函数</span></span></code></pre></div>
<pre><code>## Warning: package &#39;pracma&#39; was built under R version 4.4.2</code></pre>
<pre><code>## 
## Attaching package: &#39;pracma&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     logit</code></pre>
<pre><code>## The following object is masked from &#39;package:coin&#39;:
## 
##     size</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" tabindex="-1"></a><span class="fu">library</span>(gsl)     <span class="co"># 提供更高效的伽马函数计算</span></span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;gsl&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:pracma&#39;:
## 
##     Ci, erf, erfc, eta, expint_E1, expint_Ei, fact, hypot, psi, Si,
##     sinc, zeta</code></pre>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1" tabindex="-1"></a><span class="co"># 定义一个函数来计算第 k 项</span></span>
<span id="cb182-2"><a href="#cb182-2" tabindex="-1"></a>kth_term <span class="ot">&lt;-</span> <span class="cf">function</span>(k, a_norm, d) {</span>
<span id="cb182-3"><a href="#cb182-3" tabindex="-1"></a>  <span class="co"># 计算分子的 (-1)^k / (k! * 2^k)</span></span>
<span id="cb182-4"><a href="#cb182-4" tabindex="-1"></a>  term1 <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k <span class="sc">/</span> (<span class="fu">factorial</span>(k) <span class="sc">*</span> <span class="dv">2</span><span class="sc">^</span>k)</span>
<span id="cb182-5"><a href="#cb182-5" tabindex="-1"></a>  </span>
<span id="cb182-6"><a href="#cb182-6" tabindex="-1"></a>  <span class="co"># 计算分子的 ||a||^(2k + 2) / ((2k + 1)(2k + 2))</span></span>
<span id="cb182-7"><a href="#cb182-7" tabindex="-1"></a>  term2 <span class="ot">&lt;-</span> a_norm<span class="sc">^</span>(<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">2</span>) <span class="sc">/</span> ((<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">2</span>))</span>
<span id="cb182-8"><a href="#cb182-8" tabindex="-1"></a>  </span>
<span id="cb182-9"><a href="#cb182-9" tabindex="-1"></a>  <span class="co"># 计算伽马函数项</span></span>
<span id="cb182-10"><a href="#cb182-10" tabindex="-1"></a>  gamma_term <span class="ot">&lt;-</span> <span class="fu">gamma</span>((d <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="fu">gamma</span>(k <span class="sc">+</span> <span class="dv">3</span> <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">/</span> <span class="fu">gamma</span>(k <span class="sc">+</span> d <span class="sc">/</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb182-11"><a href="#cb182-11" tabindex="-1"></a>  </span>
<span id="cb182-12"><a href="#cb182-12" tabindex="-1"></a>  <span class="co"># 计算第 k 项的值</span></span>
<span id="cb182-13"><a href="#cb182-13" tabindex="-1"></a>  result <span class="ot">&lt;-</span> term1 <span class="sc">*</span> term2 <span class="sc">*</span> gamma_term</span>
<span id="cb182-14"><a href="#cb182-14" tabindex="-1"></a>  <span class="fu">return</span>(result)</span>
<span id="cb182-15"><a href="#cb182-15" tabindex="-1"></a>}</span>
<span id="cb182-16"><a href="#cb182-16" tabindex="-1"></a></span>
<span id="cb182-17"><a href="#cb182-17" tabindex="-1"></a><span class="co"># 定义计算整个和的函数</span></span>
<span id="cb182-18"><a href="#cb182-18" tabindex="-1"></a>compute_sum <span class="ot">&lt;-</span> <span class="cf">function</span>(a, d, <span class="at">tolerance =</span> <span class="fl">1e-10</span>, <span class="at">max_iter =</span> <span class="dv">1000</span>) {</span>
<span id="cb182-19"><a href="#cb182-19" tabindex="-1"></a>  <span class="co"># 计算向量 a 的欧几里得范数 ||a||</span></span>
<span id="cb182-20"><a href="#cb182-20" tabindex="-1"></a>  a_norm <span class="ot">&lt;-</span> <span class="fu">norm</span>(a, <span class="at">type =</span> <span class="st">&quot;2&quot;</span>)</span>
<span id="cb182-21"><a href="#cb182-21" tabindex="-1"></a>  </span>
<span id="cb182-22"><a href="#cb182-22" tabindex="-1"></a>  <span class="co"># 初始化总和</span></span>
<span id="cb182-23"><a href="#cb182-23" tabindex="-1"></a>  total_sum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb182-24"><a href="#cb182-24" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb182-25"><a href="#cb182-25" tabindex="-1"></a>  </span>
<span id="cb182-26"><a href="#cb182-26" tabindex="-1"></a>  <span class="co"># 计算逐项累加，直到项小于容忍度或达到最大迭代次数</span></span>
<span id="cb182-27"><a href="#cb182-27" tabindex="-1"></a>  <span class="cf">repeat</span> {</span>
<span id="cb182-28"><a href="#cb182-28" tabindex="-1"></a>    term <span class="ot">&lt;-</span> <span class="fu">kth_term</span>(k, a_norm, d)</span>
<span id="cb182-29"><a href="#cb182-29" tabindex="-1"></a>    total_sum <span class="ot">&lt;-</span> total_sum <span class="sc">+</span> term</span>
<span id="cb182-30"><a href="#cb182-30" tabindex="-1"></a>    </span>
<span id="cb182-31"><a href="#cb182-31" tabindex="-1"></a>    <span class="co"># 如果当前项小于容忍度，则停止</span></span>
<span id="cb182-32"><a href="#cb182-32" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(term) <span class="sc">&lt;</span> tolerance) <span class="cf">break</span></span>
<span id="cb182-33"><a href="#cb182-33" tabindex="-1"></a>    <span class="co"># 如果达到最大迭代次数，也停止</span></span>
<span id="cb182-34"><a href="#cb182-34" tabindex="-1"></a>    <span class="cf">if</span> (k <span class="sc">&gt;=</span> max_iter) {</span>
<span id="cb182-35"><a href="#cb182-35" tabindex="-1"></a>      <span class="fu">warning</span>(<span class="st">&quot;达到最大迭代次数，结果可能不准确&quot;</span>)</span>
<span id="cb182-36"><a href="#cb182-36" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb182-37"><a href="#cb182-37" tabindex="-1"></a>    }</span>
<span id="cb182-38"><a href="#cb182-38" tabindex="-1"></a>    </span>
<span id="cb182-39"><a href="#cb182-39" tabindex="-1"></a>    <span class="co"># 更新迭代计数器</span></span>
<span id="cb182-40"><a href="#cb182-40" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb182-41"><a href="#cb182-41" tabindex="-1"></a>  }</span>
<span id="cb182-42"><a href="#cb182-42" tabindex="-1"></a>  </span>
<span id="cb182-43"><a href="#cb182-43" tabindex="-1"></a>  <span class="fu">return</span>(total_sum)</span>
<span id="cb182-44"><a href="#cb182-44" tabindex="-1"></a>}</span>
<span id="cb182-45"><a href="#cb182-45" tabindex="-1"></a></span>
<span id="cb182-46"><a href="#cb182-46" tabindex="-1"></a><span class="co"># 测试程序</span></span>
<span id="cb182-47"><a href="#cb182-47" tabindex="-1"></a><span class="co"># 清空内存</span></span>
<span id="cb182-48"><a href="#cb182-48" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##           used  (Mb) gc trigger  (Mb) max used  (Mb)
## Ncells 2440625 130.4    3747821 200.2  3747821 200.2
## Vcells 4272842  32.6   10150613  77.5  8392178  64.1</code></pre>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" tabindex="-1"></a><span class="co"># (c) 当 a = (1, 2)^T 时计算和的值</span></span>
<span id="cb184-2"><a href="#cb184-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb184-3"><a href="#cb184-3" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">length</span>(a)</span>
<span id="cb184-4"><a href="#cb184-4" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">compute_sum</span>(a, d)</span>
<span id="cb184-5"><a href="#cb184-5" tabindex="-1"></a></span>
<span id="cb184-6"><a href="#cb184-6" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb184-7"><a href="#cb184-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;当 a = (1, 2)^T 时的和为:&quot;</span>, result, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 当 a = (1, 2)^T 时的和为: 1.532164</code></pre>
</div>
</div>
<div id="section-7" class="section level1">
<h1>11.5</h1>
<p>编写一个函数以求解如下方程： <span class="math display">\[
\frac{2 \Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi(k-1)}
\Gamma\left(\frac{k-1}{2}\right)} \int_{0}^{c_{k-1}} \left(1 +
\frac{u^2}{k-1}\right)^{-\frac{k}{2}} \, du = \frac{2
\Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi k}
\Gamma\left(\frac{k}{2}\right)} \int_{0}^{c_k} \left(1 +
\frac{u^2}{k}\right)^{-\frac{k+1}{2}} \, du
\]</span> 对于参数 <span class="math inline">\(a\)</span>，其中 <span class="math display">\[
c_k = \sqrt{\frac{a^2 k}{k + 1 - a^2}}
\]</span></p>
<p>将求得的解与习题 11.4 中的点 <span class="math inline">\(A(k)\)</span> 进行比较。</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" tabindex="-1"></a><span class="co"># 清空环境变量，释放内存</span></span>
<span id="cb186-2"><a href="#cb186-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb186-3"><a href="#cb186-3" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##           used  (Mb) gc trigger  (Mb) max used  (Mb)
## Ncells 2441838 130.5    3747821 200.2  3747821 200.2
## Vcells 4275773  32.7   10150613  77.5  8392178  64.1</code></pre>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" tabindex="-1"></a><span class="co"># 加载必要的包</span></span>
<span id="cb188-2"><a href="#cb188-2" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;pracma&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;pracma&quot;</span>)</span>
<span id="cb188-3"><a href="#cb188-3" tabindex="-1"></a><span class="fu">library</span>(pracma)     <span class="co"># 用于计算伽马函数</span></span>
<span id="cb188-4"><a href="#cb188-4" tabindex="-1"></a></span>
<span id="cb188-5"><a href="#cb188-5" tabindex="-1"></a><span class="co"># 定义计算积分的函数</span></span>
<span id="cb188-6"><a href="#cb188-6" tabindex="-1"></a>integrate_func <span class="ot">&lt;-</span> <span class="cf">function</span>(f, lower, upper, k) {</span>
<span id="cb188-7"><a href="#cb188-7" tabindex="-1"></a>  <span class="fu">tryCatch</span>({</span>
<span id="cb188-8"><a href="#cb188-8" tabindex="-1"></a>    <span class="co"># 使用 base R 的 integrate 函数以更好地控制积分误差</span></span>
<span id="cb188-9"><a href="#cb188-9" tabindex="-1"></a>    result <span class="ot">&lt;-</span> <span class="fu">integrate</span>(<span class="cf">function</span>(u) <span class="fu">f</span>(u, k), lower, upper)<span class="sc">$</span>value</span>
<span id="cb188-10"><a href="#cb188-10" tabindex="-1"></a>    <span class="fu">return</span>(result)</span>
<span id="cb188-11"><a href="#cb188-11" tabindex="-1"></a>  }, <span class="at">error =</span> <span class="cf">function</span>(e) {</span>
<span id="cb188-12"><a href="#cb188-12" tabindex="-1"></a>    <span class="co"># 如果积分失败，返回一个大值表示错误</span></span>
<span id="cb188-13"><a href="#cb188-13" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fl">1e10</span>)</span>
<span id="cb188-14"><a href="#cb188-14" tabindex="-1"></a>  })</span>
<span id="cb188-15"><a href="#cb188-15" tabindex="-1"></a>}</span>
<span id="cb188-16"><a href="#cb188-16" tabindex="-1"></a></span>
<span id="cb188-17"><a href="#cb188-17" tabindex="-1"></a><span class="co"># 定义方程中的积分核函数</span></span>
<span id="cb188-18"><a href="#cb188-18" tabindex="-1"></a>integrand_left <span class="ot">&lt;-</span> <span class="cf">function</span>(u, k) {</span>
<span id="cb188-19"><a href="#cb188-19" tabindex="-1"></a>  (<span class="dv">1</span> <span class="sc">+</span> u<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (k <span class="sc">-</span> <span class="dv">1</span>))<span class="sc">^</span>(<span class="sc">-</span>k <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb188-20"><a href="#cb188-20" tabindex="-1"></a>}</span>
<span id="cb188-21"><a href="#cb188-21" tabindex="-1"></a></span>
<span id="cb188-22"><a href="#cb188-22" tabindex="-1"></a>integrand_right <span class="ot">&lt;-</span> <span class="cf">function</span>(u, k) {</span>
<span id="cb188-23"><a href="#cb188-23" tabindex="-1"></a>  (<span class="dv">1</span> <span class="sc">+</span> u<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> k)<span class="sc">^</span>(<span class="sc">-</span>(k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb188-24"><a href="#cb188-24" tabindex="-1"></a>}</span>
<span id="cb188-25"><a href="#cb188-25" tabindex="-1"></a></span>
<span id="cb188-26"><a href="#cb188-26" tabindex="-1"></a><span class="co"># 定义函数来求解方程</span></span>
<span id="cb188-27"><a href="#cb188-27" tabindex="-1"></a>solve_for_a <span class="ot">&lt;-</span> <span class="cf">function</span>(k, <span class="at">tolerance =</span> <span class="fl">1e-6</span>, <span class="at">max_iter =</span> <span class="dv">100</span>) {</span>
<span id="cb188-28"><a href="#cb188-28" tabindex="-1"></a>  <span class="co"># 伽马函数项</span></span>
<span id="cb188-29"><a href="#cb188-29" tabindex="-1"></a>  gamma_left <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">gamma</span>(k <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">/</span> (<span class="fu">sqrt</span>(pi <span class="sc">*</span> (k <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">*</span> <span class="fu">gamma</span>((k <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>))</span>
<span id="cb188-30"><a href="#cb188-30" tabindex="-1"></a>  gamma_right <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">gamma</span>((k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">/</span> (<span class="fu">sqrt</span>(pi <span class="sc">*</span> k) <span class="sc">*</span> <span class="fu">gamma</span>(k <span class="sc">/</span> <span class="dv">2</span>))</span>
<span id="cb188-31"><a href="#cb188-31" tabindex="-1"></a>  </span>
<span id="cb188-32"><a href="#cb188-32" tabindex="-1"></a>  <span class="co"># 定义误差函数，用于优化求解 a</span></span>
<span id="cb188-33"><a href="#cb188-33" tabindex="-1"></a>  error_func <span class="ot">&lt;-</span> <span class="cf">function</span>(a) {</span>
<span id="cb188-34"><a href="#cb188-34" tabindex="-1"></a>    <span class="co"># 确保 a 的范围有效，避免出现分母为零的情况</span></span>
<span id="cb188-35"><a href="#cb188-35" tabindex="-1"></a>    <span class="cf">if</span> (a<span class="sc">^</span><span class="dv">2</span> <span class="sc">&gt;=</span> k <span class="sc">||</span> a<span class="sc">^</span><span class="dv">2</span> <span class="sc">&gt;=</span> k <span class="sc">+</span> <span class="dv">1</span>) <span class="fu">return</span>(<span class="fl">1e10</span>)</span>
<span id="cb188-36"><a href="#cb188-36" tabindex="-1"></a>    </span>
<span id="cb188-37"><a href="#cb188-37" tabindex="-1"></a>    <span class="co"># 计算 c_k 和 c_{k-1}，并检查是否接近无效的情况</span></span>
<span id="cb188-38"><a href="#cb188-38" tabindex="-1"></a>    denominator_k_minus1 <span class="ot">&lt;-</span> k <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb188-39"><a href="#cb188-39" tabindex="-1"></a>    denominator_k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb188-40"><a href="#cb188-40" tabindex="-1"></a>    <span class="cf">if</span> (denominator_k_minus1 <span class="sc">&lt;=</span> <span class="dv">0</span> <span class="sc">||</span> denominator_k <span class="sc">&lt;=</span> <span class="dv">0</span>) {</span>
<span id="cb188-41"><a href="#cb188-41" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fl">1e10</span>)  <span class="co"># 返回大值表示错误</span></span>
<span id="cb188-42"><a href="#cb188-42" tabindex="-1"></a>    }</span>
<span id="cb188-43"><a href="#cb188-43" tabindex="-1"></a>    </span>
<span id="cb188-44"><a href="#cb188-44" tabindex="-1"></a>    c_k_minus1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (k <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> denominator_k_minus1)</span>
<span id="cb188-45"><a href="#cb188-45" tabindex="-1"></a>    c_k <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> k <span class="sc">/</span> denominator_k)</span>
<span id="cb188-46"><a href="#cb188-46" tabindex="-1"></a>    </span>
<span id="cb188-47"><a href="#cb188-47" tabindex="-1"></a>    <span class="co"># 动态设置积分上限</span></span>
<span id="cb188-48"><a href="#cb188-48" tabindex="-1"></a>    max_limit <span class="ot">&lt;-</span> <span class="fu">min</span>(<span class="fu">sqrt</span>(k) <span class="sc">*</span> <span class="dv">10</span>, <span class="fl">1e3</span>)</span>
<span id="cb188-49"><a href="#cb188-49" tabindex="-1"></a>    <span class="cf">if</span> (c_k_minus1 <span class="sc">&gt;</span> max_limit <span class="sc">||</span> c_k <span class="sc">&gt;</span> max_limit) {</span>
<span id="cb188-50"><a href="#cb188-50" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fl">1e10</span>)  <span class="co"># 返回大值以跳过这个计算</span></span>
<span id="cb188-51"><a href="#cb188-51" tabindex="-1"></a>    }</span>
<span id="cb188-52"><a href="#cb188-52" tabindex="-1"></a>    </span>
<span id="cb188-53"><a href="#cb188-53" tabindex="-1"></a>    <span class="co"># 计算左侧积分和右侧积分</span></span>
<span id="cb188-54"><a href="#cb188-54" tabindex="-1"></a>    integral_left <span class="ot">&lt;-</span> <span class="fu">integrate_func</span>(integrand_left, <span class="dv">0</span>, c_k_minus1, k)</span>
<span id="cb188-55"><a href="#cb188-55" tabindex="-1"></a>    integral_right <span class="ot">&lt;-</span> <span class="fu">integrate_func</span>(integrand_right, <span class="dv">0</span>, c_k, k)</span>
<span id="cb188-56"><a href="#cb188-56" tabindex="-1"></a>    </span>
<span id="cb188-57"><a href="#cb188-57" tabindex="-1"></a>    <span class="co"># 检查是否为有效数值，主动将 NA/Inf 替换为大值</span></span>
<span id="cb188-58"><a href="#cb188-58" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.finite</span>(integral_left) <span class="sc">||</span> <span class="sc">!</span><span class="fu">is.finite</span>(integral_right) <span class="sc">||</span> <span class="fu">is.nan</span>(integral_left) <span class="sc">||</span> <span class="fu">is.nan</span>(integral_right)) {</span>
<span id="cb188-59"><a href="#cb188-59" tabindex="-1"></a>      <span class="fu">return</span>(<span class="fl">1e10</span>)  <span class="co"># 主动返回一个大值</span></span>
<span id="cb188-60"><a href="#cb188-60" tabindex="-1"></a>    }</span>
<span id="cb188-61"><a href="#cb188-61" tabindex="-1"></a>    </span>
<span id="cb188-62"><a href="#cb188-62" tabindex="-1"></a>    <span class="co"># 计算误差</span></span>
<span id="cb188-63"><a href="#cb188-63" tabindex="-1"></a>    error_value <span class="ot">&lt;-</span> <span class="fu">abs</span>(gamma_left <span class="sc">*</span> integral_left <span class="sc">-</span> gamma_right <span class="sc">*</span> integral_right)</span>
<span id="cb188-64"><a href="#cb188-64" tabindex="-1"></a>    <span class="fu">return</span>(error_value)</span>
<span id="cb188-65"><a href="#cb188-65" tabindex="-1"></a>  }</span>
<span id="cb188-66"><a href="#cb188-66" tabindex="-1"></a>  </span>
<span id="cb188-67"><a href="#cb188-67" tabindex="-1"></a>  <span class="co"># 使用 suppressWarnings 包裹 optimize 以隐藏警告</span></span>
<span id="cb188-68"><a href="#cb188-68" tabindex="-1"></a>  result <span class="ot">&lt;-</span> <span class="fu">suppressWarnings</span>(<span class="fu">optimize</span>(error_func, <span class="at">interval =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fu">sqrt</span>(k) <span class="sc">-</span> <span class="dv">1</span>), <span class="at">tol =</span> tolerance))</span>
<span id="cb188-69"><a href="#cb188-69" tabindex="-1"></a>  <span class="fu">return</span>(result<span class="sc">$</span>minimum)</span>
<span id="cb188-70"><a href="#cb188-70" tabindex="-1"></a>}</span>
<span id="cb188-71"><a href="#cb188-71" tabindex="-1"></a></span>
<span id="cb188-72"><a href="#cb188-72" tabindex="-1"></a><span class="co"># 计算 A(k) 的点，进行比较</span></span>
<span id="cb188-73"><a href="#cb188-73" tabindex="-1"></a>compute_A_k <span class="ot">&lt;-</span> <span class="cf">function</span>(k) {</span>
<span id="cb188-74"><a href="#cb188-74" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sqrt</span>(k))</span>
<span id="cb188-75"><a href="#cb188-75" tabindex="-1"></a>}</span>
<span id="cb188-76"><a href="#cb188-76" tabindex="-1"></a></span>
<span id="cb188-77"><a href="#cb188-77" tabindex="-1"></a><span class="co"># 主函数，运行求解并比较结果</span></span>
<span id="cb188-78"><a href="#cb188-78" tabindex="-1"></a>main <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb188-79"><a href="#cb188-79" tabindex="-1"></a>  <span class="co"># 设置参数 k 的值</span></span>
<span id="cb188-80"><a href="#cb188-80" tabindex="-1"></a>  k_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb188-81"><a href="#cb188-81" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">k =</span> <span class="fu">integer</span>(), <span class="at">a =</span> <span class="fu">numeric</span>(), <span class="at">A_k =</span> <span class="fu">numeric</span>())</span>
<span id="cb188-82"><a href="#cb188-82" tabindex="-1"></a>  </span>
<span id="cb188-83"><a href="#cb188-83" tabindex="-1"></a>  <span class="cf">for</span> (k <span class="cf">in</span> k_values) {</span>
<span id="cb188-84"><a href="#cb188-84" tabindex="-1"></a>    <span class="co"># 求解 a 的值</span></span>
<span id="cb188-85"><a href="#cb188-85" tabindex="-1"></a>    a <span class="ot">&lt;-</span> <span class="fu">solve_for_a</span>(k)</span>
<span id="cb188-86"><a href="#cb188-86" tabindex="-1"></a>    </span>
<span id="cb188-87"><a href="#cb188-87" tabindex="-1"></a>    <span class="co"># 计算 A(k)</span></span>
<span id="cb188-88"><a href="#cb188-88" tabindex="-1"></a>    A_k <span class="ot">&lt;-</span> <span class="fu">compute_A_k</span>(k)</span>
<span id="cb188-89"><a href="#cb188-89" tabindex="-1"></a>    </span>
<span id="cb188-90"><a href="#cb188-90" tabindex="-1"></a>    <span class="co"># 存储结果</span></span>
<span id="cb188-91"><a href="#cb188-91" tabindex="-1"></a>    results <span class="ot">&lt;-</span> <span class="fu">rbind</span>(results, <span class="fu">data.frame</span>(<span class="at">k =</span> k, <span class="at">a =</span> a, <span class="at">A_k =</span> A_k))</span>
<span id="cb188-92"><a href="#cb188-92" tabindex="-1"></a>  }</span>
<span id="cb188-93"><a href="#cb188-93" tabindex="-1"></a>  </span>
<span id="cb188-94"><a href="#cb188-94" tabindex="-1"></a>  <span class="co"># 输出结果</span></span>
<span id="cb188-95"><a href="#cb188-95" tabindex="-1"></a>  <span class="fu">print</span>(results)</span>
<span id="cb188-96"><a href="#cb188-96" tabindex="-1"></a>  </span>
<span id="cb188-97"><a href="#cb188-97" tabindex="-1"></a>  <span class="co"># 清空内存</span></span>
<span id="cb188-98"><a href="#cb188-98" tabindex="-1"></a>  <span class="fu">gc</span>()</span>
<span id="cb188-99"><a href="#cb188-99" tabindex="-1"></a>}</span>
<span id="cb188-100"><a href="#cb188-100" tabindex="-1"></a></span>
<span id="cb188-101"><a href="#cb188-101" tabindex="-1"></a><span class="co"># 运行主函数</span></span>
<span id="cb188-102"><a href="#cb188-102" tabindex="-1"></a><span class="fu">main</span>()</span></code></pre></div>
<pre><code>##      k          a      A_k
## 1    4  0.2000004  2.00000
## 2   25  1.6873465  5.00000
## 3  100  6.3624654 10.00000
## 4  500 21.3606788 22.36068
## 5 1000 30.6227751 31.62278</code></pre>
<pre><code>##           used  (Mb) gc trigger  (Mb) max used  (Mb)
## Ncells 2442809 130.5    3747821 200.2  3747821 200.2
## Vcells 4278977  32.7   10150613  77.5  8392178  64.1</code></pre>
<ul>
<li><p>假设 <span class="math inline">\(T_1, \ldots, T_n\)</span>
是从具有期望值为 <span class="math inline">\(\lambda\)</span>
的指数分布中抽取的独立同分布样本。由于右删失，超过阈值 <span class="math inline">\(\tau\)</span> 的值无法观察到，因此观察到的值为
<span class="math display">\[
Y_i = T_i \mathbb{I}(T_i \leq \tau) + \tau \mathbb{I}(T_i &gt; \tau),
\quad i = 1, \ldots, n。
\]</span> 假设 <span class="math inline">\(\tau =
1\)</span>，并且观察到的 <span class="math inline">\(Y_i\)</span>
值如下：</p>
<p><span class="math display">\[
0.54, 0.48, 0.33, 0.43, 1.00, 0.91, 1.00, 0.21, 0.85
\]</span></p></li>
<li><p>使用 EM 算法来估计 <span class="math inline">\(\lambda\)</span>，并将结果与观测数据的最大似然估计（MLE）进行比较（注意：<span class="math inline">\(Y_i\)</span> 遵循一个混合分布）。</p></li>
</ul>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" tabindex="-1"></a><span class="co"># 清理内存并设置环境</span></span>
<span id="cb191-2"><a href="#cb191-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>()) <span class="co"># 清空所有内存</span></span>
<span id="cb191-3"><a href="#cb191-3" tabindex="-1"></a><span class="fu">gc</span>()            <span class="co"># 垃圾回收</span></span></code></pre></div>
<pre><code>##           used  (Mb) gc trigger  (Mb) max used  (Mb)
## Ncells 2442813 130.5    3747821 200.2  3747821 200.2
## Vcells 4279105  32.7   10150613  77.5  8392178  64.1</code></pre>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" tabindex="-1"></a><span class="co"># 检查和安装所需的包</span></span>
<span id="cb193-2"><a href="#cb193-2" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(<span class="st">&quot;stats&quot;</span>)) <span class="fu">install.packages</span>(<span class="st">&quot;stats&quot;</span>)</span>
<span id="cb193-3"><a href="#cb193-3" tabindex="-1"></a></span>
<span id="cb193-4"><a href="#cb193-4" tabindex="-1"></a><span class="co"># 定义 EM 算法的函数</span></span>
<span id="cb193-5"><a href="#cb193-5" tabindex="-1"></a>em_algorithm <span class="ot">&lt;-</span> <span class="cf">function</span>(observed_data, tau, <span class="at">max_iter =</span> <span class="dv">1000</span>, <span class="at">tol =</span> <span class="fl">1e-6</span>) {</span>
<span id="cb193-6"><a href="#cb193-6" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(observed_data)</span>
<span id="cb193-7"><a href="#cb193-7" tabindex="-1"></a>  <span class="co"># 初始估计的 lambda</span></span>
<span id="cb193-8"><a href="#cb193-8" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(observed_data) </span>
<span id="cb193-9"><a href="#cb193-9" tabindex="-1"></a>  </span>
<span id="cb193-10"><a href="#cb193-10" tabindex="-1"></a>  <span class="co"># EM 迭代</span></span>
<span id="cb193-11"><a href="#cb193-11" tabindex="-1"></a>  <span class="cf">for</span> (iter <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb193-12"><a href="#cb193-12" tabindex="-1"></a>    <span class="co"># E 步：计算每个观测值的 &quot;未观测部分&quot; 的期望</span></span>
<span id="cb193-13"><a href="#cb193-13" tabindex="-1"></a>    expected_values <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(observed_data <span class="sc">&lt;</span> tau, observed_data, </span>
<span id="cb193-14"><a href="#cb193-14" tabindex="-1"></a>                              tau <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> lambda)</span>
<span id="cb193-15"><a href="#cb193-15" tabindex="-1"></a>    </span>
<span id="cb193-16"><a href="#cb193-16" tabindex="-1"></a>    <span class="co"># M 步：使用期望值更新 lambda</span></span>
<span id="cb193-17"><a href="#cb193-17" tabindex="-1"></a>    new_lambda <span class="ot">&lt;-</span> n <span class="sc">/</span> <span class="fu">sum</span>(expected_values)</span>
<span id="cb193-18"><a href="#cb193-18" tabindex="-1"></a>    </span>
<span id="cb193-19"><a href="#cb193-19" tabindex="-1"></a>    <span class="co"># 检查收敛</span></span>
<span id="cb193-20"><a href="#cb193-20" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(new_lambda <span class="sc">-</span> lambda) <span class="sc">&lt;</span> tol) {</span>
<span id="cb193-21"><a href="#cb193-21" tabindex="-1"></a>      lambda <span class="ot">&lt;-</span> new_lambda</span>
<span id="cb193-22"><a href="#cb193-22" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb193-23"><a href="#cb193-23" tabindex="-1"></a>    }</span>
<span id="cb193-24"><a href="#cb193-24" tabindex="-1"></a>    </span>
<span id="cb193-25"><a href="#cb193-25" tabindex="-1"></a>    <span class="co"># 更新 lambda</span></span>
<span id="cb193-26"><a href="#cb193-26" tabindex="-1"></a>    lambda <span class="ot">&lt;-</span> new_lambda</span>
<span id="cb193-27"><a href="#cb193-27" tabindex="-1"></a>  }</span>
<span id="cb193-28"><a href="#cb193-28" tabindex="-1"></a>  </span>
<span id="cb193-29"><a href="#cb193-29" tabindex="-1"></a>  <span class="fu">return</span>(lambda)</span>
<span id="cb193-30"><a href="#cb193-30" tabindex="-1"></a>}</span>
<span id="cb193-31"><a href="#cb193-31" tabindex="-1"></a></span>
<span id="cb193-32"><a href="#cb193-32" tabindex="-1"></a><span class="co"># 定义最大似然估计（MLE）的函数</span></span>
<span id="cb193-33"><a href="#cb193-33" tabindex="-1"></a>mle_estimate <span class="ot">&lt;-</span> <span class="cf">function</span>(observed_data) {</span>
<span id="cb193-34"><a href="#cb193-34" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(observed_data)) <span class="co"># MLE for lambda based on observed data</span></span>
<span id="cb193-35"><a href="#cb193-35" tabindex="-1"></a>}</span>
<span id="cb193-36"><a href="#cb193-36" tabindex="-1"></a></span>
<span id="cb193-37"><a href="#cb193-37" tabindex="-1"></a><span class="co"># 观测数据和参数</span></span>
<span id="cb193-38"><a href="#cb193-38" tabindex="-1"></a>observed_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb193-39"><a href="#cb193-39" tabindex="-1"></a>tau <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb193-40"><a href="#cb193-40" tabindex="-1"></a></span>
<span id="cb193-41"><a href="#cb193-41" tabindex="-1"></a><span class="co"># 使用 EM 算法估计 lambda</span></span>
<span id="cb193-42"><a href="#cb193-42" tabindex="-1"></a>lambda_em <span class="ot">&lt;-</span> <span class="fu">em_algorithm</span>(observed_data, tau)</span>
<span id="cb193-43"><a href="#cb193-43" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;EM 算法估计的 lambda 值：&quot;</span>, lambda_em, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## EM 算法估计的 lambda 值： 1.217391</code></pre>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" tabindex="-1"></a><span class="co"># 计算 MLE 估计</span></span>
<span id="cb195-2"><a href="#cb195-2" tabindex="-1"></a>lambda_mle <span class="ot">&lt;-</span> <span class="fu">mle_estimate</span>(observed_data)</span>
<span id="cb195-3"><a href="#cb195-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;基于观测数据的 MLE 估计的 lambda 值：&quot;</span>, lambda_mle, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 基于观测数据的 MLE 估计的 lambda 值： 1.565217</code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" tabindex="-1"></a><span class="co"># 再次清空内存以确保资源释放</span></span>
<span id="cb197-2"><a href="#cb197-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb197-3"><a href="#cb197-3" tabindex="-1"></a><span class="fu">gc</span>() <span class="co"># 垃圾回收</span></span></code></pre></div>
<pre><code>##           used  (Mb) gc trigger  (Mb) max used  (Mb)
## Ncells 2442947 130.5    3747821 200.2  3747821 200.2
## Vcells 4279480  32.7   10150613  77.5  8392178  64.1</code></pre>
<div id="answer-8" class="section level2">
<h2>Answer 8</h2>
</div>
<div id="section-8" class="section level2">
<h2>11.7</h2>
<p>Use the simplex algorithm to solve the following problem.</p>
<p><span class="math display">\[\text{min}\ 4x + 2y + 9z \]</span></p>
<p>subject to: <span class="math display">\[
2x + y + z \leq 2
\]</span> <span class="math display">\[
x - y + 3z \leq 3
\]</span> <span class="math display">\[
x \geq 0, \, y \geq 0, \, z \geq 0
\]</span></p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" tabindex="-1"></a><span class="co"># 加载 lpSolve 包</span></span>
<span id="cb199-2"><a href="#cb199-2" tabindex="-1"></a><span class="fu">library</span>(lpSolve)</span></code></pre></div>
<pre><code>## Warning: package &#39;lpSolve&#39; was built under R version 4.4.2</code></pre>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" tabindex="-1"></a><span class="co"># 定义目标函数的系数</span></span>
<span id="cb201-2"><a href="#cb201-2" tabindex="-1"></a>objective <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">9</span>)  <span class="co"># 对应于 4x + 2y + 9z</span></span>
<span id="cb201-3"><a href="#cb201-3" tabindex="-1"></a></span>
<span id="cb201-4"><a href="#cb201-4" tabindex="-1"></a><span class="co"># 定义约束矩阵</span></span>
<span id="cb201-5"><a href="#cb201-5" tabindex="-1"></a>constraints <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">1</span>,   <span class="co"># 2x + y + z</span></span>
<span id="cb201-6"><a href="#cb201-6" tabindex="-1"></a>                        <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="dv">3</span>), <span class="co"># x - y + 3z</span></span>
<span id="cb201-7"><a href="#cb201-7" tabindex="-1"></a>                      <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb201-8"><a href="#cb201-8" tabindex="-1"></a></span>
<span id="cb201-9"><a href="#cb201-9" tabindex="-1"></a><span class="co"># 定义约束右侧的值</span></span>
<span id="cb201-10"><a href="#cb201-10" tabindex="-1"></a>rhs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)  <span class="co"># 右侧的约束值</span></span>
<span id="cb201-11"><a href="#cb201-11" tabindex="-1"></a></span>
<span id="cb201-12"><a href="#cb201-12" tabindex="-1"></a><span class="co"># 定义约束方向</span></span>
<span id="cb201-13"><a href="#cb201-13" tabindex="-1"></a>directions <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;&lt;=&quot;</span>, <span class="st">&quot;&lt;=&quot;</span>)</span>
<span id="cb201-14"><a href="#cb201-14" tabindex="-1"></a></span>
<span id="cb201-15"><a href="#cb201-15" tabindex="-1"></a><span class="co"># 使用 lp 函数求解最小化问题</span></span>
<span id="cb201-16"><a href="#cb201-16" tabindex="-1"></a>solution <span class="ot">&lt;-</span> <span class="fu">lp</span>(<span class="at">direction =</span> <span class="st">&quot;min&quot;</span>,      <span class="co"># 指定为最小化问题</span></span>
<span id="cb201-17"><a href="#cb201-17" tabindex="-1"></a>               <span class="at">objective.in =</span> objective, <span class="co"># 目标函数</span></span>
<span id="cb201-18"><a href="#cb201-18" tabindex="-1"></a>               <span class="at">const.mat =</span> constraints,  <span class="co"># 约束矩阵</span></span>
<span id="cb201-19"><a href="#cb201-19" tabindex="-1"></a>               <span class="at">const.dir =</span> directions,   <span class="co"># 约束方向</span></span>
<span id="cb201-20"><a href="#cb201-20" tabindex="-1"></a>               <span class="at">const.rhs =</span> rhs,          <span class="co"># 约束右侧值</span></span>
<span id="cb201-21"><a href="#cb201-21" tabindex="-1"></a>               <span class="at">all.int =</span> <span class="cn">FALSE</span>)          <span class="co"># 变量可以是连续的</span></span>
<span id="cb201-22"><a href="#cb201-22" tabindex="-1"></a></span>
<span id="cb201-23"><a href="#cb201-23" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb201-24"><a href="#cb201-24" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;目标函数的最小值：&quot;</span>, solution<span class="sc">$</span>objval, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 目标函数的最小值： 0</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;对应的变量值：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 对应的变量值：</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;x =&quot;</span>, solution<span class="sc">$</span>solution[<span class="dv">1</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## x = 0</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;y =&quot;</span>, solution<span class="sc">$</span>solution[<span class="dv">2</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## y = 0</code></pre>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;z =&quot;</span>, solution<span class="sc">$</span>solution[<span class="dv">3</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## z = 0</code></pre>
</div>
<div id="section-9" class="section level2">
<h2>3</h2>
<p>使用 for 循环和 lapply() 对 mtcars
数据集进行线性模型拟合，使用存储在以下列表中的公式：</p>
<p>formulas &lt;- list(<br />
mpg ~ disp,<br />
mpg ~ I(1 / disp),<br />
mpg ~ disp + wt,<br />
mpg ~ I(1 / disp) + wt<br />
)</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" tabindex="-1"></a><span class="co"># 加载 mtcars 数据集</span></span>
<span id="cb211-2"><a href="#cb211-2" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb211-3"><a href="#cb211-3" tabindex="-1"></a></span>
<span id="cb211-4"><a href="#cb211-4" tabindex="-1"></a><span class="co"># 定义公式列表</span></span>
<span id="cb211-5"><a href="#cb211-5" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb211-6"><a href="#cb211-6" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb211-7"><a href="#cb211-7" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb211-8"><a href="#cb211-8" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb211-9"><a href="#cb211-9" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb211-10"><a href="#cb211-10" tabindex="-1"></a>)</span>
<span id="cb211-11"><a href="#cb211-11" tabindex="-1"></a></span>
<span id="cb211-12"><a href="#cb211-12" tabindex="-1"></a><span class="co"># 方法一：使用 for 循环拟合模型</span></span>
<span id="cb211-13"><a href="#cb211-13" tabindex="-1"></a>models_for <span class="ot">&lt;-</span> <span class="fu">list</span>()  <span class="co"># 用于存储模型结果</span></span>
<span id="cb211-14"><a href="#cb211-14" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(formulas)) {</span>
<span id="cb211-15"><a href="#cb211-15" tabindex="-1"></a>  models_for[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(formulas[[i]], <span class="at">data =</span> mtcars)</span>
<span id="cb211-16"><a href="#cb211-16" tabindex="-1"></a>}</span>
<span id="cb211-17"><a href="#cb211-17" tabindex="-1"></a></span>
<span id="cb211-18"><a href="#cb211-18" tabindex="-1"></a><span class="co"># 打印 for 循环拟合的模型结果摘要</span></span>
<span id="cb211-19"><a href="#cb211-19" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;For 循环拟合结果摘要：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## For 循环拟合结果摘要：</code></pre>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(models_for)) {</span>
<span id="cb213-2"><a href="#cb213-2" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">summary</span>(models_for[[i]]))</span>
<span id="cb213-3"><a href="#cb213-3" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.8922 -2.2022 -0.9631  1.6272  7.2305 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 29.599855   1.229720  24.070  &lt; 2e-16 ***
## disp        -0.041215   0.004712  -8.747 9.38e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.251 on 30 degrees of freedom
## Multiple R-squared:  0.7183, Adjusted R-squared:  0.709 
## F-statistic: 76.51 on 1 and 30 DF,  p-value: 9.38e-10
## 
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.7383 -1.8216 -0.0751  1.0487  4.6105 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   10.7520     0.7994   13.45 3.06e-14 ***
## I(1/disp)   1557.6739   114.8935   13.56 2.49e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.295 on 30 degrees of freedom
## Multiple R-squared:  0.8597, Adjusted R-squared:  0.855 
## F-statistic: 183.8 on 1 and 30 DF,  p-value: 2.494e-14
## 
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.4087 -2.3243 -0.7683  1.7721  6.3484 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 34.96055    2.16454  16.151 4.91e-16 ***
## disp        -0.01773    0.00919  -1.929  0.06362 .  
## wt          -3.35082    1.16413  -2.878  0.00743 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.917 on 29 degrees of freedom
## Multiple R-squared:  0.7809, Adjusted R-squared:  0.7658 
## F-statistic: 51.69 on 2 and 29 DF,  p-value: 2.744e-10
## 
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.7085 -1.5121 -0.6191  1.5142  4.2314 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   19.0242     3.4520   5.511 6.13e-06 ***
## I(1/disp)   1142.5600   199.8427   5.717 3.47e-06 ***
## wt            -1.7976     0.7327  -2.453   0.0204 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.124 on 29 degrees of freedom
## Multiple R-squared:  0.8838, Adjusted R-squared:  0.8758 
## F-statistic: 110.3 on 2 and 29 DF,  p-value: 2.788e-14</code></pre>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" tabindex="-1"></a><span class="co"># 方法二：使用 lapply() 拟合模型</span></span>
<span id="cb215-2"><a href="#cb215-2" tabindex="-1"></a>models_lapply <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, <span class="cf">function</span>(f) <span class="fu">lm</span>(f, <span class="at">data =</span> mtcars))</span>
<span id="cb215-3"><a href="#cb215-3" tabindex="-1"></a></span>
<span id="cb215-4"><a href="#cb215-4" tabindex="-1"></a><span class="co"># 打印 lapply() 拟合的模型结果摘要</span></span>
<span id="cb215-5"><a href="#cb215-5" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">lapply() 拟合结果摘要：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## lapply() 拟合结果摘要：</code></pre>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" tabindex="-1"></a><span class="fu">lapply</span>(models_lapply, summary)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = f, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.8922 -2.2022 -0.9631  1.6272  7.2305 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 29.599855   1.229720  24.070  &lt; 2e-16 ***
## disp        -0.041215   0.004712  -8.747 9.38e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.251 on 30 degrees of freedom
## Multiple R-squared:  0.7183, Adjusted R-squared:  0.709 
## F-statistic: 76.51 on 1 and 30 DF,  p-value: 9.38e-10
## 
## 
## [[2]]
## 
## Call:
## lm(formula = f, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.7383 -1.8216 -0.0751  1.0487  4.6105 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   10.7520     0.7994   13.45 3.06e-14 ***
## I(1/disp)   1557.6739   114.8935   13.56 2.49e-14 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.295 on 30 degrees of freedom
## Multiple R-squared:  0.8597, Adjusted R-squared:  0.855 
## F-statistic: 183.8 on 1 and 30 DF,  p-value: 2.494e-14
## 
## 
## [[3]]
## 
## Call:
## lm(formula = f, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.4087 -2.3243 -0.7683  1.7721  6.3484 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 34.96055    2.16454  16.151 4.91e-16 ***
## disp        -0.01773    0.00919  -1.929  0.06362 .  
## wt          -3.35082    1.16413  -2.878  0.00743 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.917 on 29 degrees of freedom
## Multiple R-squared:  0.7809, Adjusted R-squared:  0.7658 
## F-statistic: 51.69 on 2 and 29 DF,  p-value: 2.744e-10
## 
## 
## [[4]]
## 
## Call:
## lm(formula = f, data = mtcars)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -2.7085 -1.5121 -0.6191  1.5142  4.2314 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   19.0242     3.4520   5.511 6.13e-06 ***
## I(1/disp)   1142.5600   199.8427   5.717 3.47e-06 ***
## wt            -1.7976     0.7327  -2.453   0.0204 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 2.124 on 29 degrees of freedom
## Multiple R-squared:  0.8838, Adjusted R-squared:  0.8758 
## F-statistic: 110.3 on 2 and 29 DF,  p-value: 2.788e-14</code></pre>
</div>
</div>
<div id="section-10" class="section level1">
<h1>4</h1>
<ol start="4" style="list-style-type: decimal">
<li>将模型 <strong>mpg ~ disp</strong> 拟合到下面列表中的 <strong>mtcars
数据集的自助法重采样（bootstrap replicates）</strong> 上，分别使用
<strong>for 循环</strong> 和 <strong>lapply()</strong> 完成。<br />
你能在不用匿名函数的情况下完成吗？</li>
</ol>
<p>bootstraps &lt;- lapply(1:10, function(i) {<br />
rows &lt;- sample(1:nrow(mtcars), rep = TRUE)<br />
mtcars[rows, ]<br />
})</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" tabindex="-1"></a><span class="co"># 清空环境变量以节约内存</span></span>
<span id="cb219-2"><a href="#cb219-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb219-3"><a href="#cb219-3" tabindex="-1"></a></span>
<span id="cb219-4"><a href="#cb219-4" tabindex="-1"></a><span class="co"># 加载数据集</span></span>
<span id="cb219-5"><a href="#cb219-5" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb219-6"><a href="#cb219-6" tabindex="-1"></a></span>
<span id="cb219-7"><a href="#cb219-7" tabindex="-1"></a><span class="co"># 定义函数：生成 Bootstrap 数据集</span></span>
<span id="cb219-8"><a href="#cb219-8" tabindex="-1"></a>generate_bootstrap <span class="ot">&lt;-</span> <span class="cf">function</span>(data, n) {</span>
<span id="cb219-9"><a href="#cb219-9" tabindex="-1"></a>  <span class="co"># 创建 n 个 bootstrap 样本</span></span>
<span id="cb219-10"><a href="#cb219-10" tabindex="-1"></a>  <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="cf">function</span>(i) {</span>
<span id="cb219-11"><a href="#cb219-11" tabindex="-1"></a>    rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data), <span class="at">size =</span> <span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb219-12"><a href="#cb219-12" tabindex="-1"></a>    data[rows, ]</span>
<span id="cb219-13"><a href="#cb219-13" tabindex="-1"></a>  })</span>
<span id="cb219-14"><a href="#cb219-14" tabindex="-1"></a>}</span>
<span id="cb219-15"><a href="#cb219-15" tabindex="-1"></a></span>
<span id="cb219-16"><a href="#cb219-16" tabindex="-1"></a><span class="co"># 定义函数：拟合线性模型</span></span>
<span id="cb219-17"><a href="#cb219-17" tabindex="-1"></a>fit_model <span class="ot">&lt;-</span> <span class="cf">function</span>(data_list, formula) {</span>
<span id="cb219-18"><a href="#cb219-18" tabindex="-1"></a>  <span class="co"># 针对每个数据子集拟合模型</span></span>
<span id="cb219-19"><a href="#cb219-19" tabindex="-1"></a>  <span class="fu">lapply</span>(data_list, <span class="cf">function</span>(sub_data) <span class="fu">lm</span>(formula, <span class="at">data =</span> sub_data))</span>
<span id="cb219-20"><a href="#cb219-20" tabindex="-1"></a>}</span>
<span id="cb219-21"><a href="#cb219-21" tabindex="-1"></a></span>
<span id="cb219-22"><a href="#cb219-22" tabindex="-1"></a><span class="co"># 定义函数：清理内存</span></span>
<span id="cb219-23"><a href="#cb219-23" tabindex="-1"></a>clean_memory <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb219-24"><a href="#cb219-24" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb219-25"><a href="#cb219-25" tabindex="-1"></a>  <span class="fu">gc</span>()  <span class="co"># 强制垃圾回收</span></span>
<span id="cb219-26"><a href="#cb219-26" tabindex="-1"></a>}</span>
<span id="cb219-27"><a href="#cb219-27" tabindex="-1"></a></span>
<span id="cb219-28"><a href="#cb219-28" tabindex="-1"></a><span class="co"># 步骤 1：生成 10 个 Bootstrap 样本</span></span>
<span id="cb219-29"><a href="#cb219-29" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">generate_bootstrap</span>(mtcars, <span class="dv">10</span>)</span>
<span id="cb219-30"><a href="#cb219-30" tabindex="-1"></a></span>
<span id="cb219-31"><a href="#cb219-31" tabindex="-1"></a><span class="co"># 步骤 2：拟合模型 mpg ~ disp 到每个 Bootstrap 样本</span></span>
<span id="cb219-32"><a href="#cb219-32" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">fit_model</span>(bootstraps, mpg <span class="sc">~</span> disp)</span>
<span id="cb219-33"><a href="#cb219-33" tabindex="-1"></a></span>
<span id="cb219-34"><a href="#cb219-34" tabindex="-1"></a><span class="co"># 步骤 3：检查模型结果（简要输出系数）</span></span>
<span id="cb219-35"><a href="#cb219-35" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;模型回归系数:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 模型回归系数:</code></pre>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" tabindex="-1"></a><span class="fu">lapply</span>(models, <span class="cf">function</span>(model) <span class="fu">print</span>(<span class="fu">coef</span>(model)))</span></code></pre></div>
<pre><code>## (Intercept)        disp 
## 31.74481703 -0.04933598 
## (Intercept)        disp 
## 30.21659456 -0.04499483 
## (Intercept)        disp 
## 30.44989475 -0.04663706 
## (Intercept)        disp 
## 29.29142053 -0.04252795 
## (Intercept)        disp 
## 28.98495820 -0.04057887 
## (Intercept)        disp 
## 30.65795802 -0.04787861 
## (Intercept)        disp 
## 29.19028431 -0.03927556 
## (Intercept)        disp 
## 29.87392610 -0.04260065 
## (Intercept)        disp 
## 29.99155567 -0.04451797 
## (Intercept)        disp 
## 28.67040701 -0.03464708</code></pre>
<pre><code>## [[1]]
## (Intercept)        disp 
## 31.74481703 -0.04933598 
## 
## [[2]]
## (Intercept)        disp 
## 30.21659456 -0.04499483 
## 
## [[3]]
## (Intercept)        disp 
## 30.44989475 -0.04663706 
## 
## [[4]]
## (Intercept)        disp 
## 29.29142053 -0.04252795 
## 
## [[5]]
## (Intercept)        disp 
## 28.98495820 -0.04057887 
## 
## [[6]]
## (Intercept)        disp 
## 30.65795802 -0.04787861 
## 
## [[7]]
## (Intercept)        disp 
## 29.19028431 -0.03927556 
## 
## [[8]]
## (Intercept)        disp 
## 29.87392610 -0.04260065 
## 
## [[9]]
## (Intercept)        disp 
## 29.99155567 -0.04451797 
## 
## [[10]]
## (Intercept)        disp 
## 28.67040701 -0.03464708</code></pre>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" tabindex="-1"></a><span class="co"># 清空内存以节省空间</span></span>
<span id="cb224-2"><a href="#cb224-2" tabindex="-1"></a><span class="fu">clean_memory</span>()</span></code></pre></div>
<pre><code>##           used  (Mb) gc trigger  (Mb) max used  (Mb)
## Ncells 2445919 130.7    3747821 200.2  3747821 200.2
## Vcells 4292930  32.8   10150613  77.5  8392178  64.1</code></pre>
<div id="section-11" class="section level2">
<h2>5</h2>
<p>对于前两个练习中的每个模型，使用下面的函数提取 <strong>R²</strong>
值。</p>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span></code></pre></div>
<div id="对任务3" class="section level3">
<h3>对任务3</h3>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" tabindex="-1"></a><span class="co"># 清空环境变量</span></span>
<span id="cb227-2"><a href="#cb227-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb227-3"><a href="#cb227-3" tabindex="-1"></a></span>
<span id="cb227-4"><a href="#cb227-4" tabindex="-1"></a><span class="co"># 加载数据集</span></span>
<span id="cb227-5"><a href="#cb227-5" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb227-6"><a href="#cb227-6" tabindex="-1"></a></span>
<span id="cb227-7"><a href="#cb227-7" tabindex="-1"></a><span class="co"># 定义公式列表</span></span>
<span id="cb227-8"><a href="#cb227-8" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb227-9"><a href="#cb227-9" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb227-10"><a href="#cb227-10" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb227-11"><a href="#cb227-11" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb227-12"><a href="#cb227-12" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb227-13"><a href="#cb227-13" tabindex="-1"></a>)</span>
<span id="cb227-14"><a href="#cb227-14" tabindex="-1"></a></span>
<span id="cb227-15"><a href="#cb227-15" tabindex="-1"></a><span class="co"># 定义函数：拟合模型（for 循环实现）</span></span>
<span id="cb227-16"><a href="#cb227-16" tabindex="-1"></a>fit_models_for <span class="ot">&lt;-</span> <span class="cf">function</span>(formulas, data) {</span>
<span id="cb227-17"><a href="#cb227-17" tabindex="-1"></a>  models <span class="ot">&lt;-</span> <span class="fu">list</span>()  <span class="co"># 存储模型</span></span>
<span id="cb227-18"><a href="#cb227-18" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(formulas)) {</span>
<span id="cb227-19"><a href="#cb227-19" tabindex="-1"></a>    models[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(formulas[[i]], <span class="at">data =</span> data)</span>
<span id="cb227-20"><a href="#cb227-20" tabindex="-1"></a>  }</span>
<span id="cb227-21"><a href="#cb227-21" tabindex="-1"></a>  models</span>
<span id="cb227-22"><a href="#cb227-22" tabindex="-1"></a>}</span>
<span id="cb227-23"><a href="#cb227-23" tabindex="-1"></a></span>
<span id="cb227-24"><a href="#cb227-24" tabindex="-1"></a><span class="co"># 定义函数：拟合模型（lapply 实现）</span></span>
<span id="cb227-25"><a href="#cb227-25" tabindex="-1"></a>fit_models_lapply <span class="ot">&lt;-</span> <span class="cf">function</span>(formulas, data) {</span>
<span id="cb227-26"><a href="#cb227-26" tabindex="-1"></a>  <span class="fu">lapply</span>(formulas, <span class="cf">function</span>(f) <span class="fu">lm</span>(f, <span class="at">data =</span> data))</span>
<span id="cb227-27"><a href="#cb227-27" tabindex="-1"></a>}</span>
<span id="cb227-28"><a href="#cb227-28" tabindex="-1"></a></span>
<span id="cb227-29"><a href="#cb227-29" tabindex="-1"></a><span class="co"># 定义函数：提取 R² 值</span></span>
<span id="cb227-30"><a href="#cb227-30" tabindex="-1"></a>extract_r_squared <span class="ot">&lt;-</span> <span class="cf">function</span>(models) {</span>
<span id="cb227-31"><a href="#cb227-31" tabindex="-1"></a>  <span class="co"># 使用 lapply 提取每个模型的 R² 值</span></span>
<span id="cb227-32"><a href="#cb227-32" tabindex="-1"></a>  <span class="fu">sapply</span>(models, <span class="cf">function</span>(model) <span class="fu">summary</span>(model)<span class="sc">$</span>r.squared)</span>
<span id="cb227-33"><a href="#cb227-33" tabindex="-1"></a>}</span>
<span id="cb227-34"><a href="#cb227-34" tabindex="-1"></a></span>
<span id="cb227-35"><a href="#cb227-35" tabindex="-1"></a><span class="co"># 步骤1：使用 for 循环拟合模型</span></span>
<span id="cb227-36"><a href="#cb227-36" tabindex="-1"></a>models_for <span class="ot">&lt;-</span> <span class="fu">fit_models_for</span>(formulas, mtcars)</span>
<span id="cb227-37"><a href="#cb227-37" tabindex="-1"></a></span>
<span id="cb227-38"><a href="#cb227-38" tabindex="-1"></a><span class="co"># 步骤2：使用 lapply 拟合模型</span></span>
<span id="cb227-39"><a href="#cb227-39" tabindex="-1"></a>models_lapply <span class="ot">&lt;-</span> <span class="fu">fit_models_lapply</span>(formulas, mtcars)</span>
<span id="cb227-40"><a href="#cb227-40" tabindex="-1"></a></span>
<span id="cb227-41"><a href="#cb227-41" tabindex="-1"></a><span class="co"># 步骤3：提取 R² 值（for 循环模型）</span></span>
<span id="cb227-42"><a href="#cb227-42" tabindex="-1"></a>r_squared_for <span class="ot">&lt;-</span> <span class="fu">extract_r_squared</span>(models_for)</span>
<span id="cb227-43"><a href="#cb227-43" tabindex="-1"></a></span>
<span id="cb227-44"><a href="#cb227-44" tabindex="-1"></a><span class="co"># 步骤4：提取 R² 值（lapply 模型）</span></span>
<span id="cb227-45"><a href="#cb227-45" tabindex="-1"></a>r_squared_lapply <span class="ot">&lt;-</span> <span class="fu">extract_r_squared</span>(models_lapply)</span>
<span id="cb227-46"><a href="#cb227-46" tabindex="-1"></a></span>
<span id="cb227-47"><a href="#cb227-47" tabindex="-1"></a><span class="co"># 输出 R² 值</span></span>
<span id="cb227-48"><a href="#cb227-48" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;For 循环模型的 R² 值：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## For 循环模型的 R² 值：</code></pre>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1" tabindex="-1"></a><span class="fu">print</span>(r_squared_for)</span></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">lapply 模型的 R² 值：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## lapply 模型的 R² 值：</code></pre>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1" tabindex="-1"></a><span class="fu">print</span>(r_squared_lapply)</span></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" tabindex="-1"></a><span class="co"># 清理内存</span></span>
<span id="cb235-2"><a href="#cb235-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb235-3"><a href="#cb235-3" tabindex="-1"></a><span class="fu">gc</span>()</span></code></pre></div>
<pre><code>##           used  (Mb) gc trigger  (Mb) max used  (Mb)
## Ncells 2444966 130.6    3747821 200.2  3747821 200.2
## Vcells 4284936  32.7   10150613  77.5  8392178  64.1</code></pre>
</div>
<div id="对任务4" class="section level3">
<h3>对任务4</h3>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="#cb237-1" tabindex="-1"></a><span class="co"># 清空环境变量以节约内存</span></span>
<span id="cb237-2"><a href="#cb237-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb237-3"><a href="#cb237-3" tabindex="-1"></a></span>
<span id="cb237-4"><a href="#cb237-4" tabindex="-1"></a><span class="co"># 加载数据集</span></span>
<span id="cb237-5"><a href="#cb237-5" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb237-6"><a href="#cb237-6" tabindex="-1"></a></span>
<span id="cb237-7"><a href="#cb237-7" tabindex="-1"></a><span class="co"># 定义函数：生成 Bootstrap 数据集</span></span>
<span id="cb237-8"><a href="#cb237-8" tabindex="-1"></a>generate_bootstrap <span class="ot">&lt;-</span> <span class="cf">function</span>(data, n) {</span>
<span id="cb237-9"><a href="#cb237-9" tabindex="-1"></a>  <span class="co"># 创建 n 个 bootstrap 样本</span></span>
<span id="cb237-10"><a href="#cb237-10" tabindex="-1"></a>  <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="cf">function</span>(i) {</span>
<span id="cb237-11"><a href="#cb237-11" tabindex="-1"></a>    rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data), <span class="at">size =</span> <span class="fu">nrow</span>(data), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb237-12"><a href="#cb237-12" tabindex="-1"></a>    data[rows, ]</span>
<span id="cb237-13"><a href="#cb237-13" tabindex="-1"></a>  })</span>
<span id="cb237-14"><a href="#cb237-14" tabindex="-1"></a>}</span>
<span id="cb237-15"><a href="#cb237-15" tabindex="-1"></a></span>
<span id="cb237-16"><a href="#cb237-16" tabindex="-1"></a><span class="co"># 定义函数：拟合线性模型</span></span>
<span id="cb237-17"><a href="#cb237-17" tabindex="-1"></a>fit_model <span class="ot">&lt;-</span> <span class="cf">function</span>(data_list, formula) {</span>
<span id="cb237-18"><a href="#cb237-18" tabindex="-1"></a>  <span class="co"># 针对每个数据子集拟合模型</span></span>
<span id="cb237-19"><a href="#cb237-19" tabindex="-1"></a>  <span class="fu">lapply</span>(data_list, <span class="cf">function</span>(sub_data) <span class="fu">lm</span>(formula, <span class="at">data =</span> sub_data))</span>
<span id="cb237-20"><a href="#cb237-20" tabindex="-1"></a>}</span>
<span id="cb237-21"><a href="#cb237-21" tabindex="-1"></a></span>
<span id="cb237-22"><a href="#cb237-22" tabindex="-1"></a><span class="co"># 定义函数：提取 R² 值</span></span>
<span id="cb237-23"><a href="#cb237-23" tabindex="-1"></a>extract_r_squared <span class="ot">&lt;-</span> <span class="cf">function</span>(models) {</span>
<span id="cb237-24"><a href="#cb237-24" tabindex="-1"></a>  <span class="co"># 提取每个模型的 R² 值</span></span>
<span id="cb237-25"><a href="#cb237-25" tabindex="-1"></a>  <span class="fu">sapply</span>(models, <span class="cf">function</span>(model) <span class="fu">summary</span>(model)<span class="sc">$</span>r.squared)</span>
<span id="cb237-26"><a href="#cb237-26" tabindex="-1"></a>}</span>
<span id="cb237-27"><a href="#cb237-27" tabindex="-1"></a></span>
<span id="cb237-28"><a href="#cb237-28" tabindex="-1"></a><span class="co"># 定义函数：清理内存</span></span>
<span id="cb237-29"><a href="#cb237-29" tabindex="-1"></a>clean_memory <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb237-30"><a href="#cb237-30" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb237-31"><a href="#cb237-31" tabindex="-1"></a>  <span class="fu">gc</span>()  <span class="co"># 强制垃圾回收</span></span>
<span id="cb237-32"><a href="#cb237-32" tabindex="-1"></a>}</span>
<span id="cb237-33"><a href="#cb237-33" tabindex="-1"></a></span>
<span id="cb237-34"><a href="#cb237-34" tabindex="-1"></a><span class="co"># 步骤 1：生成 10 个 Bootstrap 样本</span></span>
<span id="cb237-35"><a href="#cb237-35" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">generate_bootstrap</span>(mtcars, <span class="dv">10</span>)</span>
<span id="cb237-36"><a href="#cb237-36" tabindex="-1"></a></span>
<span id="cb237-37"><a href="#cb237-37" tabindex="-1"></a><span class="co"># 步骤 2：拟合模型 mpg ~ disp 到每个 Bootstrap 样本</span></span>
<span id="cb237-38"><a href="#cb237-38" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">fit_model</span>(bootstraps, mpg <span class="sc">~</span> disp)</span>
<span id="cb237-39"><a href="#cb237-39" tabindex="-1"></a></span>
<span id="cb237-40"><a href="#cb237-40" tabindex="-1"></a><span class="co"># 步骤 3：提取模型的 R² 值</span></span>
<span id="cb237-41"><a href="#cb237-41" tabindex="-1"></a>r_squared_values <span class="ot">&lt;-</span> <span class="fu">extract_r_squared</span>(models)</span>
<span id="cb237-42"><a href="#cb237-42" tabindex="-1"></a></span>
<span id="cb237-43"><a href="#cb237-43" tabindex="-1"></a><span class="co"># 打印 R² 值</span></span>
<span id="cb237-44"><a href="#cb237-44" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;每个模型的 R² 值：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 每个模型的 R² 值：</code></pre>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="#cb239-1" tabindex="-1"></a><span class="fu">print</span>(r_squared_values)</span></code></pre></div>
<pre><code>##  [1] 0.7668250 0.7982749 0.6685297 0.5867311 0.6827598 0.6799646 0.8028019
##  [8] 0.7088130 0.7677474 0.7230215</code></pre>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="#cb241-1" tabindex="-1"></a><span class="co"># 清空内存以节省空间</span></span>
<span id="cb241-2"><a href="#cb241-2" tabindex="-1"></a><span class="fu">clean_memory</span>()</span></code></pre></div>
<pre><code>##           used  (Mb) gc trigger  (Mb) max used  (Mb)
## Ncells 2445987 130.7    3747821 200.2  3747821 200.2
## Vcells 4293423  32.8   10150613  77.5  8392178  64.1</code></pre>
</div>
</div>
<div id="p213" class="section level2">
<h2>3(P213)</h2>
<p>以下代码模拟了非正态分布数据下 t 检验的性能。使用
<strong>sapply()</strong> 和匿名函数提取每次试验的 <strong>p
值</strong>。</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="#cb243-1" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb243-2"><a href="#cb243-2" tabindex="-1"></a>  <span class="dv">100</span>,</span>
<span id="cb243-3"><a href="#cb243-3" tabindex="-1"></a>  <span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb243-4"><a href="#cb243-4" tabindex="-1"></a>  <span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb243-5"><a href="#cb243-5" tabindex="-1"></a>)</span></code></pre></div>
<p>额外挑战：通过直接使用 <strong>[[</strong> 消除匿名函数。</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="#cb244-1" tabindex="-1"></a><span class="co"># 清空环境变量</span></span>
<span id="cb244-2"><a href="#cb244-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb244-3"><a href="#cb244-3" tabindex="-1"></a></span>
<span id="cb244-4"><a href="#cb244-4" tabindex="-1"></a><span class="co"># 定义函数：生成 t 检验结果</span></span>
<span id="cb244-5"><a href="#cb244-5" tabindex="-1"></a>generate_t_tests <span class="ot">&lt;-</span> <span class="cf">function</span>(n) {</span>
<span id="cb244-6"><a href="#cb244-6" tabindex="-1"></a>  <span class="fu">replicate</span>(</span>
<span id="cb244-7"><a href="#cb244-7" tabindex="-1"></a>    n,</span>
<span id="cb244-8"><a href="#cb244-8" tabindex="-1"></a>    <span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb244-9"><a href="#cb244-9" tabindex="-1"></a>    <span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb244-10"><a href="#cb244-10" tabindex="-1"></a>  )</span>
<span id="cb244-11"><a href="#cb244-11" tabindex="-1"></a>}</span>
<span id="cb244-12"><a href="#cb244-12" tabindex="-1"></a></span>
<span id="cb244-13"><a href="#cb244-13" tabindex="-1"></a><span class="co"># 定义函数：提取 p 值</span></span>
<span id="cb244-14"><a href="#cb244-14" tabindex="-1"></a>extract_p_values <span class="ot">&lt;-</span> <span class="cf">function</span>(t_tests) {</span>
<span id="cb244-15"><a href="#cb244-15" tabindex="-1"></a>  <span class="co"># 使用 sapply 提取 p 值，直接使用 [[ 消除匿名函数</span></span>
<span id="cb244-16"><a href="#cb244-16" tabindex="-1"></a>  <span class="fu">sapply</span>(t_tests, <span class="st">&quot;[[&quot;</span>, <span class="st">&quot;p.value&quot;</span>)</span>
<span id="cb244-17"><a href="#cb244-17" tabindex="-1"></a>}</span>
<span id="cb244-18"><a href="#cb244-18" tabindex="-1"></a></span>
<span id="cb244-19"><a href="#cb244-19" tabindex="-1"></a><span class="co"># 定义函数：清理内存</span></span>
<span id="cb244-20"><a href="#cb244-20" tabindex="-1"></a>clean_memory <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb244-21"><a href="#cb244-21" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb244-22"><a href="#cb244-22" tabindex="-1"></a>  <span class="fu">gc</span>()  <span class="co"># 强制垃圾回收</span></span>
<span id="cb244-23"><a href="#cb244-23" tabindex="-1"></a>}</span>
<span id="cb244-24"><a href="#cb244-24" tabindex="-1"></a></span>
<span id="cb244-25"><a href="#cb244-25" tabindex="-1"></a><span class="co"># 步骤1：生成 100 次 t 检验</span></span>
<span id="cb244-26"><a href="#cb244-26" tabindex="-1"></a>t_test_results <span class="ot">&lt;-</span> <span class="fu">generate_t_tests</span>(<span class="dv">100</span>)</span>
<span id="cb244-27"><a href="#cb244-27" tabindex="-1"></a></span>
<span id="cb244-28"><a href="#cb244-28" tabindex="-1"></a><span class="co"># 步骤2：提取每次试验的 p 值</span></span>
<span id="cb244-29"><a href="#cb244-29" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">extract_p_values</span>(t_test_results)</span>
<span id="cb244-30"><a href="#cb244-30" tabindex="-1"></a></span>
<span id="cb244-31"><a href="#cb244-31" tabindex="-1"></a><span class="co"># 打印 p 值</span></span>
<span id="cb244-32"><a href="#cb244-32" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;提取的 p 值：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 提取的 p 值：</code></pre>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="#cb246-1" tabindex="-1"></a><span class="fu">print</span>(p_values)</span></code></pre></div>
<pre><code>##   [1] 0.81394199 0.82715038 0.36649792 0.78588132 0.28058839 0.45844365
##   [7] 0.95459966 0.44442546 0.88894901 0.83990561 0.37276587 0.16601487
##  [13] 0.86722333 0.10130063 0.28125979 0.76668281 0.90799826 0.54423384
##  [19] 0.79072593 0.85708977 0.00834476 0.72272411 0.01078350 0.56703657
##  [25] 0.24621529 0.33456297 0.63597979 0.67279596 0.76597303 0.01777495
##  [31] 0.23696224 0.48093199 0.55812279 0.83110023 0.37819116 0.10920406
##  [37] 0.77712211 0.73870219 0.28505177 0.98784865 0.12318780 0.51435074
##  [43] 0.55181527 0.84988438 0.08876395 0.01601665 0.90206792 0.68940137
##  [49] 0.40821414 0.25002094 0.32395907 0.40641703 0.60461243 0.38256273
##  [55] 0.03193609 0.68850994 0.20055422 0.80788924 0.58147195 0.84423920
##  [61] 0.46898294 0.04089789 0.85191100 0.56085255 0.93247930 0.71276374
##  [67] 0.47346421 0.60468783 0.07841724 0.25187046 0.03619733 0.73172184
##  [73] 0.02811118 0.44326034 0.69277587 0.21109531 0.48728086 0.82297373
##  [79] 0.51189458 0.33638090 0.94543214 0.77505422 0.72644027 0.51687538
##  [85] 0.85886068 0.10830103 0.03707990 0.93322778 0.09500198 0.42670286
##  [91] 0.57697395 0.36829241 0.74109801 0.22749568 0.94111268 0.43411954
##  [97] 0.84653704 0.54997343 0.95692822 0.74690988</code></pre>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="#cb248-1" tabindex="-1"></a><span class="co"># 清空内存</span></span>
<span id="cb248-2"><a href="#cb248-2" tabindex="-1"></a><span class="fu">clean_memory</span>()</span></code></pre></div>
<pre><code>##           used  (Mb) gc trigger  (Mb) max used  (Mb)
## Ncells 2447848 130.8    3747821 200.2  3747821 200.2
## Vcells 4292448  32.8   10150613  77.5  8392178  64.1</code></pre>
</div>
<div id="p214" class="section level2">
<h2>6(P214)</h2>
<p>实现一个结合 <strong>Map()</strong> 和 <strong>vapply()</strong>
的功能，创建一个变体版本的
<strong>lapply()</strong>，能够对所有输入进行并行迭代，并将输出存储为向量（或矩阵）。<br />
这个函数应该接受哪些参数？</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="#cb250-1" tabindex="-1"></a>custom_lapply_variant <span class="ot">&lt;-</span> <span class="cf">function</span>(FUN, ..., <span class="at">output_type =</span> <span class="st">&quot;vector&quot;</span>, <span class="at">USE.NAMES =</span> <span class="cn">TRUE</span>) {</span>
<span id="cb250-2"><a href="#cb250-2" tabindex="-1"></a>  <span class="co"># 参数说明：</span></span>
<span id="cb250-3"><a href="#cb250-3" tabindex="-1"></a>  <span class="co"># FUN: 用户自定义的操作函数</span></span>
<span id="cb250-4"><a href="#cb250-4" tabindex="-1"></a>  <span class="co"># ...: 不定数量的并行输入对象（列表、向量等）</span></span>
<span id="cb250-5"><a href="#cb250-5" tabindex="-1"></a>  <span class="co"># output_type: 输出类型（&quot;vector&quot; 或 &quot;matrix&quot;）</span></span>
<span id="cb250-6"><a href="#cb250-6" tabindex="-1"></a>  <span class="co"># USE.NAMES: 是否保留输出的名称（默认 TRUE）</span></span>
<span id="cb250-7"><a href="#cb250-7" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="#cb251-1" tabindex="-1"></a><span class="co"># 清空环境变量</span></span>
<span id="cb251-2"><a href="#cb251-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb251-3"><a href="#cb251-3" tabindex="-1"></a></span>
<span id="cb251-4"><a href="#cb251-4" tabindex="-1"></a><span class="co"># 定义函数：结合 Map 和 vapply 实现并行迭代，并存储为向量或矩阵</span></span>
<span id="cb251-5"><a href="#cb251-5" tabindex="-1"></a>custom_lapply_variant <span class="ot">&lt;-</span> <span class="cf">function</span>(FUN, ..., <span class="at">output_type =</span> <span class="st">&quot;vector&quot;</span>) {</span>
<span id="cb251-6"><a href="#cb251-6" tabindex="-1"></a>  <span class="co"># 检查 output_type 参数是否有效</span></span>
<span id="cb251-7"><a href="#cb251-7" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>output_type <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;vector&quot;</span>, <span class="st">&quot;matrix&quot;</span>)) {</span>
<span id="cb251-8"><a href="#cb251-8" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Invalid output_type. Choose &#39;vector&#39; or &#39;matrix&#39;.&quot;</span>)</span>
<span id="cb251-9"><a href="#cb251-9" tabindex="-1"></a>  }</span>
<span id="cb251-10"><a href="#cb251-10" tabindex="-1"></a>  </span>
<span id="cb251-11"><a href="#cb251-11" tabindex="-1"></a>  <span class="co"># 使用 Map 进行并行迭代</span></span>
<span id="cb251-12"><a href="#cb251-12" tabindex="-1"></a>  map_results <span class="ot">&lt;-</span> <span class="fu">Map</span>(FUN, ...)</span>
<span id="cb251-13"><a href="#cb251-13" tabindex="-1"></a>  </span>
<span id="cb251-14"><a href="#cb251-14" tabindex="-1"></a>  <span class="co"># 根据 output_type 转换结果</span></span>
<span id="cb251-15"><a href="#cb251-15" tabindex="-1"></a>  <span class="cf">if</span> (output_type <span class="sc">==</span> <span class="st">&quot;vector&quot;</span>) {</span>
<span id="cb251-16"><a href="#cb251-16" tabindex="-1"></a>    <span class="co"># 转换为向量</span></span>
<span id="cb251-17"><a href="#cb251-17" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">unlist</span>(map_results))</span>
<span id="cb251-18"><a href="#cb251-18" tabindex="-1"></a>  } <span class="cf">else</span> <span class="cf">if</span> (output_type <span class="sc">==</span> <span class="st">&quot;matrix&quot;</span>) {</span>
<span id="cb251-19"><a href="#cb251-19" tabindex="-1"></a>    <span class="co"># 转换为矩阵</span></span>
<span id="cb251-20"><a href="#cb251-20" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">do.call</span>(rbind, map_results))</span>
<span id="cb251-21"><a href="#cb251-21" tabindex="-1"></a>  }</span>
<span id="cb251-22"><a href="#cb251-22" tabindex="-1"></a>}</span>
<span id="cb251-23"><a href="#cb251-23" tabindex="-1"></a></span>
<span id="cb251-24"><a href="#cb251-24" tabindex="-1"></a><span class="co"># 定义函数：清理内存</span></span>
<span id="cb251-25"><a href="#cb251-25" tabindex="-1"></a>clean_memory <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb251-26"><a href="#cb251-26" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb251-27"><a href="#cb251-27" tabindex="-1"></a>  <span class="fu">gc</span>()  <span class="co"># 强制垃圾回收</span></span>
<span id="cb251-28"><a href="#cb251-28" tabindex="-1"></a>}</span>
<span id="cb251-29"><a href="#cb251-29" tabindex="-1"></a></span>
<span id="cb251-30"><a href="#cb251-30" tabindex="-1"></a><span class="co"># 示例1：对两个向量的对应元素求和，并存储为向量</span></span>
<span id="cb251-31"><a href="#cb251-31" tabindex="-1"></a>vector_result <span class="ot">&lt;-</span> <span class="fu">custom_lapply_variant</span>(</span>
<span id="cb251-32"><a href="#cb251-32" tabindex="-1"></a>  <span class="at">FUN =</span> <span class="st">`</span><span class="at">+</span><span class="st">`</span>, </span>
<span id="cb251-33"><a href="#cb251-33" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb251-34"><a href="#cb251-34" tabindex="-1"></a>  <span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>, </span>
<span id="cb251-35"><a href="#cb251-35" tabindex="-1"></a>  <span class="at">output_type =</span> <span class="st">&quot;vector&quot;</span></span>
<span id="cb251-36"><a href="#cb251-36" tabindex="-1"></a>)</span>
<span id="cb251-37"><a href="#cb251-37" tabindex="-1"></a></span>
<span id="cb251-38"><a href="#cb251-38" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;结果存储为向量：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 结果存储为向量：</code></pre>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="#cb253-1" tabindex="-1"></a><span class="fu">print</span>(vector_result)</span></code></pre></div>
<pre><code>## [1]  7  9 11 13 15</code></pre>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="#cb255-1" tabindex="-1"></a><span class="co"># 示例2：对两个向量的对应元素求和，并存储为矩阵</span></span>
<span id="cb255-2"><a href="#cb255-2" tabindex="-1"></a>matrix_result <span class="ot">&lt;-</span> <span class="fu">custom_lapply_variant</span>(</span>
<span id="cb255-3"><a href="#cb255-3" tabindex="-1"></a>  <span class="at">FUN =</span> <span class="cf">function</span>(x, y) <span class="fu">c</span>(<span class="at">sum =</span> x <span class="sc">+</span> y, <span class="at">product =</span> x <span class="sc">*</span> y), </span>
<span id="cb255-4"><a href="#cb255-4" tabindex="-1"></a>  <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb255-5"><a href="#cb255-5" tabindex="-1"></a>  <span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>, </span>
<span id="cb255-6"><a href="#cb255-6" tabindex="-1"></a>  <span class="at">output_type =</span> <span class="st">&quot;matrix&quot;</span></span>
<span id="cb255-7"><a href="#cb255-7" tabindex="-1"></a>)</span>
<span id="cb255-8"><a href="#cb255-8" tabindex="-1"></a></span>
<span id="cb255-9"><a href="#cb255-9" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">结果存储为矩阵：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 结果存储为矩阵：</code></pre>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="#cb257-1" tabindex="-1"></a><span class="fu">print</span>(matrix_result)</span></code></pre></div>
<pre><code>##      sum product
## [1,]   7       6
## [2,]   9      14
## [3,]  11      24
## [4,]  13      36
## [5,]  15      50</code></pre>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="#cb259-1" tabindex="-1"></a><span class="co"># 清空内存</span></span>
<span id="cb259-2"><a href="#cb259-2" tabindex="-1"></a><span class="fu">clean_memory</span>()</span></code></pre></div>
<pre><code>##           used  (Mb) gc trigger  (Mb) max used  (Mb)
## Ncells 2446083 130.7    3747821 200.2  3747821 200.2
## Vcells 4288408  32.8   10150613  77.5  8392178  64.1</code></pre>
</div>
<div id="p365" class="section level2">
<h2>4(P365)</h2>
<p>制作一个更快版本的
<code>chisq.test()</code>，仅在输入为两个没有缺失值的数值向量时计算卡方检验的统计量。<br />
你可以通过简化 <code>chisq.test()</code>
或根据数学定义直接编写代码实现（参考 <a href="http://en.wikipedia.org/wiki/Pearson%27s_chi-squared_test">Pearson’s
chi-squared test</a>）。</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="#cb261-1" tabindex="-1"></a><span class="co"># 清空环境变量</span></span>
<span id="cb261-2"><a href="#cb261-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb261-3"><a href="#cb261-3" tabindex="-1"></a></span>
<span id="cb261-4"><a href="#cb261-4" tabindex="-1"></a><span class="co"># 定义函数：快速计算卡方检验统计量</span></span>
<span id="cb261-5"><a href="#cb261-5" tabindex="-1"></a>fast_chisq_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb261-6"><a href="#cb261-6" tabindex="-1"></a>  <span class="co"># 检查输入是否为数值向量</span></span>
<span id="cb261-7"><a href="#cb261-7" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(x) <span class="sc">||</span> <span class="sc">!</span><span class="fu">is.numeric</span>(y)) {</span>
<span id="cb261-8"><a href="#cb261-8" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Inputs must be numeric vectors.&quot;</span>)</span>
<span id="cb261-9"><a href="#cb261-9" tabindex="-1"></a>  }</span>
<span id="cb261-10"><a href="#cb261-10" tabindex="-1"></a>  </span>
<span id="cb261-11"><a href="#cb261-11" tabindex="-1"></a>  <span class="co"># 检查输入是否有缺失值</span></span>
<span id="cb261-12"><a href="#cb261-12" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">is.na</span>(x)) <span class="sc">||</span> <span class="fu">any</span>(<span class="fu">is.na</span>(y))) {</span>
<span id="cb261-13"><a href="#cb261-13" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Inputs must not contain missing values.&quot;</span>)</span>
<span id="cb261-14"><a href="#cb261-14" tabindex="-1"></a>  }</span>
<span id="cb261-15"><a href="#cb261-15" tabindex="-1"></a>  </span>
<span id="cb261-16"><a href="#cb261-16" tabindex="-1"></a>  <span class="co"># 检查输入长度是否匹配</span></span>
<span id="cb261-17"><a href="#cb261-17" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(x) <span class="sc">!=</span> <span class="fu">length</span>(y)) {</span>
<span id="cb261-18"><a href="#cb261-18" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Inputs must have the same length.&quot;</span>)</span>
<span id="cb261-19"><a href="#cb261-19" tabindex="-1"></a>  }</span>
<span id="cb261-20"><a href="#cb261-20" tabindex="-1"></a>  </span>
<span id="cb261-21"><a href="#cb261-21" tabindex="-1"></a>  <span class="co"># 计算观察值的频数</span></span>
<span id="cb261-22"><a href="#cb261-22" tabindex="-1"></a>  observed <span class="ot">&lt;-</span> <span class="fu">table</span>(x, y)</span>
<span id="cb261-23"><a href="#cb261-23" tabindex="-1"></a>  </span>
<span id="cb261-24"><a href="#cb261-24" tabindex="-1"></a>  <span class="co"># 计算期望值</span></span>
<span id="cb261-25"><a href="#cb261-25" tabindex="-1"></a>  row_sums <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(observed)</span>
<span id="cb261-26"><a href="#cb261-26" tabindex="-1"></a>  col_sums <span class="ot">&lt;-</span> <span class="fu">colSums</span>(observed)</span>
<span id="cb261-27"><a href="#cb261-27" tabindex="-1"></a>  total <span class="ot">&lt;-</span> <span class="fu">sum</span>(observed)</span>
<span id="cb261-28"><a href="#cb261-28" tabindex="-1"></a>  expected <span class="ot">&lt;-</span> <span class="fu">outer</span>(row_sums, col_sums) <span class="sc">/</span> total</span>
<span id="cb261-29"><a href="#cb261-29" tabindex="-1"></a>  </span>
<span id="cb261-30"><a href="#cb261-30" tabindex="-1"></a>  <span class="co"># 计算卡方统计量</span></span>
<span id="cb261-31"><a href="#cb261-31" tabindex="-1"></a>  chisq_stat <span class="ot">&lt;-</span> <span class="fu">sum</span>((observed <span class="sc">-</span> expected)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> expected)</span>
<span id="cb261-32"><a href="#cb261-32" tabindex="-1"></a>  </span>
<span id="cb261-33"><a href="#cb261-33" tabindex="-1"></a>  <span class="fu">return</span>(chisq_stat)</span>
<span id="cb261-34"><a href="#cb261-34" tabindex="-1"></a>}</span>
<span id="cb261-35"><a href="#cb261-35" tabindex="-1"></a></span>
<span id="cb261-36"><a href="#cb261-36" tabindex="-1"></a><span class="co"># 定义函数：清理内存</span></span>
<span id="cb261-37"><a href="#cb261-37" tabindex="-1"></a>clean_memory <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb261-38"><a href="#cb261-38" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb261-39"><a href="#cb261-39" tabindex="-1"></a>  <span class="fu">gc</span>()  <span class="co"># 强制垃圾回收</span></span>
<span id="cb261-40"><a href="#cb261-40" tabindex="-1"></a>}</span>
<span id="cb261-41"><a href="#cb261-41" tabindex="-1"></a></span>
<span id="cb261-42"><a href="#cb261-42" tabindex="-1"></a><span class="co"># 示例1：快速计算卡方统计量</span></span>
<span id="cb261-43"><a href="#cb261-43" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb261-44"><a href="#cb261-44" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb261-45"><a href="#cb261-45" tabindex="-1"></a></span>
<span id="cb261-46"><a href="#cb261-46" tabindex="-1"></a>chisq_result <span class="ot">&lt;-</span> <span class="fu">fast_chisq_test</span>(x, y)</span>
<span id="cb261-47"><a href="#cb261-47" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;快速计算的卡方统计量：</span><span class="sc">\n</span><span class="st">&quot;</span>, chisq_result, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 快速计算的卡方统计量：
##  6</code></pre>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="#cb263-1" tabindex="-1"></a><span class="co"># 示例2：比较标准 chisq.test() 的结果</span></span>
<span id="cb263-2"><a href="#cb263-2" tabindex="-1"></a>observed_table <span class="ot">&lt;-</span> <span class="fu">table</span>(x, y)</span>
<span id="cb263-3"><a href="#cb263-3" tabindex="-1"></a>chisq_test_result <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(observed_table)</span></code></pre></div>
<pre><code>## Warning in chisq.test(observed_table): Chi-squared approximation may be
## incorrect</code></pre>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="#cb265-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;标准 chisq.test() 的卡方统计量：</span><span class="sc">\n</span><span class="st">&quot;</span>, chisq_test_result<span class="sc">$</span>statistic, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 标准 chisq.test() 的卡方统计量：
##  6</code></pre>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="#cb267-1" tabindex="-1"></a><span class="co"># 清空内存</span></span>
<span id="cb267-2"><a href="#cb267-2" tabindex="-1"></a><span class="fu">clean_memory</span>()</span></code></pre></div>
<pre><code>##           used  (Mb) gc trigger  (Mb) max used  (Mb)
## Ncells 2448238 130.8    3747821 200.2  3747821 200.2
## Vcells 4293672  32.8   10150613  77.5  8392178  64.1</code></pre>
<div id="优势" class="section level3">
<h3>优势</h3>
<ul>
<li>相较于标准 <code>chisq.test()</code>，省略了不必要的计算（如 p
值），提高了性能。</li>
<li>符合题目要求，仅计算卡方统计量，并且程序规范、易于维护。</li>
</ul>
</div>
</div>
<div id="p366" class="section level2">
<h2>5(P366)</h2>
<p>你能为以下情况制作一个更快版本的 <code>table()</code> 吗？<br />
输入是两个没有缺失值的整数向量。<br />
你能用它来加速你的卡方检验吗？</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="#cb269-1" tabindex="-1"></a><span class="co"># 清空环境变量</span></span>
<span id="cb269-2"><a href="#cb269-2" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb269-3"><a href="#cb269-3" tabindex="-1"></a></span>
<span id="cb269-4"><a href="#cb269-4" tabindex="-1"></a><span class="co"># 定义函数：更快的 table() 实现</span></span>
<span id="cb269-5"><a href="#cb269-5" tabindex="-1"></a>fast_table <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb269-6"><a href="#cb269-6" tabindex="-1"></a>  <span class="co"># 检查输入是否为整数向量</span></span>
<span id="cb269-7"><a href="#cb269-7" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.integer</span>(x) <span class="sc">||</span> <span class="sc">!</span><span class="fu">is.integer</span>(y)) {</span>
<span id="cb269-8"><a href="#cb269-8" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Inputs must be integer vectors.&quot;</span>)</span>
<span id="cb269-9"><a href="#cb269-9" tabindex="-1"></a>  }</span>
<span id="cb269-10"><a href="#cb269-10" tabindex="-1"></a>  </span>
<span id="cb269-11"><a href="#cb269-11" tabindex="-1"></a>  <span class="co"># 检查输入是否有缺失值</span></span>
<span id="cb269-12"><a href="#cb269-12" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">is.na</span>(x)) <span class="sc">||</span> <span class="fu">any</span>(<span class="fu">is.na</span>(y))) {</span>
<span id="cb269-13"><a href="#cb269-13" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Inputs must not contain missing values.&quot;</span>)</span>
<span id="cb269-14"><a href="#cb269-14" tabindex="-1"></a>  }</span>
<span id="cb269-15"><a href="#cb269-15" tabindex="-1"></a>  </span>
<span id="cb269-16"><a href="#cb269-16" tabindex="-1"></a>  <span class="co"># 检查输入长度是否匹配</span></span>
<span id="cb269-17"><a href="#cb269-17" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(x) <span class="sc">!=</span> <span class="fu">length</span>(y)) {</span>
<span id="cb269-18"><a href="#cb269-18" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;Inputs must have the same length.&quot;</span>)</span>
<span id="cb269-19"><a href="#cb269-19" tabindex="-1"></a>  }</span>
<span id="cb269-20"><a href="#cb269-20" tabindex="-1"></a>  </span>
<span id="cb269-21"><a href="#cb269-21" tabindex="-1"></a>  <span class="co"># 获取唯一值</span></span>
<span id="cb269-22"><a href="#cb269-22" tabindex="-1"></a>  x_levels <span class="ot">&lt;-</span> <span class="fu">unique</span>(x)</span>
<span id="cb269-23"><a href="#cb269-23" tabindex="-1"></a>  y_levels <span class="ot">&lt;-</span> <span class="fu">unique</span>(y)</span>
<span id="cb269-24"><a href="#cb269-24" tabindex="-1"></a>  </span>
<span id="cb269-25"><a href="#cb269-25" tabindex="-1"></a>  <span class="co"># 初始化频数表</span></span>
<span id="cb269-26"><a href="#cb269-26" tabindex="-1"></a>  freq_table <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">length</span>(x_levels), <span class="at">ncol =</span> <span class="fu">length</span>(y_levels),</span>
<span id="cb269-27"><a href="#cb269-27" tabindex="-1"></a>                       <span class="at">dimnames =</span> <span class="fu">list</span>(x_levels, y_levels))</span>
<span id="cb269-28"><a href="#cb269-28" tabindex="-1"></a>  </span>
<span id="cb269-29"><a href="#cb269-29" tabindex="-1"></a>  <span class="co"># 填充频数表</span></span>
<span id="cb269-30"><a href="#cb269-30" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(x)) {</span>
<span id="cb269-31"><a href="#cb269-31" tabindex="-1"></a>    freq_table[<span class="fu">as.character</span>(x[i]), <span class="fu">as.character</span>(y[i])] <span class="ot">&lt;-</span> freq_table[<span class="fu">as.character</span>(x[i]), <span class="fu">as.character</span>(y[i])] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb269-32"><a href="#cb269-32" tabindex="-1"></a>  }</span>
<span id="cb269-33"><a href="#cb269-33" tabindex="-1"></a>  </span>
<span id="cb269-34"><a href="#cb269-34" tabindex="-1"></a>  <span class="fu">return</span>(freq_table)</span>
<span id="cb269-35"><a href="#cb269-35" tabindex="-1"></a>}</span>
<span id="cb269-36"><a href="#cb269-36" tabindex="-1"></a></span>
<span id="cb269-37"><a href="#cb269-37" tabindex="-1"></a><span class="co"># 定义函数：更快的卡方检验</span></span>
<span id="cb269-38"><a href="#cb269-38" tabindex="-1"></a>fast_chisq_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb269-39"><a href="#cb269-39" tabindex="-1"></a>  <span class="co"># 调用 fast_table() 构造频数表</span></span>
<span id="cb269-40"><a href="#cb269-40" tabindex="-1"></a>  observed <span class="ot">&lt;-</span> <span class="fu">fast_table</span>(x, y)</span>
<span id="cb269-41"><a href="#cb269-41" tabindex="-1"></a>  </span>
<span id="cb269-42"><a href="#cb269-42" tabindex="-1"></a>  <span class="co"># 计算期望值</span></span>
<span id="cb269-43"><a href="#cb269-43" tabindex="-1"></a>  row_sums <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(observed)</span>
<span id="cb269-44"><a href="#cb269-44" tabindex="-1"></a>  col_sums <span class="ot">&lt;-</span> <span class="fu">colSums</span>(observed)</span>
<span id="cb269-45"><a href="#cb269-45" tabindex="-1"></a>  total <span class="ot">&lt;-</span> <span class="fu">sum</span>(observed)</span>
<span id="cb269-46"><a href="#cb269-46" tabindex="-1"></a>  expected <span class="ot">&lt;-</span> <span class="fu">outer</span>(row_sums, col_sums) <span class="sc">/</span> total</span>
<span id="cb269-47"><a href="#cb269-47" tabindex="-1"></a>  </span>
<span id="cb269-48"><a href="#cb269-48" tabindex="-1"></a>  <span class="co"># 计算卡方统计量</span></span>
<span id="cb269-49"><a href="#cb269-49" tabindex="-1"></a>  chisq_stat <span class="ot">&lt;-</span> <span class="fu">sum</span>((observed <span class="sc">-</span> expected)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> expected)</span>
<span id="cb269-50"><a href="#cb269-50" tabindex="-1"></a>  </span>
<span id="cb269-51"><a href="#cb269-51" tabindex="-1"></a>  <span class="fu">return</span>(chisq_stat)</span>
<span id="cb269-52"><a href="#cb269-52" tabindex="-1"></a>}</span>
<span id="cb269-53"><a href="#cb269-53" tabindex="-1"></a></span>
<span id="cb269-54"><a href="#cb269-54" tabindex="-1"></a><span class="co"># 定义函数：清理内存</span></span>
<span id="cb269-55"><a href="#cb269-55" tabindex="-1"></a>clean_memory <span class="ot">&lt;-</span> <span class="cf">function</span>() {</span>
<span id="cb269-56"><a href="#cb269-56" tabindex="-1"></a>  <span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb269-57"><a href="#cb269-57" tabindex="-1"></a>  <span class="fu">gc</span>()  <span class="co"># 强制垃圾回收</span></span>
<span id="cb269-58"><a href="#cb269-58" tabindex="-1"></a>}</span>
<span id="cb269-59"><a href="#cb269-59" tabindex="-1"></a></span>
<span id="cb269-60"><a href="#cb269-60" tabindex="-1"></a><span class="co"># 示例：使用更快的 table 和卡方检验</span></span>
<span id="cb269-61"><a href="#cb269-61" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb269-62"><a href="#cb269-62" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb269-63"><a href="#cb269-63" tabindex="-1"></a></span>
<span id="cb269-64"><a href="#cb269-64" tabindex="-1"></a><span class="co"># 快速生成频数表</span></span>
<span id="cb269-65"><a href="#cb269-65" tabindex="-1"></a>freq_table <span class="ot">&lt;-</span> <span class="fu">fast_table</span>(x, y)</span>
<span id="cb269-66"><a href="#cb269-66" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;快速生成的频数表：</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 快速生成的频数表：</code></pre>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="#cb271-1" tabindex="-1"></a><span class="fu">print</span>(freq_table)</span></code></pre></div>
<pre><code>##   2 3 1
## 1 2 1 0
## 2 2 1 0
## 3 0 1 2</code></pre>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="#cb273-1" tabindex="-1"></a><span class="co"># 快速卡方检验</span></span>
<span id="cb273-2"><a href="#cb273-2" tabindex="-1"></a>chisq_stat <span class="ot">&lt;-</span> <span class="fu">fast_chisq_test</span>(x, y)</span>
<span id="cb273-3"><a href="#cb273-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;</span><span class="sc">\n</span><span class="st">快速卡方检验统计量：</span><span class="sc">\n</span><span class="st">&quot;</span>, chisq_stat, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## 
## 快速卡方检验统计量：
##  6</code></pre>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="#cb275-1" tabindex="-1"></a><span class="co"># 清空内存</span></span>
<span id="cb275-2"><a href="#cb275-2" tabindex="-1"></a><span class="fu">clean_memory</span>()</span></code></pre></div>
<pre><code>##           used  (Mb) gc trigger  (Mb) max used  (Mb)
## Ncells 2448511 130.8    3747821 200.2  3747821 200.2
## Vcells 4294532  32.8   10150613  77.5  8392178  64.1</code></pre>
<div id="优点" class="section level3">
<h3>优点</h3>
<ul>
<li>与标准 <code>table()</code> 和 <code>chisq.test()</code>
相比，跳过了不必要的操作（如处理因子或非整数数据）。</li>
<li>代码简单高效，专注于处理整数向量的卡方检验。</li>
<li>符合任务要求，适合高性能需求的应用场景。</li>
</ul>
</div>
</div>
<div id="answer-9" class="section level2">
<h2>Answer 9</h2>
</div>
<div id="问题描述-1" class="section level2">
<h2>问题描述</h2>
<p>要实现联合密度函数：</p>
<p><span class="math display">\[
f(x, y) \propto \binom{n}{x} y^{x+a-1}(1-y)^{n-x+b-1}, \quad x = 0, 1,
\dots, n, \, 0 \leq y \leq 1.
\]</span></p>
<p>的 Gibbs 采样器。条件分布分别为： - <span class="math inline">\(x | y
\sim \text{Binomial}(n, y)\)</span> - <span class="math inline">\(y | x
\sim \text{Beta}(x + a, n - x + b)\)</span></p>
<p>通过 Rcpp 实现。</p>
</div>
<div id="rcpp-实现" class="section level2">
<h2>Rcpp 实现</h2>
<div class="sourceCode" id="cb277"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb277-1"><a href="#cb277-1" tabindex="-1"></a><span class="co"># 保存以下代码到 Rcpp 文件中</span></span>
<span id="cb277-2"><a href="#cb277-2" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span>
<span id="cb277-3"><a href="#cb277-3" tabindex="-1"></a><span class="fu">sourceCpp</span>(<span class="at">code =</span> <span class="st">&#39;</span></span>
<span id="cb277-4"><a href="#cb277-4" tabindex="-1"></a><span class="st">#include &lt;Rcpp.h&gt;</span></span>
<span id="cb277-5"><a href="#cb277-5" tabindex="-1"></a><span class="st">using namespace Rcpp;</span></span>
<span id="cb277-6"><a href="#cb277-6" tabindex="-1"></a></span>
<span id="cb277-7"><a href="#cb277-7" tabindex="-1"></a><span class="st">// [[Rcpp::export]]</span></span>
<span id="cb277-8"><a href="#cb277-8" tabindex="-1"></a><span class="st">NumericMatrix gibbs_sampler(int n_samples, int n, double a, double b, double y_init) {</span></span>
<span id="cb277-9"><a href="#cb277-9" tabindex="-1"></a><span class="st">  NumericMatrix samples(n_samples, 2);</span></span>
<span id="cb277-10"><a href="#cb277-10" tabindex="-1"></a><span class="st">  </span></span>
<span id="cb277-11"><a href="#cb277-11" tabindex="-1"></a><span class="st">  int x = 0;</span></span>
<span id="cb277-12"><a href="#cb277-12" tabindex="-1"></a><span class="st">  double y = y_init;</span></span>
<span id="cb277-13"><a href="#cb277-13" tabindex="-1"></a></span>
<span id="cb277-14"><a href="#cb277-14" tabindex="-1"></a><span class="st">  for (int i = 0; i &lt; n_samples; ++i) {</span></span>
<span id="cb277-15"><a href="#cb277-15" tabindex="-1"></a><span class="st">    x = R::rbinom(n, y);                  // 从 Binomial(n, y) 中采样 x</span></span>
<span id="cb277-16"><a href="#cb277-16" tabindex="-1"></a><span class="st">    y = R::rbeta(x + a, n - x + b);       // 从 Beta(x + a, n - x + b) 中采样 y</span></span>
<span id="cb277-17"><a href="#cb277-17" tabindex="-1"></a></span>
<span id="cb277-18"><a href="#cb277-18" tabindex="-1"></a><span class="st">    samples(i, 0) = x;</span></span>
<span id="cb277-19"><a href="#cb277-19" tabindex="-1"></a><span class="st">    samples(i, 1) = y;</span></span>
<span id="cb277-20"><a href="#cb277-20" tabindex="-1"></a><span class="st">  }</span></span>
<span id="cb277-21"><a href="#cb277-21" tabindex="-1"></a></span>
<span id="cb277-22"><a href="#cb277-22" tabindex="-1"></a><span class="st">  return samples;</span></span>
<span id="cb277-23"><a href="#cb277-23" tabindex="-1"></a><span class="st">}</span></span>
<span id="cb277-24"><a href="#cb277-24" tabindex="-1"></a><span class="st">&#39;</span>)</span></code></pre></div>
</div>
<div id="参数设置" class="section level2">
<h2>参数设置</h2>
<p>采样器的参数：</p>
<ul>
<li><span class="math inline">\(n = 10\)</span>：二项分布的样本总数</li>
<li><span class="math inline">\(a = 2\)</span>，<span class="math inline">\(b = 2\)</span>：Beta 分布的超参数</li>
<li>初始值 <span class="math inline">\(y = 0.5\)</span></li>
<li>总采样数 <span class="math inline">\(n_{\text{samples}} =
10000\)</span></li>
</ul>
<div class="sourceCode" id="cb278"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb278-1"><a href="#cb278-1" tabindex="-1"></a><span class="co"># 参数设置</span></span>
<span id="cb278-2"><a href="#cb278-2" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb278-3"><a href="#cb278-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb278-4"><a href="#cb278-4" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb278-5"><a href="#cb278-5" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb278-6"><a href="#cb278-6" tabindex="-1"></a>y_init <span class="ot">&lt;-</span> <span class="fl">0.5</span></span></code></pre></div>
</div>
<div id="运行-gibbs-采样器" class="section level2">
<h2>运行 Gibbs 采样器</h2>
<p>调用 Rcpp 实现的函数并生成样本：</p>
<div class="sourceCode" id="cb279"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb279-1"><a href="#cb279-1" tabindex="-1"></a><span class="co"># 调用 Gibbs 采样器</span></span>
<span id="cb279-2"><a href="#cb279-2" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>(n_samples, n, a, b, y_init)</span>
<span id="cb279-3"><a href="#cb279-3" tabindex="-1"></a></span>
<span id="cb279-4"><a href="#cb279-4" tabindex="-1"></a><span class="co"># 转换为数据框</span></span>
<span id="cb279-5"><a href="#cb279-5" tabindex="-1"></a>samples_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(samples)</span>
<span id="cb279-6"><a href="#cb279-6" tabindex="-1"></a><span class="fu">colnames</span>(samples_df) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;y&quot;</span>)</span>
<span id="cb279-7"><a href="#cb279-7" tabindex="-1"></a><span class="fu">head</span>(samples_df)</span></code></pre></div>
<pre><code>##    x         y
## 1  4 0.6126950
## 2  8 0.4031370
## 3  8 0.8088705
## 4  9 0.9410256
## 5  9 0.9135870
## 6 10 0.8342220</code></pre>
</div>
<div id="结果可视化" class="section level2">
<h2>结果可视化</h2>
<div id="y-的直方图" class="section level3">
<h3><span class="math inline">\(y\)</span> 的直方图</h3>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="#cb281-1" tabindex="-1"></a><span class="fu">hist</span>(samples_df<span class="sc">$</span>y, <span class="at">breaks =</span> <span class="dv">30</span>, <span class="at">main =</span> <span class="st">&quot;Histogram of y&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;y&quot;</span>, <span class="at">freq =</span> <span class="cn">FALSE</span>)</span>
<span id="cb281-2"><a href="#cb281-2" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">density</span>(samples_df<span class="sc">$</span>y), <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="x-y-的散点图" class="section level3">
<h3><span class="math inline">\(x, y\)</span> 的散点图</h3>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="#cb282-1" tabindex="-1"></a><span class="fu">plot</span>(samples_df<span class="sc">$</span>x, samples_df<span class="sc">$</span>y, <span class="at">pch =</span> <span class="dv">20</span>, <span class="at">col =</span> <span class="st">&quot;darkgreen&quot;</span>, </span>
<span id="cb282-2"><a href="#cb282-2" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Scatter plot of x and y&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="总结-3" class="section level2">
<h2>总结</h2>
<p>通过 Gibbs 采样生成服从目标联合分布的样本。可以观察到：\ 1. <span class="math inline">\(y\)</span> 的分布接近于 Beta 分布。\ 2. <span class="math inline">\(x\)</span> 和 <span class="math inline">\(y\)</span>
之间存在关联性，符合联合密度函数的定义。</p>
<div id="使用-qqplot-比较随机数分布" class="section level3">
<h3>使用 <code>qqplot</code> 比较随机数分布</h3>
<p>将 <code>gibbs_sampler</code> 函数生成的 <span class="math inline">\(y\)</span> 样本与 R 中生成的 Beta
分布随机数进行比较。</p>
<div id="生成-beta-分布随机数" class="section level4">
<h4>生成 Beta 分布随机数</h4>
<p>使用 R 的 <code>rbeta</code> 函数生成相同数量的随机数，参数与 Gibbs
采样的 Beta 条件分布一致。</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="#cb283-1" tabindex="-1"></a><span class="co"># 从 Gibbs 采样结果提取 y 的样本</span></span>
<span id="cb283-2"><a href="#cb283-2" tabindex="-1"></a>gibbs_y <span class="ot">&lt;-</span> samples_df<span class="sc">$</span>y</span>
<span id="cb283-3"><a href="#cb283-3" tabindex="-1"></a></span>
<span id="cb283-4"><a href="#cb283-4" tabindex="-1"></a><span class="co"># 使用 R 的 rbeta 生成相同数量的随机数</span></span>
<span id="cb283-5"><a href="#cb283-5" tabindex="-1"></a>beta_y <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(n_samples, <span class="at">shape1 =</span> a, <span class="at">shape2 =</span> b)</span></code></pre></div>
</div>
<div id="绘制-q-q-图" class="section level4">
<h4>绘制 Q-Q 图</h4>
<p>使用 <code>qqplot</code> 比较两组随机数是否来自相同分布：</p>
<div class="sourceCode" id="cb284"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb284-1"><a href="#cb284-1" tabindex="-1"></a><span class="co"># 绘制 Q-Q 图</span></span>
<span id="cb284-2"><a href="#cb284-2" tabindex="-1"></a><span class="fu">qqplot</span>(beta_y, gibbs_y, </span>
<span id="cb284-3"><a href="#cb284-3" tabindex="-1"></a>       <span class="at">main =</span> <span class="st">&quot;Q-Q Plot: Gibbs vs Beta Random Numbers&quot;</span>, </span>
<span id="cb284-4"><a href="#cb284-4" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="st">&quot;Quantiles of Beta Distribution (R Function)&quot;</span>, </span>
<span id="cb284-5"><a href="#cb284-5" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&quot;Quantiles of Gibbs Sampler&quot;</span>)</span>
<span id="cb284-6"><a href="#cb284-6" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)  <span class="co"># 添加 y = x 的参考线</span></span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>点大致沿对角线 <span class="math inline">\(y = x\)</span>
分布，表明两组随机数的分布相似。</p>
</div>
</div>
</div>
<div id="使用-microbenchmark-函数比较rcpp-实现的-gibbs-采样器和-r-内置的随机数生成函数的计算时间" class="section level2">
<h2>使用 <code>microbenchmark</code> 函数比较Rcpp 实现的 Gibbs 采样器和
R 内置的随机数生成函数的计算时间</h2>
<div id="使用-microbenchmark-比较计算时间" class="section level3">
<h3>使用 <code>microbenchmark</code> 比较计算时间</h3>
<p>比较以下两个任务的时间： 1. <strong>Rcpp 实现的 Gibbs
采样器</strong>：调用 <code>gibbs_sampler</code> 函数。 2. <strong>R
内置随机数生成</strong>：直接用 R 的 <code>rbinom</code> 和
<code>rbeta</code> 函数实现相同的采样逻辑。</p>
<div id="代码实现" class="section level4">
<h4>代码实现</h4>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="#cb285-1" tabindex="-1"></a><span class="co"># 加载 microbenchmark 包</span></span>
<span id="cb285-2"><a href="#cb285-2" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: package &#39;microbenchmark&#39; was built under R version 4.4.2</code></pre>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="#cb287-1" tabindex="-1"></a><span class="co"># 使用 R 内置函数实现相同逻辑的采样</span></span>
<span id="cb287-2"><a href="#cb287-2" tabindex="-1"></a>gibbs_sampler_r <span class="ot">&lt;-</span> <span class="cf">function</span>(n_samples, n, a, b, y_init) {</span>
<span id="cb287-3"><a href="#cb287-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_samples)</span>
<span id="cb287-4"><a href="#cb287-4" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_samples)</span>
<span id="cb287-5"><a href="#cb287-5" tabindex="-1"></a>  y[<span class="dv">1</span>] <span class="ot">&lt;-</span> y_init</span>
<span id="cb287-6"><a href="#cb287-6" tabindex="-1"></a>  </span>
<span id="cb287-7"><a href="#cb287-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>(n_samples <span class="sc">-</span> <span class="dv">1</span>)) {</span>
<span id="cb287-8"><a href="#cb287-8" tabindex="-1"></a>    <span class="co"># 从 Binomial(n, y) 中采样 x</span></span>
<span id="cb287-9"><a href="#cb287-9" tabindex="-1"></a>    x[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y[i])</span>
<span id="cb287-10"><a href="#cb287-10" tabindex="-1"></a>    <span class="co"># 从 Beta(x + a, n - x + b) 中采样 y</span></span>
<span id="cb287-11"><a href="#cb287-11" tabindex="-1"></a>    y[i <span class="sc">+</span> <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, x[i] <span class="sc">+</span> a, n <span class="sc">-</span> x[i] <span class="sc">+</span> b)</span>
<span id="cb287-12"><a href="#cb287-12" tabindex="-1"></a>  }</span>
<span id="cb287-13"><a href="#cb287-13" tabindex="-1"></a>  <span class="fu">data.frame</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)</span>
<span id="cb287-14"><a href="#cb287-14" tabindex="-1"></a>}</span>
<span id="cb287-15"><a href="#cb287-15" tabindex="-1"></a></span>
<span id="cb287-16"><a href="#cb287-16" tabindex="-1"></a><span class="co"># 比较两个函数的执行时间</span></span>
<span id="cb287-17"><a href="#cb287-17" tabindex="-1"></a>benchmark_results <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(</span>
<span id="cb287-18"><a href="#cb287-18" tabindex="-1"></a>  <span class="at">Rcpp =</span> <span class="fu">gibbs_sampler</span>(n_samples, n, a, b, y_init),</span>
<span id="cb287-19"><a href="#cb287-19" tabindex="-1"></a>  <span class="at">R =</span> <span class="fu">gibbs_sampler_r</span>(n_samples, n, a, b, y_init),</span>
<span id="cb287-20"><a href="#cb287-20" tabindex="-1"></a>  <span class="at">times =</span> <span class="dv">10</span>  <span class="co"># 重复实验 10 次</span></span>
<span id="cb287-21"><a href="#cb287-21" tabindex="-1"></a>)</span>
<span id="cb287-22"><a href="#cb287-22" tabindex="-1"></a></span>
<span id="cb287-23"><a href="#cb287-23" tabindex="-1"></a><span class="co"># 打印比较结果</span></span>
<span id="cb287-24"><a href="#cb287-24" tabindex="-1"></a><span class="fu">print</span>(benchmark_results)</span></code></pre></div>
<pre><code>## Unit: milliseconds
##  expr       min        lq      mean    median        uq       max neval cld
##  Rcpp  2.081101  2.303401  2.409681  2.352251  2.390401  3.015601    10  a 
##     R 22.719801 22.844101 24.640081 23.709101 25.994902 30.207501    10   b</code></pre>
</div>
<div id="结果解释" class="section level4">
<h4>结果解释</h4>
<p>运行上述代码后，<code>microbenchmark</code> 会返回以下信息： -
每个函数执行的中位时间 (<code>median</code>)。 - 各次实验的最小时间
(<code>min</code>) 和最大时间 (<code>max</code>)。 -
函数性能的统计分布。</p>
</div>
<div id="可视化比较" class="section level4">
<h4>可视化比较</h4>
<p>使用 <code>autoplot</code> 函数绘制时间比较图：</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="#cb289-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb289-2"><a href="#cb289-2" tabindex="-1"></a><span class="fu">autoplot</span>(benchmark_results)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="结果分析" class="section level4">
<h4>结果分析</h4>
<p><strong>对比</strong>： - 从图中可以看出，<strong>Rcpp</strong>
实现的函数运行时间更短，分布在 3 毫秒左右，速度明显优于 R 原生实现。 -
而 <strong>R</strong> 的实现运行时间在 30
毫秒左右，时间更长且波动范围更大。</p>
</div>
</div>
<div id="结论-4" class="section level3">
<h3>结论</h3>
<ul>
<li><strong>性能</strong>：Rcpp 的实现明显比 R 原生实现快得多，这得益于
C++ 的高性能和更低的函数开销。</li>
<li><strong>稳定性</strong>：Rcpp
的运行时间分布更集中，说明执行时间更稳定；相比之下，R
的实现波动范围更大。</li>
</ul>
<p>这种比较结果表明，对于计算密集型任务（如 Gibbs 采样），使用 Rcpp
是一个更高效的选择。</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
